<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="googlef9f938de7779ce2c">













  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="sklearn,kaggle,">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta name="description" content="##A Data Science Framework: To Achieve 99% Accuracy  很不错的一篇文章，但是英文苦手，所以就借助谷歌和自己的渣英文简单翻译了，反正自己能看懂，哈哈。">
<meta name="keywords" content="sklearn,kaggle">
<meta property="og:type" content="article">
<meta property="og:title" content="一个数据科学框架：可以达到99%的准确度">
<meta property="og:url" content="http://yoursite.com/2018/01/04/kaggle/index.html">
<meta property="og:site_name" content="zealotCE">
<meta property="og:description" content="##A Data Science Framework: To Achieve 99% Accuracy  很不错的一篇文章，但是英文苦手，所以就借助谷歌和自己的渣英文简单翻译了，反正自己能看懂，哈哈。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://15858-presscdn-0-65.pagely.netdna-cdn.com/wp-content/uploads/2016/03/hilarious-autocorrect-fails-20x.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/52080686.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/70149589.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/86354672.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/1927926.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/22651868.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/61965289.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/43891131.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/37098878.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/84841807.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/83057665.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/53813862.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/16532868.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/41810479.jpg">
<meta property="og:image" content="http://blog-test.goldenhelix.com/wp-content/uploads/2015/04/B-fig-1.jpg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/3309996.jpg">
<meta property="og:image" content="http://yoursite.com/2018/01/04/kaggle/output_40_0.svg">
<meta property="og:image" content="http://om80aljc8.bkt.clouddn.com/18-1-4/88064178.jpg">
<meta property="og:updated_time" content="2018-01-04T09:58:58.904Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一个数据科学框架：可以达到99%的准确度">
<meta name="twitter:description" content="##A Data Science Framework: To Achieve 99% Accuracy  很不错的一篇文章，但是英文苦手，所以就借助谷歌和自己的渣英文简单翻译了，反正自己能看懂，哈哈。">
<meta name="twitter:image" content="http://15858-presscdn-0-65.pagely.netdna-cdn.com/wp-content/uploads/2016/03/hilarious-autocorrect-fails-20x.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/01/04/kaggle/">





  <title>一个数据科学框架：可以达到99%的准确度 | zealotCE</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zealotCE</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            站点地图
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/04/kaggle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zealot CE">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://om80aljc8.bkt.clouddn.com/blog_%E5%A4%B4%E5%83%8F.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zealotCE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">一个数据科学框架：可以达到99%的准确度</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-04T17:49:33+08:00">
                2018-01-04
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index">
                    <span itemprop="name">ML</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/01/04/kaggle/" class="leancloud_visitors" data-flag-title="一个数据科学框架：可以达到99%的准确度">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>##A Data Science Framework: To Achieve 99% Accuracy</p>
<blockquote>
<p>很不错的一篇文章，但是英文苦手，所以就借助谷歌和自己的渣英文简单翻译了，反正自己能看懂，哈哈。<br><a id="more"></a></p>
</blockquote>
<p>Hello and Welcome to Kaggle, the online Data Science Community to learn, share, and compete. Most beginners get lost in the field, because they fall into the black box approach, using libraries and algorithms they don’t understand. This tutorial will give you a 1-2-year head start over your peers, by providing a framework that teaches you how-to think like a data scientist vs what to think/code. Not only will you be able to submit your first competition, but you’ll be able to solve any problem thrown your way. I provide clear explanations, clean code, and plenty of links to resources. Please Note: This Kernel is still being improved. So check the Change Logs below for updates. Also, please be sure to upvote, fork, and comment and I’ll continue to develop. Thanks, and may you have “statistically significant” luck!</p>
<p>欢迎来到Kaggle，在一个在线数据科学社区学习，分享和参与。大多数初学者在这里迷路了，因为他们陷入了黑盒子的方式，使用他们不明白的库和算法。本教程通过提供一个框架，教会您如何像数据科学家一样思考和思考/编码，从而使您在同行中获得1-2年的领先优势。你不仅可以提交你的第一场比赛，但你可以解决任何问题。我提供了清晰的解释，干净的代码和大量的资源链接。请注意：这个内核还在改进之中。因此请查看下面的更改日志以获取更新。另外，请务必注意，分叉和评论，我会继续发展。谢谢，可能你有“统计意义上的”运气！</p>
<h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><p>Chapter 1 - How a Data Scientist Beat the Odds<br>Chapter 2 - A Data Science Framework<br>Chapter 3 - Step 1: Define the Problem and Step 2: Gather the Data<br>Chapter 4 - Step 3: Prepare Data for Consumption<br>Chapter 5 - The 4 C’s of Data Cleaning: Correcting, Completing, Creating, and Converting<br>Chapter 6 - Step 4: Perform Exploratory Analysis with Statistics<br>Chapter 7 - Step 5: Model Data<br>Chapter 8 - Evaluate Model Performance<br>Chapter 9 - Tune Model with Hyper-Parameters<br>Chapter 10 - Tune Model with Feature Selection<br>Chapter 11 - Step 6: Validate and Implement<br>Chapter 12 - Conclusion and Step 7: Optimize and Strategize<br>Change Log</p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ol>
<li>第一章 - 数据科学家如何击败赔率</li>
<li>第二章 - 数据科学框架</li>
<li>第三章 - 第一步：定义问题和第二步：收集数据</li>
<li>第四章 - 第三步：为消费准备数据</li>
<li>第五章 - 数据清理：修正，完成，创建和转换</li>
<li>第6章 - 第4步：使用统计进行探索性分析</li>
<li>第7章 - 第5步：模型数据</li>
<li>第8章 - 评估模型性能</li>
<li>第9章 - 使用超参数调整模型</li>
<li>第10章 - 调谐模型功能选择</li>
<li>第11章 - 第6步：验证和实现</li>
<li>第12章 - 总结</li>
</ol>
<p>Credits<br>How-to Use this Tutorial: Read the explanations provided in this Kernel and the links to developer documentation. The goal is to not just learn the whats, but the whys. If you don’t understand something in the code the print() function is your best friend. In coding, it’s okay to try, fail, and try again. If you do run into problems, Google is your second best friend, because 99.99% of the time, someone else had the same question/problem and already asked the coding community. If you’ve exhausted all your resources, the Kaggle Community via forums and comments can help too.</p>
<p>关于：<br>如何使用本教程：阅读此内核中提供的解释和开发者文档的链接。目标是不只是学习什么，而是什么。如果你不’ 不懂代码的东西print（）函数是你最好的朋友。在编码方面，可以尝试，失败，然后重试。如果你遇到问题，Google是你的第二好朋友，因为99.99％的时间，别人有同样的问题和问题，并已经问过编码社区。如果你已经耗尽了所有的资源，通过论坛和评论Kaggle社区也可以帮助。</p>
<h2 id="How-a-Data-Scientist-Beat-the-Odds"><a href="#How-a-Data-Scientist-Beat-the-Odds" class="headerlink" title="How a Data Scientist Beat the Odds"></a>How a Data Scientist Beat the Odds</h2><p>It’s the classical problem, predict the outcome of a binary event. In laymen terms this means, it either occurred or did not occur. For example, you won or did not win, you passed the test or did not pass the test, you were accepted or not accepted, and you get the point. A common business application is churn or customer retention. Another popular use case is, healthcare’s mortality rate or survival analysis. Binary events create an interesting dynamic, because we know statistically, a random guess should achieve a 50% accuracy rate, without creating one single algorithm or writing one single line of code. However, just like autocorrect spellcheck technology, sometimes we humans can be too smart for our own good and actually underperform a coin flip. In this kernel, I use Kaggle’s Getting Started Competition, Titanic: Machine Learning from Disaster, to walk the reader through, how-to use the data science framework to beat the odds.</p>
<p>What happens when technology is too smart for its own good? </p>
<h2 id="数据科学家如何击败概率"><a href="#数据科学家如何击败概率" class="headerlink" title="数据科学家如何击败概率"></a>数据科学家如何击败概率</h2><p>这是一个经典问题，预测二元事件的结果。从外行的角度来说，这意味着，它不是发生就是没有发生。例如，你赢了或者没有赢，你通过了考试或者没有通过考试，你被接受或者不被接受，你就明白了。常见的业务应用程序是流失或客户保留。另一个流行的用例是医疗保健的死亡率或生存分析。二元事件产生了一个有趣的动态，因为我们统计可以知道，随机猜测应该达到50％的准确率，而不需要创建一个单一的算法或编写一行代码。但是，就像自动纠正拼写检查技术一样，有时我们人类可能对我们自己而言太聪明，实际上表现不及投掷硬币。在这个内核中，我使用Kaggle的入门比赛，泰坦尼克号：<br>当技术过于聪明而不利于自身时，会发生什么？ </p>
<p><img src="http://15858-presscdn-0-65.pagely.netdna-cdn.com/wp-content/uploads/2016/03/hilarious-autocorrect-fails-20x.jpg" alt="Funny Autocorrect"></p>
<h2 id="A-Data-Science-Framework"><a href="#A-Data-Science-Framework" class="headerlink" title="A Data Science Framework"></a>A Data Science Framework</h2><p>Define the Problem: If data science, big data, machine learning, predictive analytics, business intelligence, or any other buzzword is the solution, then what is the problem? As the saying goes, don’t put the cart before the horse. Problems before requirements, requirements before solutions, solutions before design, and design before technology. Too often we are quick to jump on the new shiny technology, tool, or algorithm before determining the actual problem we are trying to solve.</p>
<p>Gather the Data: John Naisbitt wrote in his 1984 (yes, 1984) book Megatrends, we are “drowning in data, yet staving for knowledge.” So, chances are, the dataset(s) already exist somewhere, in some format. It may be external or internal, structured or unstructured, static or streamed, objective or subjective, etc. As the saying goes, you don’t have to reinvent the wheel, you just have to know where to find it. In the next step, we will worry about transforming “dirty data” to “clean data.”</p>
<p>Prepare Data for Consumption: This step is often referred to as data wrangling, a required process to turn “wild” data into “manageable” data. Data wrangling includes implementing data architectures for storage and processing, developing data governance standards for quality and control, data extraction (i.e. ETL and web scraping), and data cleaning to identify aberrant, missing, or outlier data points.</p>
<p>Perform Exploratory Analysis: Anybody who has ever worked with data knows, garbage-in, garbage-out (GIGO). Therefore, it is important to deploy descriptive and graphical statistics to look for potential problems, patterns, classifications, correlations and comparisons in the dataset. In addition, data categorization (i.e. qualitative vs quantitative) is also important to understand and select the correct hypothesis test or data model.</p>
<p>Model Data: Like descriptive and inferential statistics, data modeling can either summarize the data or predict future outcomes. Your dataset and expected results, will determine the algorithms available for use. It’s important to remember, algorithms are tools and not magical wands or silver bullets. You must still be the master craft (wo)man that knows how-to select the right tool for the job. An analogy would be asking someone to hand you a Philip screwdriver, and they hand you a flathead screwdriver or worst a hammer. At best, it shows a complete lack of understanding. At worst, it makes completing the project impossible. The same is true in data modelling. The wrong model can lead to poor performance at best and the wrong conclusion (that’s used as actionable intelligence) at worst.</p>
<p>Validate and Implement Data Model: After you’ve trained your model based on a subset of your data, it’s time to test your model. This helps ensure you haven’t overfit your model or made it so specific to the selected subset, that it does not accurately fit another subset from the same dataset. In this step we determine if <a href="http://docs.aws.amazon.com/machine-learning/latest/dg/model-fit-underfitting-vs-overfitting.html" target="_blank" rel="external">our model overfit, generalize, or underfit our dataset.</a></p>
<p>Optimize and Strategize: This is the “bionic man” step, where you iterate back through the process to make it better…stronger…faster than it was before. As a data scientist, your strategy should be to outsource developer operations and application plumbing, so you have more time to focus on recommendations and design. Once you’re able to package your ideas, this becomes your “currency exchange” rate.</p>
<h2 id="数据科学框架"><a href="#数据科学框架" class="headerlink" title="数据科学框架"></a>数据科学框架</h2><p><strong>定义问题</strong>：如果数据科学，大数据，机器学习，预测分析，商业智能或任何其他流行语是解决方案，那么问题是什么？俗话说，不要把马车放在马前(译者语：不要本末倒置）。要求之前的是问题，解决方案之前的是要求，设计之前的是解决方案和技术之前的是设计。在确定我们正在试图解决的实际问题之前，我们经常会很快用上新的闪闪发光（译者语：shining，作者调皮）的技术，工具或算法。</p>
<p><strong>收集数据</strong>：约翰·奈斯比特（John Naisbitt）在他的《1984》（是，1984）一书中写道，大数据趋势是，我们正在“淹没在数据中，而不是为了知识。”所以，数据集可能已经存在某处。可能是外部的或内部的，结构化的或非结构化的，静态的或流式的，客观的或主观的等等。俗话说，你不必重新发明轮子，你只需要知道在哪里找到它。下一步，我们担心将“脏数据”转换为“干净的数据”。</p>
<p><strong>为消费准备数据</strong>：这一步通常被称为数据整理，这是将“狂放的”数据转化为“可管理”数据所需的过程。数据争夺包括实施用于存储和处理的数据架构，开发质量和控制的数据管理标准，数据提取（即ETL和网页抓取）以及数据清理以识别异常，丢失或异常数据点。</p>
<p><strong>进行探索性分析</strong>：任何曾经使用数据的人都知道，垃圾进入，垃​​圾出（GIGO）。因此，部署描述性和图形化统计数据来查找数据集中潜在的问题，模式，分类，相关性和比较非常重要。此外，数据分类（即定性与定量）对于理解和选择正确的假设检验或数据模型也很重要。</p>
<p><strong>模型数据</strong>：与描述性和推理性统计数据类似，数据建模可以总结数据或预测未来结果。您的数据集和预期结果将决定可供使用的算法。重要的是要记住，算法是工具，而不是魔杖或银弹（译者语：在西方神话中银弹是克制吸血鬼的武器）。你仍然必须是知道如何为工作选择正确的工具的工匠。一个比喻就是要求有人给你一把菲利普螺丝刀，他们给你一把平头螺丝刀或者最差的一把锤子。充其量，它显示完全缺乏了解。最糟糕的是，这使得项目不可能完成。数据建模也是如此。错误的模型可能导致最差的表现，最坏的结论（作为可操作的情报）会导致错误的结论。</p>
<p><strong>验证和实现数据模型</strong>：在基于数据的一个子集训练好模型之后，该测试模型了。这有助于确保您没有过度使用您的模型，或者使其对于所选子集具有如此特定的效果，以至于不能精确地匹配来自同一数据集的另一个子集。在这一步中，我们确定是否我们的模型过度拟合，推广或不适合我们的数据集。</p>
<p>优化和策略：这是“仿生人”的一步，你通过这个过程迭代，使其更好…更强大…比以前更快。作为一名数据科学家，您的策略应该是将开发人员操作和应用程序外包，这样您就有更多时间专注于推荐和设计。一旦你能够打包你的想法，这成为你的“货币兑换”率。</p>
<h2 id="Step-1-Define-the-Problem"><a href="#Step-1-Define-the-Problem" class="headerlink" title="Step 1: Define the Problem"></a>Step 1: Define the Problem</h2><p>For this project, the problem statement is given to us on a golden plater, develop an algorithm to predict the survival outcome of passengers on the Titanic.</p>
<h2 id="第一步：定义问题"><a href="#第一步：定义问题" class="headerlink" title="第一步：定义问题"></a>第一步：定义问题</h2><p>对于这个项目，问题陈述是给予我们一个金色的电镀，开发一个算法来预测泰坦尼克号乘客的生存结果。</p>
<p>……</p>
<p><strong>Project Summary:</strong> The sinking of the RMS Titanic is one of the most infamous shipwrecks in history. On April 15, 1912, during her maiden voyage, the Titanic sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crew. This sensational tragedy shocked the international community and led to better safety regulations for ships.</p>
<p>One of the reasons that the shipwreck led to such loss of life was that there were not enough lifeboats for the passengers and crew. Although there was some element of luck involved in surviving the sinking, some groups of people were more likely to survive than others, such as women, children, and the upper-class.</p>
<p>In this challenge, we ask you to complete the analysis of what sorts of people were likely to survive. In particular, we ask you to apply the tools of machine learning to predict which passengers survived the tragedy.</p>
<p><strong>项目简介：</strong>沉没的泰坦尼克号是历史上最臭名昭着的沉船之一。1912年4月15日，在首航期间，泰坦尼克号撞上一座冰山后沉没，2224名乘客和机组人员中有1502人遇难。这一耸人听闻的悲剧震撼了国际社会，并导致了船舶安全条例的更完善。</p>
<p>沉船导致生命损失的原因之一是乘客和船员没有足够的救生艇。虽然幸存下来的运气有一些因素，但一些人<br>比其他人更有可能生存，比如妇女，儿童和上层阶级。<br>在这个挑战中，我们要求你完成对什么样的人可能生存的分析。特别是，我们要求你运用机器学习的工具来预测哪些乘客幸存下来的悲剧。</p>
<p>Practice Skills</p>
<p>Binary classification<br>Python and R basics</p>
<p>实践技能</p>
<ul>
<li>二进制分类</li>
<li>Python和R基础知识</li>
</ul>
<h2 id="Step-2-Gather-the-Data"><a href="#Step-2-Gather-the-Data" class="headerlink" title="Step 2: Gather the Data"></a>Step 2: Gather the Data</h2><p>The dataset is also given to us on a golden plater with test and train data at <a href="https://www.kaggle.com/c/titanic/data" target="_blank" rel="external">Kaggle’s Titanic: Machine Learning from Disaster</a></p>
<h2 id="第二步：收集数据"><a href="#第二步：收集数据" class="headerlink" title="第二步：收集数据"></a>第二步：收集数据</h2><p>数据集也在Kaggle的<a href="https://www.kaggle.com/c/titanic/data" target="_blank" rel="external">泰坦尼克号：机器学习从灾难中的测试和训练数据</a>上下载</p>
<h2 id="Step-3-Prepare-Data-for-Consumption"><a href="#Step-3-Prepare-Data-for-Consumption" class="headerlink" title="Step 3: Prepare Data for Consumption"></a>Step 3: Prepare Data for Consumption</h2><p>Since step 2 was provided to us on a golden plater, so is step 3. Therefore, normal processes in data wrangling, such as data architecture, governance, and extraction are out of scope. Thus, only data cleaning is in scope.</p>
<h2 id="第三步：准备使用的数据"><a href="#第三步：准备使用的数据" class="headerlink" title="第三步：准备使用的数据"></a>第三步：准备使用的数据</h2><p>由于步骤2是在提供给我们的是一个镀金匠（译者语：应该是指这个数据kaggle已经給好了，无须操作），步骤3也是如此。因此，数据架构，管理和提取等数据争用过程中的正常流程不在范围之内。因此，只有数据清理是在范围之内的。</p>
<p>3.1 Import Libraries<br>The following code is written in Python 3.x. Libraries provide pre-written functionality to perform necessary tasks. The idea is why write ten lines of code, when you can write one line.<br>3.1导入库<br>下面的代码是用Python 3.x编写的。库提供预编写的功能来执行必要的任务。这个想法是为什么写十行代码的时候，你可以写一行代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># This Python 3 environment comes with many helpful analytics libraries installed</span></div><div class="line"><span class="comment"># It is defined by the kaggle/python docker image: https://github.com/kaggle/docker-python</span></div><div class="line"></div><div class="line"><span class="comment">#load packages</span></div><div class="line"><span class="keyword">import</span> sys <span class="comment">#access to system parameters https://docs.python.org/3/library/sys.html</span></div><div class="line">print(<span class="string">"Python version: &#123;&#125;"</span>. format(sys.version))</div><div class="line"></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd <span class="comment">#collection of functions for data processing and analysis modeled after R dataframes with SQL like features</span></div><div class="line">print(<span class="string">"pandas version: &#123;&#125;"</span>. format(pd.__version__))</div><div class="line"></div><div class="line"><span class="keyword">import</span> matplotlib <span class="comment">#collection of functions for scientific and publication-ready visualization</span></div><div class="line">print(<span class="string">"matplotlib version: &#123;&#125;"</span>. format(matplotlib.__version__))</div><div class="line"></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np <span class="comment">#foundational package for scientific computing</span></div><div class="line">print(<span class="string">"NumPy version: &#123;&#125;"</span>. format(np.__version__))</div><div class="line"></div><div class="line"><span class="keyword">import</span> scipy <span class="keyword">as</span> sp <span class="comment">#collection of functions for scientific computing and advance mathematics</span></div><div class="line">print(<span class="string">"SciPy version: &#123;&#125;"</span>. format(sp.__version__)) </div><div class="line"></div><div class="line"><span class="keyword">import</span> IPython</div><div class="line"><span class="keyword">from</span> IPython <span class="keyword">import</span> display <span class="comment">#pretty printing of dataframes in Jupyter notebook</span></div><div class="line">print(<span class="string">"IPython version: &#123;&#125;"</span>. format(IPython.__version__)) </div><div class="line"></div><div class="line"><span class="keyword">import</span> sklearn <span class="comment">#collection of machine learning algorithms</span></div><div class="line">print(<span class="string">"scikit-learn version: &#123;&#125;"</span>. format(sklearn.__version__))</div><div class="line"></div><div class="line"><span class="comment">#misc libraries</span></div><div class="line"><span class="keyword">import</span> random</div><div class="line"><span class="keyword">import</span> time</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#ignore warnings</span></div><div class="line"><span class="keyword">import</span> warnings</div><div class="line">warnings.filterwarnings(<span class="string">'ignore'</span>)</div><div class="line">print(<span class="string">'-'</span>*<span class="number">25</span>)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># Input data files are available in the "../input/" directory.</span></div><div class="line"><span class="comment"># For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> check_output</div><div class="line"></div><div class="line">print(check_output([<span class="string">"powershell.exe"</span>,<span class="string">" ls"</span>, <span class="string">"../input"</span>]).decode(<span class="string">"utf8"</span>))</div><div class="line"><span class="comment"># If your computer is linux use next one</span></div><div class="line"><span class="comment">#print(check_output([," ls", "../input"]).decode("utf8"))</span></div><div class="line"></div><div class="line"><span class="comment"># Any results you write to the current directory are saved as output.</span></div></pre></td></tr></table></figure>
<pre><code>Python version: 3.6.0 |Anaconda custom (64-bit)| (default, Dec 23 2016, 11:57:41) [MSC v.1900 64 bit (AMD64)]
pandas version: 0.20.3
matplotlib version: 2.0.2
NumPy version: 1.13.3
SciPy version: 1.0.0
IPython version: 6.1.0
scikit-learn version: 0.19.1
-------------------------


    Ŀ¼: E:\onedrive\python_codes\Kaggle\Titanic\input


Mode                LastWriteTime         Length Name                                                                  
----                -------------         ------ ----                                                                  
-a----       2017/12/20     16:42           3258 gender_submission.csv                                                 
-a----       2017/12/20     16:42          28629 test.csv                                                              
-a----       2017/12/20     16:42          61194 train.csv                                                             
</code></pre><h2 id="3-11-Load-Data-Modelling-Libraries¶"><a href="#3-11-Load-Data-Modelling-Libraries¶" class="headerlink" title="3.11 Load Data Modelling Libraries¶"></a>3.11 Load Data Modelling Libraries¶</h2><p>We will use the popular scikit-learn library to develop our machine learning algorithms. In sklearn, algorithms are called Estimators and implemented in their own classes. For data visualization, we will use the matplotlib and seaborn library. Below are common classes to load.</p>
<h2 id="3-11加载数据建模库"><a href="#3-11加载数据建模库" class="headerlink" title="3.11加载数据建模库"></a>3.11加载数据建模库</h2><p>我们将使用流行的scikit学习库来开发我们的机器学习算法。在sklearn中，算法被称为估计器，并在他们自己的类中实现。为了数据可视化，我们将使用matplotlib和seaborn库。以下是常见的类加载。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Common Model Algorithms</span></div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm, tree, linear_model, neighbors, naive_bayes, ensemble, discriminant_analysis, gaussian_process</div><div class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> XGBClassifier</div><div class="line"></div><div class="line"><span class="comment">#Common Model Helpers</span></div><div class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder, LabelEncoder</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> feature_selection</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> model_selection</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics</div><div class="line"></div><div class="line"><span class="comment">#Visualization</span></div><div class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> matplotlib.pylab <span class="keyword">as</span> pylab</div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div><div class="line"><span class="keyword">from</span> pandas.tools.plotting <span class="keyword">import</span> scatter_matrix</div><div class="line"></div><div class="line"><span class="comment">#Configure Visualization Defaults</span></div><div class="line"><span class="comment">#%matplotlib inline = show plots in Jupyter Notebook browser</span></div><div class="line">%matplotlib inline</div><div class="line">mpl.style.use(<span class="string">'ggplot'</span>)</div><div class="line">sns.set_style(<span class="string">'white'</span>)</div><div class="line">pylab.rcParams[<span class="string">'figure.figsize'</span>] = <span class="number">12</span>,<span class="number">8</span></div></pre></td></tr></table></figure>
<h2 id="3-2-Meet-and-Greet-Data"><a href="#3-2-Meet-and-Greet-Data" class="headerlink" title="3.2 Meet and Greet Data"></a>3.2 Meet and Greet Data</h2><p>This is the meet and greet step. Get to know your data by first name and learn a little bit about it. What does it look like (datatype and values), what makes it tick (independent/feature variables(s)), what’s its goals in life (dependent/target variable(s)). Think of it like a first date, before you jump in and start poking it in the bedroom.</p>
<p>To begin this step, we first import our data. Next we use the info() and sample() function, to get a quick and dirty overview of variable datatypes (i.e. qualitative vs quantitative). Click here for the Source Data Dictionary.</p>
<ol>
<li><p>The Survived variable is our outcome or dependent variable. It is a binary nominal datatype of 1 for survived and 0 for did not survive. All other variables are potential predictor or independent variables. It’s important to note, more predictor variables do not make a better model, but the right variables.</p>
</li>
<li><p>The PassengerID and Ticket variables are assumed to be random unique identifiers, that have no impact on the outcome variable. Thus, they will be excluded from analysis.</p>
</li>
<li><p>The Pclass variable is an ordinal datatype for the ticket class, a proxy for socio-economic status (SES), representing 1 = upper class, 2 = middle class, and 3 = lower class.</p>
</li>
<li><p>The Name variable is a nominal datatype. It could be used in feature engineering to derive the gender from title, family size from surname, and SES from titles like doctor or master. Since these variables already exist, we’ll make use of it to see if title, like master, makes a difference.</p>
</li>
<li><p>The Sex and Embarked variables are a nominal datatype. They will be converted to dummy variables for mathematical calculations.</p>
</li>
<li><p>The Age and Fare variable are continuous quantitative datatypes.</p>
</li>
<li><p>The SibSp represents number of related siblings/spouse aboard and Parch represents number of related parents/children aboard. Both are discrete quantitative datatypes. This can be used for feature engineering to create a family size and is alone variable.</p>
</li>
<li><p>The Cabin variable is a nominal datatype that can be used in feature engineering for approximate position on ship when the incident occurred and SES from deck levels. However, since there are many null values, it does not add value and thus is excluded from analysis.</p>
</li>
</ol>
<h2 id="3-2-迎接和问候数据"><a href="#3-2-迎接和问候数据" class="headerlink" title="3.2 迎接和问候数据"></a>3.2 迎接和问候数据</h2><p>这是见面和迎接的一步。通过名字了解你的数据，并学习一点点。它看起来是什么样子（数据类型和值），是什么让它打勾（独立/特征变量），它的目标是什么（依赖/目标变量）。把它想象成第一次约会，然后再跳进去，开始在卧室里捅它。<br>要开始这一步，我们首先导入我们的数据。接下来我们使用info（）和sample（）函数来获得变量数据类型（即定性和定量）的快速和肮脏的概述。点击这里查看源数据字典。</p>
<ol>
<li>Survived 变量是我们的结果或因变量。这是一个二进制名义数据类型为 1 生还和 0 没有生还。所有其他变量都是潜在的预测变量或自变量。<strong>重要的是要注意，更多的预测变量不是一个更好的模型，而是正确的变量。</strong></li>
<li>PassengerID 和 Ticket 变量被假定为随机的唯一标识符，对结果变量没有影响。因此，他们将被排除在分析之外。</li>
<li>Pclass 变量是票据类的序数据类型，是社会经济地位（SES）的代理，代表1 =上层，2 =中层，3 =下层。</li>
<li>Name 变量是一个名义数据类型。它可以用于特征工程，以从头衔，姓氏的家庭大小，从医生或主人这样的头衔获得SES。由于这些变量已经存在，我们将使用它来查看标题，如master，是否有所作为。</li>
<li>Sex和 Embarked 变量是名词（译者语：字符串string）数据类型。他们将被转换为虚拟变量进行数学计算。</li>
<li>Age 和 Fare 变量是连续的定量数据类型。</li>
<li>SibSp 表示船上相关兄弟姐妹/配偶的人数，Parch 表示船上相关父母/子女的人数。两者都是离散的定量数据类型。这可以用于特征工程创建一个家庭大小，是单独变量。</li>
<li>Cabin 变量是一种名义数据类型，可以在特征工程中用于船舶发生事故时的近似位置和经济水平的SES。但是，由于有许多空值，因此不会增加值，因此不能从分析中排除。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#import data from file: https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html</span></div><div class="line">data_raw = pd.read_csv(<span class="string">'../input/train.csv'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#a dataset should be broken into 3 splits: train, test, and (final) validation</span></div><div class="line"><span class="comment">#the test file provided is the validation file for competition submission</span></div><div class="line"><span class="comment">#we will split the train set into train and test data in future sections</span></div><div class="line">data_val  = pd.read_csv(<span class="string">'../input/test.csv'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#to play with our data we'll create a copy</span></div><div class="line"><span class="comment">#remember python assignment or equal passes by reference vs values, so we use the copy function: https://stackoverflow.com/questions/46327494/python-pandas-dataframe-copydeep-false-vs-copydeep-true-vs</span></div><div class="line">data1 = data_raw.copy(deep = <span class="keyword">True</span>)</div><div class="line"></div><div class="line"><span class="comment">#however passing by reference is convenient, because we can clean both datasets at once</span></div><div class="line">data_cleaner = [data1, data_val]</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#preview data</span></div><div class="line"><span class="keyword">print</span> (data_raw.info()) <span class="comment">#https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.info.html</span></div><div class="line"><span class="comment">#data_raw.head() #https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.head.html</span></div><div class="line"><span class="comment">#data_raw.tail() #https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.tail.html</span></div><div class="line">data_raw.sample(<span class="number">10</span>) <span class="comment">#https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.sample.html</span></div></pre></td></tr></table></figure>
<pre><code>&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
PassengerId    891 non-null int64
Survived       891 non-null int64
Pclass         891 non-null int64
Name           891 non-null object
Sex            891 non-null object
Age            714 non-null float64
SibSp          891 non-null int64
Parch          891 non-null int64
Ticket         891 non-null object
Fare           891 non-null float64
Cabin          204 non-null object
Embarked       889 non-null object
dtypes: float64(2), int64(5), object(5)
memory usage: 83.6+ KB
None
</code></pre><div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right"><br>      <th></th><br>      <th>PassengerId</th><br>      <th>Survived</th><br>      <th>Pclass</th><br>      <th>Name</th><br>      <th>Sex</th><br>      <th>Age</th><br>      <th>SibSp</th><br>      <th>Parch</th><br>      <th>Ticket</th><br>      <th>Fare</th><br>      <th>Cabin</th><br>      <th>Embarked</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>544</th><br>      <td>545</td><br>      <td>0</td><br>      <td>1</td><br>      <td>Douglas, Mr. Walter Donald</td><br>      <td>male</td><br>      <td>50.0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>PC 17761</td><br>      <td>106.4250</td><br>      <td>C86</td><br>      <td>C</td><br>    </tr><br>    <tr><br>      <th>354</th><br>      <td>355</td><br>      <td>0</td><br>      <td>3</td><br>      <td>Yousif, Mr. Wazli</td><br>      <td>male</td><br>      <td>NaN</td><br>      <td>0</td><br>      <td>0</td><br>      <td>2647</td><br>      <td>7.2250</td><br>      <td>NaN</td><br>      <td>C</td><br>    </tr><br>    <tr><br>      <th>331</th><br>      <td>332</td><br>      <td>0</td><br>      <td>1</td><br>      <td>Partner, Mr. Austen</td><br>      <td>male</td><br>      <td>45.5</td><br>      <td>0</td><br>      <td>0</td><br>      <td>113043</td><br>      <td>28.5000</td><br>      <td>C124</td><br>      <td>S</td><br>    </tr><br>    <tr><br>      <th>463</th><br>      <td>464</td><br>      <td>0</td><br>      <td>2</td><br>      <td>Milling, Mr. Jacob Christian</td><br>      <td>male</td><br>      <td>48.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>234360</td><br>      <td>13.0000</td><br>      <td>NaN</td><br>      <td>S</td><br>    </tr><br>    <tr><br>      <th>842</th><br>      <td>843</td><br>      <td>1</td><br>      <td>1</td><br>      <td>Serepeca, Miss. Augusta</td><br>      <td>female</td><br>      <td>30.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>113798</td><br>      <td>31.0000</td><br>      <td>NaN</td><br>      <td>C</td><br>    </tr><br>    <tr><br>      <th>545</th><br>      <td>546</td><br>      <td>0</td><br>      <td>1</td><br>      <td>Nicholson, Mr. Arthur Ernest</td><br>      <td>male</td><br>      <td>64.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>693</td><br>      <td>26.0000</td><br>      <td>NaN</td><br>      <td>S</td><br>    </tr><br>    <tr><br>      <th>473</th><br>      <td>474</td><br>      <td>1</td><br>      <td>2</td><br>      <td>Jerwan, Mrs. Amin S (Marie Marthe Thuillard)</td><br>      <td>female</td><br>      <td>23.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>SC/AH Basle 541</td><br>      <td>13.7917</td><br>      <td>D</td><br>      <td>C</td><br>    </tr><br>    <tr><br>      <th>730</th><br>      <td>731</td><br>      <td>1</td><br>      <td>1</td><br>      <td>Allen, Miss. Elisabeth Walton</td><br>      <td>female</td><br>      <td>29.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>24160</td><br>      <td>211.3375</td><br>      <td>B5</td><br>      <td>S</td><br>    </tr><br>    <tr><br>      <th>200</th><br>      <td>201</td><br>      <td>0</td><br>      <td>3</td><br>      <td>Vande Walle, Mr. Nestor Cyriel</td><br>      <td>male</td><br>      <td>28.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>345770</td><br>      <td>9.5000</td><br>      <td>NaN</td><br>      <td>S</td><br>    </tr><br>    <tr><br>      <th>676</th><br>      <td>677</td><br>      <td>0</td><br>      <td>3</td><br>      <td>Sawyer, Mr. Frederick Charles</td><br>      <td>male</td><br>      <td>24.5</td><br>      <td>0</td><br>      <td>0</td><br>      <td>342826</td><br>      <td>8.0500</td><br>      <td>NaN</td><br>      <td>S</td><br>    </tr><br>  </tbody><br></table><br></div>



<h2 id="3-21-The-4-C’s-of-Data-Cleaning-Correcting-Completing-Creating-and-Converting"><a href="#3-21-The-4-C’s-of-Data-Cleaning-Correcting-Completing-Creating-and-Converting" class="headerlink" title="3.21 The 4 C’s of Data Cleaning: Correcting, Completing, Creating, and Converting"></a>3.21 The 4 C’s of Data Cleaning: Correcting, Completing, Creating, and Converting</h2><p>In this stage, we will clean our data by 1) correcting aberrant values and outliers, 2) completing missing information, 3) creating new features for analysis, and 4) converting fields to the correct format for calculations and presentation.</p>
<ol>
<li><p>Correcting: Reviewing the data, there does not appear to be any aberrant or non-acceptable data inputs. In addition, we see we may have potential outliers in age and fare. However, since they are reasonable values, we will wait until after we complete our exploratory analysis to determine if we should include or exclude from the dataset. It should be noted, that if they were unreasonable values, for example age = 800 instead of 80, then it’s probably a safe decision to fix now. However, we want to use caution when we modify data from its original value, because it may be necessary to create an accurate model.</p>
</li>
<li><p>Completing: There are null values or missing data in the age, cabin, and embarked field. Missing values can be bad, because some algorithms don’t know how-to handle null values and will fail. While others, like decision trees, can handle null values. Thus, it’s important to fix before we start modeling, because we will compare and contrast several models. There are two common methods, either delete the record or populate the missing value using a reasonable input. It is not recommended to delete the record, especially a large percentage of records, unless it truly represents an incomplete record. Instead, it’s best to impute missing values. A basic methodology for qualitative data is impute using mode. A basic methodology for quantitative data is impute using mean, median, or mean + randomized standard deviation. An intermediate methodology is to use the basic methodology based on specific criteria; like the average age by class or embark port by fare and SES. There are more complex methodologies, however before deploying, it should be compared to the base model to determine if complexity truly adds value. For this dataset, age will be imputed with the median, the cabin attribute will be dropped, and embark will be imputed with mode. Subsequent model iterations may modify this decision to determine if it improves the model’s accuracy.</p>
</li>
<li><p>Creating: Feature engineering is when we use existing features to create new features to determine if they provide new signals to predict our outcome. For this dataset, we will create a title feature to determine if it played a role in survival.</p>
</li>
<li><p>Converting: Last, but certainly not least, we’ll deal with formatting. There are no date or currency formats, but datatype formats. Our categorical data imported as objects, which makes it difficult for mathematical calculations. For this dataset, we will convert object datatypes to categorical dummy variables.</p>
</li>
</ol>
<h2 id="3-21数据清理4-C：修正，完成，创建和转换"><a href="#3-21数据清理4-C：修正，完成，创建和转换" class="headerlink" title="3.21数据清理4 C：修正，完成，创建和转换"></a>3.21数据清理4 C：修正，完成，创建和转换</h2><p>在这个阶段，我们将通过1）校正异常值和异常值，2）完成缺失信息，3）创建新的分析功能，4）将字段转换为正确的格式进行计算和表示。</p>
<ol>
<li>纠正：审查数据，似乎没有任何异常或不可接受的数据输入。另外，我们看到我们可能在年龄和票价上有潜在的异常值。但是，由于它们是合理的值，我们将等到完成我们的探索性分析后确定是否应包含或排除数据集。应该指出的是，如果它们是不合理的价值，例如年龄= 800而不是80，那么现在就可以做出安全的决定。但是，当我们从原始值修改数据时，我们要谨慎，因为可能需要创建一个精确的模型。</li>
<li>完成：在年龄，机舱和装载领域有空值或缺失数据。缺少值可能是不好的，因为一些算法不知道如何处理空值，将失败。而其他人，如决策树，可以处理空值。因此，在我们开始建模之前修复是很重要的，因为我们将比较和对比几个模型。有两种常用方法，可以删除记录，也可以使用合理的输入填充缺失的值。不建议删除记录，特别是大部分记录，除非它确实代表不完整的记录。相反，最好是对缺失值进行补偿。定性数据的基本方法是使用模式。定量数据的基本方法是使用平均值，中位数或平均值+随机标准偏差进行估算。一种中间方法是使用基于特定标准的基本方法; 比如按班级平均年龄或按票价和SES（经济地位）登船。还有更复杂的方法，但是在部署之前，应该将其与基础模型进行比较，以确定复杂性是否真正增加了价值。对于这个数据集，年龄将被计算与中位数，客舱属性将被放弃，并进行模式估算。后续的模型迭代可以修改这个决定，以确定它是否提高了模型的准确性。年龄将与中位数进行估算，客舱属性将被丢弃，并将以模式进行出发。后续的模型迭代可以修改这个决定，以确定它是否提高了模型的准确性。年龄将与中位数进行估算，客舱属性将被丢弃，并将以模式进行出发。后续的模型迭代可以修改这个决定，以确定它是否提高了模型的准确性。</li>
<li>创建：特征工程就是当我们使用现有特征来创建新特征来确定它们是否提供了新的信号来预测我们的结果。对于这个数据集，我们将创建一个标题特征来确定它是否在生存中起作用。</li>
<li>转换：最后，但并非最不重要，我们将处理格式。没有日期或货币格式，但数据格式。我们将分类数据导入为对象，这使得数学计算变得困难。对于这个数据集，我们将把对象数据类型转换为分类虚拟变量。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">print(<span class="string">'Train columns with null values:\n'</span>, data1.isnull().sum())</div><div class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</div><div class="line"></div><div class="line">print(<span class="string">'Test/Validation columns with null values:\n'</span>, data_val.isnull().sum())</div><div class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</div><div class="line"></div><div class="line">data_raw.describe(include = <span class="string">'all'</span>)</div></pre></td></tr></table></figure>
<pre><code>Train columns with null values:
 PassengerId      0
Survived         0
Pclass           0
Name             0
Sex              0
Age            177
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          687
Embarked         2
dtype: int64
----------
Test/Validation columns with null values:
 PassengerId      0
Pclass           0
Name             0
Sex              0
Age             86
SibSp            0
Parch            0
Ticket           0
Fare             1
Cabin          327
Embarked         0
dtype: int64
----------
</code></pre><div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right"><br>      <th></th><br>      <th>PassengerId</th><br>      <th>Survived</th><br>      <th>Pclass</th><br>      <th>Name</th><br>      <th>Sex</th><br>      <th>Age</th><br>      <th>SibSp</th><br>      <th>Parch</th><br>      <th>Ticket</th><br>      <th>Fare</th><br>      <th>Cabin</th><br>      <th>Embarked</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>count</th><br>      <td>891.000000</td><br>      <td>891.000000</td><br>      <td>891.000000</td><br>      <td>891</td><br>      <td>891</td><br>      <td>714.000000</td><br>      <td>891.000000</td><br>      <td>891.000000</td><br>      <td>891</td><br>      <td>891.000000</td><br>      <td>204</td><br>      <td>889</td><br>    </tr><br>    <tr><br>      <th>unique</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>891</td><br>      <td>2</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>681</td><br>      <td>NaN</td><br>      <td>147</td><br>      <td>3</td><br>    </tr><br>    <tr><br>      <th>top</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>Hoyt, Mr. William Fisher</td><br>      <td>male</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>347082</td><br>      <td>NaN</td><br>      <td>G6</td><br>      <td>S</td><br>    </tr><br>    <tr><br>      <th>freq</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>1</td><br>      <td>577</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>7</td><br>      <td>NaN</td><br>      <td>4</td><br>      <td>644</td><br>    </tr><br>    <tr><br>      <th>mean</th><br>      <td>446.000000</td><br>      <td>0.383838</td><br>      <td>2.308642</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>29.699118</td><br>      <td>0.523008</td><br>      <td>0.381594</td><br>      <td>NaN</td><br>      <td>32.204208</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>std</th><br>      <td>257.353842</td><br>      <td>0.486592</td><br>      <td>0.836071</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>14.526497</td><br>      <td>1.102743</td><br>      <td>0.806057</td><br>      <td>NaN</td><br>      <td>49.693429</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>min</th><br>      <td>1.000000</td><br>      <td>0.000000</td><br>      <td>1.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>0.420000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>NaN</td><br>      <td>0.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>25%</th><br>      <td>223.500000</td><br>      <td>0.000000</td><br>      <td>2.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>20.125000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>NaN</td><br>      <td>7.910400</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>50%</th><br>      <td>446.000000</td><br>      <td>0.000000</td><br>      <td>3.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>28.000000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>NaN</td><br>      <td>14.454200</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>75%</th><br>      <td>668.500000</td><br>      <td>1.000000</td><br>      <td>3.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>38.000000</td><br>      <td>1.000000</td><br>      <td>0.000000</td><br>      <td>NaN</td><br>      <td>31.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>max</th><br>      <td>891.000000</td><br>      <td>1.000000</td><br>      <td>3.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>80.000000</td><br>      <td>8.000000</td><br>      <td>6.000000</td><br>      <td>NaN</td><br>      <td>512.329200</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>  </tbody><br></table><br></div>



<h2 id="3-22-Clean-Data"><a href="#3-22-Clean-Data" class="headerlink" title="3.22 Clean Data"></a>3.22 Clean Data</h2><p>Now that we know what to clean, let’s execute our code.</p>
<p>Developer Documentation:</p>
<p>现在我们将了解如何清洗，让我们执行我们的代码吧。</p>
<p>开发文档：</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html" target="_blank" rel="external">pandas.DataFrame</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.info.html" target="_blank" rel="external">pandas.DataFrame.info</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.describe.html" target="_blank" rel="external">pandas.DataFrame.describe</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/indexing.html" target="_blank" rel="external">Indexing and Selecting Data</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.isnull.html" target="_blank" rel="external">pandas.isnull</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.sum.html" target="_blank" rel="external">pandas.DataFrame.sum</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.mode.html" target="_blank" rel="external">pandas.DataFrame.mode</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.copy.html" target="_blank" rel="external">pandas.DataFrame.copy</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.fillna.html" target="_blank" rel="external">pandas.DataFrame.fillna</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.drop.html" target="_blank" rel="external">pandas.DataFrame.drop</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.value_counts.html" target="_blank" rel="external">pandas.Series.value_counts</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.loc.html" target="_blank" rel="external">pandas.DataFrame.loc</a></p>
<h2 id="3-22-数据清洗"><a href="#3-22-数据清洗" class="headerlink" title="3.22 数据清洗"></a>3.22 数据清洗</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##COMPLETING: complete or delete missing values in train and test/validation dataset</span></div><div class="line"><span class="keyword">for</span> dataset <span class="keyword">in</span> data_cleaner:    </div><div class="line">    <span class="comment">#complete missing age with median</span></div><div class="line">    dataset[<span class="string">'Age'</span>].fillna(dataset[<span class="string">'Age'</span>].median(), inplace = <span class="keyword">True</span>)</div><div class="line"></div><div class="line">    <span class="comment">#complete embarked with mode</span></div><div class="line">    dataset[<span class="string">'Embarked'</span>].fillna(dataset[<span class="string">'Embarked'</span>].mode()[<span class="number">0</span>], inplace = <span class="keyword">True</span>)</div><div class="line"></div><div class="line">    <span class="comment">#complete missing fare with median</span></div><div class="line">    dataset[<span class="string">'Fare'</span>].fillna(dataset[<span class="string">'Fare'</span>].median(), inplace = <span class="keyword">True</span>)</div><div class="line">    </div><div class="line"><span class="comment">#delete the cabin feature/column and others previously stated to exclude in train dataset</span></div><div class="line">drop_column = [<span class="string">'PassengerId'</span>,<span class="string">'Cabin'</span>, <span class="string">'Ticket'</span>]</div><div class="line">data1.drop(drop_column, axis=<span class="number">1</span>, inplace = <span class="keyword">True</span>)</div><div class="line"></div><div class="line">print(data1.isnull().sum())</div><div class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</div><div class="line">print(data_val.isnull().sum())</div></pre></td></tr></table></figure>
<pre><code>Survived    0
Pclass      0
Name        0
Sex         0
Age         0
SibSp       0
Parch       0
Fare        0
Embarked    0
dtype: int64
----------
PassengerId      0
Pclass           0
Name             0
Sex              0
Age              0
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          327
Embarked         0
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##CREATE: Feature Engineering for train and test/validation dataset</span></div><div class="line"><span class="keyword">for</span> dataset <span class="keyword">in</span> data_cleaner:    </div><div class="line">    <span class="comment">#Discrete variables</span></div><div class="line">    dataset[<span class="string">'FamilySize'</span>] = dataset [<span class="string">'SibSp'</span>] + dataset[<span class="string">'Parch'</span>] + <span class="number">1</span></div><div class="line"></div><div class="line">    dataset[<span class="string">'IsAlone'</span>] = <span class="number">1</span> <span class="comment">#initialize to yes/1 is alone</span></div><div class="line">    dataset[<span class="string">'IsAlone'</span>].loc[dataset[<span class="string">'FamilySize'</span>] &gt; <span class="number">1</span>] = <span class="number">0</span> <span class="comment"># now update to no/0 if family size is greater than 1</span></div><div class="line"></div><div class="line">    <span class="comment">#quick and dirty code split title from name: http://www.pythonforbeginners.com/dictionary/python-split</span></div><div class="line">    dataset[<span class="string">'Title'</span>] = dataset[<span class="string">'Name'</span>].str.split(<span class="string">", "</span>, expand=<span class="keyword">True</span>)[<span class="number">1</span>].str.split(<span class="string">"."</span>, expand=<span class="keyword">True</span>)[<span class="number">0</span>]</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">#Continuous variable bins; qcut vs cut: https://stackoverflow.com/questions/30211923/what-is-the-difference-between-pandas-qcut-and-pandas-cut</span></div><div class="line">    <span class="comment">#Fare Bins/Buckets using qcut or frequency bins: https://pandas.pydata.org/pandas-docs/stable/generated/pandas.qcut.html</span></div><div class="line">    dataset[<span class="string">'FareBin'</span>] = pd.qcut(dataset[<span class="string">'Fare'</span>], <span class="number">4</span>)</div><div class="line"></div><div class="line">    <span class="comment">#Age Bins/Buckets using cut or value bins: https://pandas.pydata.org/pandas-docs/stable/generated/pandas.cut.html</span></div><div class="line">    dataset[<span class="string">'AgeBin'</span>] = pd.cut(dataset[<span class="string">'Age'</span>].astype(int), <span class="number">5</span>)</div><div class="line"></div><div class="line"></div><div class="line">    </div><div class="line"><span class="comment">#cleanup rare title names</span></div><div class="line"><span class="comment">#print(data1['Title'].value_counts())</span></div><div class="line">stat_min = <span class="number">10</span> <span class="comment">#while small is arbitrary, we'll use the common minimum in statistics: http://nicholasjjackson.com/2012/03/08/sample-size-is-10-a-magic-number/</span></div><div class="line">title_names = (data1[<span class="string">'Title'</span>].value_counts() &lt; stat_min) <span class="comment">#this will create a true false series with title name as index</span></div><div class="line"></div><div class="line"><span class="comment">#apply and lambda functions are quick and dirty code to find and replace with fewer lines of code: https://community.modeanalytics.com/python/tutorial/pandas-groupby-and-python-lambda-functions/</span></div><div class="line">data1[<span class="string">'Title'</span>] = data1[<span class="string">'Title'</span>].apply(<span class="keyword">lambda</span> x: <span class="string">'Misc'</span> <span class="keyword">if</span> title_names.loc[x] == <span class="keyword">True</span> <span class="keyword">else</span> x)</div><div class="line">print(data1[<span class="string">'Title'</span>].value_counts())</div><div class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#preview data again</span></div><div class="line">data1.info()</div><div class="line">data_val.info()</div><div class="line">data1.sample(<span class="number">10</span>)</div></pre></td></tr></table></figure>
<pre><code>Mr        517
Miss      182
Mrs       125
Master     40
Misc       27
Name: Title, dtype: int64
----------
&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 14 columns):
Survived      891 non-null int64
Pclass        891 non-null int64
Name          891 non-null object
Sex           891 non-null object
Age           891 non-null float64
SibSp         891 non-null int64
Parch         891 non-null int64
Fare          891 non-null float64
Embarked      891 non-null object
FamilySize    891 non-null int64
IsAlone       891 non-null int64
Title         891 non-null object
FareBin       891 non-null category
AgeBin        891 non-null category
dtypes: category(2), float64(2), int64(6), object(4)
memory usage: 85.5+ KB
&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;
RangeIndex: 418 entries, 0 to 417
Data columns (total 16 columns):
PassengerId    418 non-null int64
Pclass         418 non-null int64
Name           418 non-null object
Sex            418 non-null object
Age            418 non-null float64
SibSp          418 non-null int64
Parch          418 non-null int64
Ticket         418 non-null object
Fare           418 non-null float64
Cabin          91 non-null object
Embarked       418 non-null object
FamilySize     418 non-null int64
IsAlone        418 non-null int64
Title          418 non-null object
FareBin        418 non-null category
AgeBin         418 non-null category
dtypes: category(2), float64(2), int64(6), object(6)
memory usage: 46.8+ KB
</code></pre><div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right"><br>      <th></th><br>      <th>Survived</th><br>      <th>Pclass</th><br>      <th>Name</th><br>      <th>Sex</th><br>      <th>Age</th><br>      <th>SibSp</th><br>      <th>Parch</th><br>      <th>Fare</th><br>      <th>Embarked</th><br>      <th>FamilySize</th><br>      <th>IsAlone</th><br>      <th>Title</th><br>      <th>FareBin</th><br>      <th>AgeBin</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>476</th><br>      <td>0</td><br>      <td>2</td><br>      <td>Renouf, Mr. Peter Henry</td><br>      <td>male</td><br>      <td>34.0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>21.0000</td><br>      <td>S</td><br>      <td>2</td><br>      <td>0</td><br>      <td>Mr</td><br>      <td>(14.454, 31.0]</td><br>      <td>(32.0, 48.0]</td><br>    </tr><br>    <tr><br>      <th>378</th><br>      <td>0</td><br>      <td>3</td><br>      <td>Betros, Mr. Tannous</td><br>      <td>male</td><br>      <td>20.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>4.0125</td><br>      <td>C</td><br>      <td>1</td><br>      <td>1</td><br>      <td>Mr</td><br>      <td>(-0.001, 7.91]</td><br>      <td>(16.0, 32.0]</td><br>    </tr><br>    <tr><br>      <th>560</th><br>      <td>0</td><br>      <td>3</td><br>      <td>Morrow, Mr. Thomas Rowan</td><br>      <td>male</td><br>      <td>28.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>7.7500</td><br>      <td>Q</td><br>      <td>1</td><br>      <td>1</td><br>      <td>Mr</td><br>      <td>(-0.001, 7.91]</td><br>      <td>(16.0, 32.0]</td><br>    </tr><br>    <tr><br>      <th>338</th><br>      <td>1</td><br>      <td>3</td><br>      <td>Dahl, Mr. Karl Edwart</td><br>      <td>male</td><br>      <td>45.0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>8.0500</td><br>      <td>S</td><br>      <td>1</td><br>      <td>1</td><br>      <td>Mr</td><br>      <td>(7.91, 14.454]</td><br>      <td>(32.0, 48.0]</td><br>    </tr><br>    <tr><br>      <th>724</th><br>      <td>1</td><br>      <td>1</td><br>      <td>Chambers, Mr. Norman Campbell</td><br>      <td>male</td><br>      <td>27.0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>53.1000</td><br>      <td>S</td><br>      <td>2</td><br>      <td>0</td><br>      <td>Mr</td><br>      <td>(31.0, 512.329]</td><br>      <td>(16.0, 32.0]</td><br>    </tr><br>    <tr><br>      <th>262</th><br>      <td>0</td><br>      <td>1</td><br>      <td>Taussig, Mr. Emil</td><br>      <td>male</td><br>      <td>52.0</td><br>      <td>1</td><br>      <td>1</td><br>      <td>79.6500</td><br>      <td>S</td><br>      <td>3</td><br>      <td>0</td><br>      <td>Mr</td><br>      <td>(31.0, 512.329]</td><br>      <td>(48.0, 64.0]</td><br>    </tr><br>    <tr><br>      <th>792</th><br>      <td>0</td><br>      <td>3</td><br>      <td>Sage, Miss. Stella Anna</td><br>      <td>female</td><br>      <td>28.0</td><br>      <td>8</td><br>      <td>2</td><br>      <td>69.5500</td><br>      <td>S</td><br>      <td>11</td><br>      <td>0</td><br>      <td>Miss</td><br>      <td>(31.0, 512.329]</td><br>      <td>(16.0, 32.0]</td><br>    </tr><br>    <tr><br>      <th>676</th><br>      <td>0</td><br>      <td>3</td><br>      <td>Sawyer, Mr. Frederick Charles</td><br>      <td>male</td><br>      <td>24.5</td><br>      <td>0</td><br>      <td>0</td><br>      <td>8.0500</td><br>      <td>S</td><br>      <td>1</td><br>      <td>1</td><br>      <td>Mr</td><br>      <td>(7.91, 14.454]</td><br>      <td>(16.0, 32.0]</td><br>    </tr><br>    <tr><br>      <th>556</th><br>      <td>1</td><br>      <td>1</td><br>      <td>Duff Gordon, Lady. (Lucille Christiana Sutherl…</td><br>      <td>female</td><br>      <td>48.0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>39.6000</td><br>      <td>C</td><br>      <td>2</td><br>      <td>0</td><br>      <td>Misc</td><br>      <td>(31.0, 512.329]</td><br>      <td>(32.0, 48.0]</td><br>    </tr><br>    <tr><br>      <th>565</th><br>      <td>0</td><br>      <td>3</td><br>      <td>Davies, Mr. Alfred J</td><br>      <td>male</td><br>      <td>24.0</td><br>      <td>2</td><br>      <td>0</td><br>      <td>24.1500</td><br>      <td>S</td><br>      <td>3</td><br>      <td>0</td><br>      <td>Mr</td><br>      <td>(14.454, 31.0]</td><br>      <td>(16.0, 32.0]</td><br>    </tr><br>  </tbody><br></table><br></div>



<p>3.23 Convert Formats<br>We will convert categorical data to dummy variables for mathematical analysis. There are multiple ways to encode categorical variables; we will use the sklearn and pandas functions.</p>
<p>In this step, we will also define our x (independent/features/explanatory/predictor/etc.) and y (dependent/target/outcome/response/etc.) variables for data modeling.</p>
<p>Developer Documentation:</p>
<h2 id="3-23-转换格式"><a href="#3-23-转换格式" class="headerlink" title="3.23 转换格式"></a>3.23 转换格式</h2><p>我们将分类数据转换为虚拟变量进行数学分析。有多种方法来编码分类变量。我们将使用sklearn和pandas函数。<br>在这一步中，我们还将定义我们的x（独立/特征/解释/预测等）和y（依赖/目标/结果/响应/等）变量进行数据建模。</p>
<p>开发者文档：</p>
<p><a href="http://pbpython.com/categorical-encoding.html" target="_blank" rel="external">Categorical Encoding</a></p>
<p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html" target="_blank" rel="external">Sklearn LabelEncoder</a></p>
<p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html" target="_blank" rel="external">Sklearn OneHotEncoder</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/categorical.html" target="_blank" rel="external">Pandas Categorical dtype</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html" target="_blank" rel="external">pandas.get_dummies</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#CONVERT: convert objects to category using Label Encoder for train and test/validation dataset</span></div><div class="line"></div><div class="line"><span class="comment">#code categorical data</span></div><div class="line">label = LabelEncoder()</div><div class="line"><span class="keyword">for</span> dataset <span class="keyword">in</span> data_cleaner:    </div><div class="line">    dataset[<span class="string">'Sex_Code'</span>] = label.fit_transform(dataset[<span class="string">'Sex'</span>])</div><div class="line">    dataset[<span class="string">'Embarked_Code'</span>] = label.fit_transform(dataset[<span class="string">'Embarked'</span>])</div><div class="line">    dataset[<span class="string">'Title_Code'</span>] = label.fit_transform(dataset[<span class="string">'Title'</span>])</div><div class="line">    dataset[<span class="string">'AgeBin_Code'</span>] = label.fit_transform(dataset[<span class="string">'AgeBin'</span>])</div><div class="line">    dataset[<span class="string">'FareBin_Code'</span>] = label.fit_transform(dataset[<span class="string">'FareBin'</span>])</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#define y variable aka target/outcome</span></div><div class="line">Target = [<span class="string">'Survived'</span>]</div><div class="line"></div><div class="line"><span class="comment">#define x variables for original features aka feature selection</span></div><div class="line">data1_x = [<span class="string">'Sex'</span>,<span class="string">'Pclass'</span>, <span class="string">'Embarked'</span>, <span class="string">'Title'</span>,<span class="string">'SibSp'</span>, <span class="string">'Parch'</span>, <span class="string">'Age'</span>, <span class="string">'Fare'</span>, <span class="string">'FamilySize'</span>, <span class="string">'IsAlone'</span>] <span class="comment">#pretty name/values for charts</span></div><div class="line">data1_x_calc = [<span class="string">'Sex_Code'</span>,<span class="string">'Pclass'</span>, <span class="string">'Embarked_Code'</span>, <span class="string">'Title_Code'</span>,<span class="string">'SibSp'</span>, <span class="string">'Parch'</span>, <span class="string">'Age'</span>, <span class="string">'Fare'</span>] <span class="comment">#coded for algorithm calculation</span></div><div class="line">data1_xy =  Target + data1_x</div><div class="line">print(<span class="string">'Original X Y: '</span>, data1_xy, <span class="string">'\n'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#define x variables for original w/bin features to remove continuous variables</span></div><div class="line">data1_x_bin = [<span class="string">'Sex_Code'</span>,<span class="string">'Pclass'</span>, <span class="string">'Embarked_Code'</span>, <span class="string">'Title_Code'</span>, <span class="string">'FamilySize'</span>, <span class="string">'AgeBin_Code'</span>, <span class="string">'FareBin_Code'</span>]</div><div class="line">data1_xy_bin = Target + data1_x_bin</div><div class="line">print(<span class="string">'Bin X Y: '</span>, data1_xy_bin, <span class="string">'\n'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#define x and y variables for dummy features original</span></div><div class="line">data1_dummy = pd.get_dummies(data1[data1_x])</div><div class="line">data1_x_dummy = data1_dummy.columns.tolist()</div><div class="line">data1_xy_dummy = Target + data1_x_dummy</div><div class="line">print(<span class="string">'Dummy X Y: '</span>, data1_xy_dummy, <span class="string">'\n'</span>)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">data1_dummy.head()</div></pre></td></tr></table></figure>
<pre><code>Original X Y:  [&apos;Survived&apos;, &apos;Sex&apos;, &apos;Pclass&apos;, &apos;Embarked&apos;, &apos;Title&apos;, &apos;SibSp&apos;, &apos;Parch&apos;, &apos;Age&apos;, &apos;Fare&apos;, &apos;FamilySize&apos;, &apos;IsAlone&apos;] 

Bin X Y:  [&apos;Survived&apos;, &apos;Sex_Code&apos;, &apos;Pclass&apos;, &apos;Embarked_Code&apos;, &apos;Title_Code&apos;, &apos;FamilySize&apos;, &apos;AgeBin_Code&apos;, &apos;FareBin_Code&apos;] 

Dummy X Y:  [&apos;Survived&apos;, &apos;Pclass&apos;, &apos;SibSp&apos;, &apos;Parch&apos;, &apos;Age&apos;, &apos;Fare&apos;, &apos;FamilySize&apos;, &apos;IsAlone&apos;, &apos;Sex_female&apos;, &apos;Sex_male&apos;, &apos;Embarked_C&apos;, &apos;Embarked_Q&apos;, &apos;Embarked_S&apos;, &apos;Title_Master&apos;, &apos;Title_Misc&apos;, &apos;Title_Miss&apos;, &apos;Title_Mr&apos;, &apos;Title_Mrs&apos;] 
</code></pre><div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right"><br>      <th></th><br>      <th>Pclass</th><br>      <th>SibSp</th><br>      <th>Parch</th><br>      <th>Age</th><br>      <th>Fare</th><br>      <th>FamilySize</th><br>      <th>IsAlone</th><br>      <th>Sex_female</th><br>      <th>Sex_male</th><br>      <th>Embarked_C</th><br>      <th>Embarked_Q</th><br>      <th>Embarked_S</th><br>      <th>Title_Master</th><br>      <th>Title_Misc</th><br>      <th>Title_Miss</th><br>      <th>Title_Mr</th><br>      <th>Title_Mrs</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>3</td><br>      <td>1</td><br>      <td>0</td><br>      <td>22.0</td><br>      <td>7.2500</td><br>      <td>2</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>      <td>38.0</td><br>      <td>71.2833</td><br>      <td>2</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>3</td><br>      <td>0</td><br>      <td>0</td><br>      <td>26.0</td><br>      <td>7.9250</td><br>      <td>1</td><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>      <td>35.0</td><br>      <td>53.1000</td><br>      <td>2</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>3</td><br>      <td>0</td><br>      <td>0</td><br>      <td>35.0</td><br>      <td>8.0500</td><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>    </tr><br>  </tbody><br></table><br></div>



<h2 id="3-24-Da-Double-Check-Cleaned-Data"><a href="#3-24-Da-Double-Check-Cleaned-Data" class="headerlink" title="3.24 Da-Double Check Cleaned Data"></a>3.24 Da-Double Check Cleaned Data</h2><p>Now that we’ve cleaned our data, let’s do a discount da-double check!</p>
<h2 id="3-24-再检查一次清洗后的数据"><a href="#3-24-再检查一次清洗后的数据" class="headerlink" title="3.24 再检查一次清洗后的数据"></a>3.24 再检查一次清洗后的数据</h2><p>现在我们有了清洗过的数据了，让我们做个双重检查。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">print(<span class="string">'Train columns with null values: \n'</span>, data1.isnull().sum())</div><div class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</div><div class="line"><span class="keyword">print</span> (data1.info())</div><div class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</div><div class="line"></div><div class="line">print(<span class="string">'Test/Validation columns with null values: \n'</span>, data_val.isnull().sum())</div><div class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</div><div class="line"><span class="keyword">print</span> (data_val.info())</div><div class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</div><div class="line"></div><div class="line">data_raw.describe(include = <span class="string">'all'</span>)</div></pre></td></tr></table></figure>
<pre><code>Train columns with null values: 
 Survived         0
Pclass           0
Name             0
Sex              0
Age              0
SibSp            0
Parch            0
Fare             0
Embarked         0
FamilySize       0
IsAlone          0
Title            0
FareBin          0
AgeBin           0
Sex_Code         0
Embarked_Code    0
Title_Code       0
AgeBin_Code      0
FareBin_Code     0
dtype: int64
----------
&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 19 columns):
Survived         891 non-null int64
Pclass           891 non-null int64
Name             891 non-null object
Sex              891 non-null object
Age              891 non-null float64
SibSp            891 non-null int64
Parch            891 non-null int64
Fare             891 non-null float64
Embarked         891 non-null object
FamilySize       891 non-null int64
IsAlone          891 non-null int64
Title            891 non-null object
FareBin          891 non-null category
AgeBin           891 non-null category
Sex_Code         891 non-null int64
Embarked_Code    891 non-null int64
Title_Code       891 non-null int64
AgeBin_Code      891 non-null int64
FareBin_Code     891 non-null int64
dtypes: category(2), float64(2), int64(11), object(4)
memory usage: 120.3+ KB
None
----------
Test/Validation columns with null values: 
 PassengerId        0
Pclass             0
Name               0
Sex                0
Age                0
SibSp              0
Parch              0
Ticket             0
Fare               0
Cabin            327
Embarked           0
FamilySize         0
IsAlone            0
Title              0
FareBin            0
AgeBin             0
Sex_Code           0
Embarked_Code      0
Title_Code         0
AgeBin_Code        0
FareBin_Code       0
dtype: int64
----------
&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;
RangeIndex: 418 entries, 0 to 417
Data columns (total 21 columns):
PassengerId      418 non-null int64
Pclass           418 non-null int64
Name             418 non-null object
Sex              418 non-null object
Age              418 non-null float64
SibSp            418 non-null int64
Parch            418 non-null int64
Ticket           418 non-null object
Fare             418 non-null float64
Cabin            91 non-null object
Embarked         418 non-null object
FamilySize       418 non-null int64
IsAlone          418 non-null int64
Title            418 non-null object
FareBin          418 non-null category
AgeBin           418 non-null category
Sex_Code         418 non-null int64
Embarked_Code    418 non-null int64
Title_Code       418 non-null int64
AgeBin_Code      418 non-null int64
FareBin_Code     418 non-null int64
dtypes: category(2), float64(2), int64(11), object(6)
memory usage: 63.1+ KB
None
----------
</code></pre><div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right"><br>      <th></th><br>      <th>PassengerId</th><br>      <th>Survived</th><br>      <th>Pclass</th><br>      <th>Name</th><br>      <th>Sex</th><br>      <th>Age</th><br>      <th>SibSp</th><br>      <th>Parch</th><br>      <th>Ticket</th><br>      <th>Fare</th><br>      <th>Cabin</th><br>      <th>Embarked</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>count</th><br>      <td>891.000000</td><br>      <td>891.000000</td><br>      <td>891.000000</td><br>      <td>891</td><br>      <td>891</td><br>      <td>714.000000</td><br>      <td>891.000000</td><br>      <td>891.000000</td><br>      <td>891</td><br>      <td>891.000000</td><br>      <td>204</td><br>      <td>889</td><br>    </tr><br>    <tr><br>      <th>unique</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>891</td><br>      <td>2</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>681</td><br>      <td>NaN</td><br>      <td>147</td><br>      <td>3</td><br>    </tr><br>    <tr><br>      <th>top</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>Hoyt, Mr. William Fisher</td><br>      <td>male</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>347082</td><br>      <td>NaN</td><br>      <td>G6</td><br>      <td>S</td><br>    </tr><br>    <tr><br>      <th>freq</th><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>1</td><br>      <td>577</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>7</td><br>      <td>NaN</td><br>      <td>4</td><br>      <td>644</td><br>    </tr><br>    <tr><br>      <th>mean</th><br>      <td>446.000000</td><br>      <td>0.383838</td><br>      <td>2.308642</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>29.699118</td><br>      <td>0.523008</td><br>      <td>0.381594</td><br>      <td>NaN</td><br>      <td>32.204208</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>std</th><br>      <td>257.353842</td><br>      <td>0.486592</td><br>      <td>0.836071</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>14.526497</td><br>      <td>1.102743</td><br>      <td>0.806057</td><br>      <td>NaN</td><br>      <td>49.693429</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>min</th><br>      <td>1.000000</td><br>      <td>0.000000</td><br>      <td>1.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>0.420000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>NaN</td><br>      <td>0.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>25%</th><br>      <td>223.500000</td><br>      <td>0.000000</td><br>      <td>2.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>20.125000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>NaN</td><br>      <td>7.910400</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>50%</th><br>      <td>446.000000</td><br>      <td>0.000000</td><br>      <td>3.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>28.000000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>NaN</td><br>      <td>14.454200</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>75%</th><br>      <td>668.500000</td><br>      <td>1.000000</td><br>      <td>3.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>38.000000</td><br>      <td>1.000000</td><br>      <td>0.000000</td><br>      <td>NaN</td><br>      <td>31.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>    <tr><br>      <th>max</th><br>      <td>891.000000</td><br>      <td>1.000000</td><br>      <td>3.000000</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>80.000000</td><br>      <td>8.000000</td><br>      <td>6.000000</td><br>      <td>NaN</td><br>      <td>512.329200</td><br>      <td>NaN</td><br>      <td>NaN</td><br>    </tr><br>  </tbody><br></table><br></div>



<h2 id="3-25-Split-Training-and-Testing-Data"><a href="#3-25-Split-Training-and-Testing-Data" class="headerlink" title="3.25 Split Training and Testing Data"></a>3.25 Split Training and Testing Data</h2><p>As mentioned previously, the test file provided is really validation data for competition submission. So, we will use sklearn function to split the training data in two datasets; 75/25 split. This is important, so we don’t overfit our model. Meaning, the algorithm is so specific to a given subset, it cannot accurately generalize another subset, from the same dataset. It’s important our algorithm has not seen the subset we will use to test, so it doesn’t “cheat” by memorizing the answers. We will use sklearn’s train_test_split function. In later sections we will also use sklearn’s cross validation functions, that splits our dataset into train and test for data modeling comparison.</p>
<h2 id="3-25分割训练和测试数据"><a href="#3-25分割训练和测试数据" class="headerlink" title="3.25分割训练和测试数据"></a>3.25分割训练和测试数据</h2><p>如前所述，提供的测试文件实际上是竞争提交的验证数据。因此，我们将使用sklearn函数将训练数据分成两个数据集; 75/25分割。这很重要，所以我们不要过度使用我们的模型。这意味着，该算法对于给定的子集是特定的，不能从相同的数据集准确地概括另一个子集。重要的是我们的算法没有看到我们将用来测试的子集，所以它不会通过记住答案来“作弊”。我们将使用sklearn的train_test_split函数。在后面的章节中，我们还将使用sklearn的交叉验证函数，将我们的数据集分解为训练和测试以进行数据建模比较。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#split train and test data with function defaults</span></div><div class="line"><span class="comment">#random_state -&gt; seed or control random number generator: https://www.quora.com/What-is-seed-in-random-number-generation</span></div><div class="line">train1_x, test1_x, train1_y, test1_y = model_selection.train_test_split(data1[data1_x_calc], data1[Target], random_state = <span class="number">0</span>)</div><div class="line">train1_x_bin, test1_x_bin, train1_y_bin, test1_y_bin = model_selection.train_test_split(data1[data1_x_bin], data1[Target] , random_state = <span class="number">0</span>)</div><div class="line">train1_x_dummy, test1_x_dummy, train1_y_dummy, test1_y_dummy = model_selection.train_test_split(data1_dummy[data1_x_dummy], data1[Target], random_state = <span class="number">0</span>)</div><div class="line"></div><div class="line"></div><div class="line">print(<span class="string">"Data1 Shape: &#123;&#125;"</span>.format(data1.shape))</div><div class="line">print(<span class="string">"Train1 Shape: &#123;&#125;"</span>.format(train1_x.shape))</div><div class="line">print(<span class="string">"Test1 Shape: &#123;&#125;"</span>.format(test1_x.shape))</div><div class="line"></div><div class="line">train1_x_bin.head()</div></pre></td></tr></table></figure>
<pre><code>Data1 Shape: (891, 19)
Train1 Shape: (668, 8)
Test1 Shape: (223, 8)
</code></pre><div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right"><br>      <th></th><br>      <th>Sex_Code</th><br>      <th>Pclass</th><br>      <th>Embarked_Code</th><br>      <th>Title_Code</th><br>      <th>FamilySize</th><br>      <th>AgeBin_Code</th><br>      <th>FareBin_Code</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>105</th><br>      <td>1</td><br>      <td>3</td><br>      <td>2</td><br>      <td>3</td><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>68</th><br>      <td>0</td><br>      <td>3</td><br>      <td>2</td><br>      <td>2</td><br>      <td>7</td><br>      <td>1</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>253</th><br>      <td>1</td><br>      <td>3</td><br>      <td>2</td><br>      <td>3</td><br>      <td>2</td><br>      <td>1</td><br>      <td>2</td><br>    </tr><br>    <tr><br>      <th>320</th><br>      <td>1</td><br>      <td>3</td><br>      <td>2</td><br>      <td>3</td><br>      <td>1</td><br>      <td>1</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>706</th><br>      <td>0</td><br>      <td>2</td><br>      <td>2</td><br>      <td>4</td><br>      <td>1</td><br>      <td>2</td><br>      <td>1</td><br>    </tr><br>  </tbody><br></table><br></div>



<h2 id="Step-4-Perform-Exploratory-Analysis-with-Statistics"><a href="#Step-4-Perform-Exploratory-Analysis-with-Statistics" class="headerlink" title="Step 4: Perform Exploratory Analysis with Statistics"></a>Step 4: Perform Exploratory Analysis with Statistics</h2><p>Now that our data is cleaned, we will explore our data with descriptive and graphical statistics to describe and summarize our variables. In this stage, you will find yourself classifying features and determining their correlation with the target variable and each other.</p>
<h2 id="第4步：用统计数据进行探索性分析"><a href="#第4步：用统计数据进行探索性分析" class="headerlink" title="第4步：用统计数据进行探索性分析"></a>第4步：用统计数据进行探索性分析</h2><p>现在我们的数据已经清理完毕，我们将用描述性和图形化的统计数据来探索我们的数据来描述和总结我们的变量。在这个阶段，你会发现自己要分类特征，并确定它们与目标变量之间的相互关系。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Discrete Variable Correlation by Survival using</span></div><div class="line"><span class="comment">#group by aka pivot table: https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html</span></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> data1_x:</div><div class="line">    <span class="keyword">if</span> data1[x].dtype != <span class="string">'float64'</span> :</div><div class="line">        print(<span class="string">'Survival Correlation by:'</span>, x)</div><div class="line">        print(data1[[x, Target[<span class="number">0</span>]]].groupby(x, as_index=<span class="keyword">False</span>).mean())</div><div class="line">        print(<span class="string">'-'</span>*<span class="number">10</span>, <span class="string">'\n'</span>)</div><div class="line">        </div><div class="line"></div><div class="line"><span class="comment">#using crosstabs: https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html</span></div><div class="line">print(pd.crosstab(data1[<span class="string">'Title'</span>],data1[Target[<span class="number">0</span>]]))</div></pre></td></tr></table></figure>
<pre><code>Survival Correlation by: Sex
      Sex  Survived
0  female  0.742038
1    male  0.188908
---------- 

Survival Correlation by: Pclass
   Pclass  Survived
0       1  0.629630
1       2  0.472826
2       3  0.242363
---------- 

Survival Correlation by: Embarked
  Embarked  Survived
0        C  0.553571
1        Q  0.389610
2        S  0.339009
---------- 

Survival Correlation by: Title
    Title  Survived
0  Master  0.575000
1    Misc  0.444444
2    Miss  0.697802
3      Mr  0.156673
4     Mrs  0.792000
---------- 

Survival Correlation by: SibSp
   SibSp  Survived
0      0  0.345395
1      1  0.535885
2      2  0.464286
3      3  0.250000
4      4  0.166667
5      5  0.000000
6      8  0.000000
---------- 

Survival Correlation by: Parch
   Parch  Survived
0      0  0.343658
1      1  0.550847
2      2  0.500000
3      3  0.600000
4      4  0.000000
5      5  0.200000
6      6  0.000000
---------- 

Survival Correlation by: FamilySize
   FamilySize  Survived
0           1  0.303538
1           2  0.552795
2           3  0.578431
3           4  0.724138
4           5  0.200000
5           6  0.136364
6           7  0.333333
7           8  0.000000
8          11  0.000000
---------- 

Survival Correlation by: IsAlone
   IsAlone  Survived
0        0  0.505650
1        1  0.303538
---------- 

Survived    0    1
Title             
Master     17   23
Misc       15   12
Miss       55  127
Mr        436   81
Mrs        26   99
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#IMPORTANT: Intentionally plotted different ways for learning purposes only. </span></div><div class="line"></div><div class="line"><span class="comment">#optional plotting w/pandas: https://pandas.pydata.org/pandas-docs/stable/visualization.html</span></div><div class="line"></div><div class="line"><span class="comment">#we will use matplotlib.pyplot: https://matplotlib.org/api/pyplot_api.html</span></div><div class="line"></div><div class="line"><span class="comment">#to organize our graphics will use figure: https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure</span></div><div class="line"><span class="comment">#subplot: https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot</span></div><div class="line"><span class="comment">#and subplotS: https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html?highlight=matplotlib%20pyplot%20subplots#matplotlib.pyplot.subplots</span></div><div class="line"></div><div class="line"><span class="comment">#graph distribution of quantitative data</span></div><div class="line">plt.figure(figsize=[<span class="number">16</span>,<span class="number">12</span>])</div><div class="line"></div><div class="line">plt.subplot(<span class="number">231</span>)</div><div class="line">plt.boxplot(x=data1[<span class="string">'Fare'</span>], showmeans = <span class="keyword">True</span>, meanline = <span class="keyword">True</span>)</div><div class="line">plt.title(<span class="string">'Fare Boxplot'</span>)</div><div class="line">plt.ylabel(<span class="string">'Fare ($)'</span>)</div><div class="line"></div><div class="line">plt.subplot(<span class="number">232</span>)</div><div class="line">plt.boxplot(data1[<span class="string">'Age'</span>], showmeans = <span class="keyword">True</span>, meanline = <span class="keyword">True</span>)</div><div class="line">plt.title(<span class="string">'Age Boxplot'</span>)</div><div class="line">plt.ylabel(<span class="string">'Age (Years)'</span>)</div><div class="line"></div><div class="line">plt.subplot(<span class="number">233</span>)</div><div class="line">plt.boxplot(data1[<span class="string">'FamilySize'</span>], showmeans = <span class="keyword">True</span>, meanline = <span class="keyword">True</span>)</div><div class="line">plt.title(<span class="string">'Family Size Boxplot'</span>)</div><div class="line">plt.ylabel(<span class="string">'Family Size (#)'</span>)</div><div class="line"></div><div class="line">plt.subplot(<span class="number">234</span>)</div><div class="line">plt.hist(x = [data1[data1[<span class="string">'Survived'</span>]==<span class="number">1</span>][<span class="string">'Fare'</span>], data1[data1[<span class="string">'Survived'</span>]==<span class="number">0</span>][<span class="string">'Fare'</span>]], </div><div class="line">         stacked=<span class="keyword">True</span>, color = [<span class="string">'g'</span>,<span class="string">'r'</span>],label = [<span class="string">'Survived'</span>,<span class="string">'Dead'</span>])</div><div class="line">plt.title(<span class="string">'Fare Histogram by Survival'</span>)</div><div class="line">plt.xlabel(<span class="string">'Fare ($)'</span>)</div><div class="line">plt.ylabel(<span class="string">'# of Passengers'</span>)</div><div class="line">plt.legend()</div><div class="line"></div><div class="line">plt.subplot(<span class="number">235</span>)</div><div class="line">plt.hist(x = [data1[data1[<span class="string">'Survived'</span>]==<span class="number">1</span>][<span class="string">'Age'</span>], data1[data1[<span class="string">'Survived'</span>]==<span class="number">0</span>][<span class="string">'Age'</span>]], </div><div class="line">         stacked=<span class="keyword">True</span>, color = [<span class="string">'g'</span>,<span class="string">'r'</span>],label = [<span class="string">'Survived'</span>,<span class="string">'Dead'</span>])</div><div class="line">plt.title(<span class="string">'Age Histogram by Survival'</span>)</div><div class="line">plt.xlabel(<span class="string">'Age (Years)'</span>)</div><div class="line">plt.ylabel(<span class="string">'# of Passengers'</span>)</div><div class="line">plt.legend()</div><div class="line"></div><div class="line">plt.subplot(<span class="number">236</span>)</div><div class="line">plt.hist(x = [data1[data1[<span class="string">'Survived'</span>]==<span class="number">1</span>][<span class="string">'FamilySize'</span>], data1[data1[<span class="string">'Survived'</span>]==<span class="number">0</span>][<span class="string">'FamilySize'</span>]], </div><div class="line">         stacked=<span class="keyword">True</span>, color = [<span class="string">'g'</span>,<span class="string">'r'</span>],label = [<span class="string">'Survived'</span>,<span class="string">'Dead'</span>])</div><div class="line">plt.title(<span class="string">'Family Size Histogram by Survival'</span>)</div><div class="line">plt.xlabel(<span class="string">'Family Size (#)'</span>)</div><div class="line">plt.ylabel(<span class="string">'# of Passengers'</span>)</div><div class="line">plt.legend()</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.legend.Legend at 0x17ac97d1e10&gt;
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/52080686.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#we will use seaborn graphics for multi-variable comparison: https://seaborn.pydata.org/api.html</span></div><div class="line"></div><div class="line"><span class="comment">#graph individual features by survival</span></div><div class="line">fig, saxis = plt.subplots(<span class="number">2</span>, <span class="number">3</span>,figsize=(<span class="number">16</span>,<span class="number">12</span>))</div><div class="line"></div><div class="line">sns.barplot(x = <span class="string">'Embarked'</span>, y = <span class="string">'Survived'</span>, data=data1, ax = saxis[<span class="number">0</span>,<span class="number">0</span>])</div><div class="line">sns.barplot(x = <span class="string">'Pclass'</span>, y = <span class="string">'Survived'</span>, order=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], data=data1, ax = saxis[<span class="number">0</span>,<span class="number">1</span>])</div><div class="line">sns.barplot(x = <span class="string">'IsAlone'</span>, y = <span class="string">'Survived'</span>, order=[<span class="number">1</span>,<span class="number">0</span>], data=data1, ax = saxis[<span class="number">0</span>,<span class="number">2</span>])</div><div class="line"></div><div class="line">sns.pointplot(x = <span class="string">'FareBin'</span>, y = <span class="string">'Survived'</span>,  data=data1, ax = saxis[<span class="number">1</span>,<span class="number">0</span>])</div><div class="line">sns.pointplot(x = <span class="string">'AgeBin'</span>, y = <span class="string">'Survived'</span>,  data=data1, ax = saxis[<span class="number">1</span>,<span class="number">1</span>])</div><div class="line">sns.pointplot(x = <span class="string">'FamilySize'</span>, y = <span class="string">'Survived'</span>, data=data1, ax = saxis[<span class="number">1</span>,<span class="number">2</span>])</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x17ac9a5ea20&gt;
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/70149589.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#graph distribution of qualitative data: Pclass</span></div><div class="line"><span class="comment">#we know class mattered in survival, now let's compare class and a 2nd feature</span></div><div class="line">fig, (axis1,axis2,axis3) = plt.subplots(<span class="number">1</span>,<span class="number">3</span>,figsize=(<span class="number">14</span>,<span class="number">12</span>))</div><div class="line"></div><div class="line">sns.boxplot(x = <span class="string">'Pclass'</span>, y = <span class="string">'Fare'</span>, hue = <span class="string">'Survived'</span>, data = data1, ax = axis1)</div><div class="line">axis1.set_title(<span class="string">'Pclass vs Fare Survival Comparison'</span>)</div><div class="line"></div><div class="line">sns.violinplot(x = <span class="string">'Pclass'</span>, y = <span class="string">'Age'</span>, hue = <span class="string">'Survived'</span>, data = data1, split = <span class="keyword">True</span>, ax = axis2)</div><div class="line">axis2.set_title(<span class="string">'Pclass vs Age Survival Comparison'</span>)</div><div class="line"></div><div class="line">sns.boxplot(x = <span class="string">'Pclass'</span>, y =<span class="string">'FamilySize'</span>, hue = <span class="string">'Survived'</span>, data = data1, ax = axis3)</div><div class="line">axis3.set_title(<span class="string">'Pclass vs Family Size Survival Comparison'</span>)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.text.Text at 0x17aca08ab70&gt;
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/86354672.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#graph distribution of qualitative data: Sex</span></div><div class="line"><span class="comment">#we know sex mattered in survival, now let's compare sex and a 2nd feature</span></div><div class="line">fig, qaxis = plt.subplots(<span class="number">1</span>,<span class="number">3</span>,figsize=(<span class="number">14</span>,<span class="number">12</span>))</div><div class="line"></div><div class="line">sns.barplot(x = <span class="string">'Sex'</span>, y = <span class="string">'Survived'</span>, hue = <span class="string">'Embarked'</span>, data=data1, ax = qaxis[<span class="number">0</span>])</div><div class="line">axis1.set_title(<span class="string">'Sex vs Embarked Survival Comparison'</span>)</div><div class="line"></div><div class="line">sns.barplot(x = <span class="string">'Sex'</span>, y = <span class="string">'Survived'</span>, hue = <span class="string">'Pclass'</span>, data=data1, ax  = qaxis[<span class="number">1</span>])</div><div class="line">axis1.set_title(<span class="string">'Sex vs Pclass Survival Comparison'</span>)</div><div class="line"></div><div class="line">sns.barplot(x = <span class="string">'Sex'</span>, y = <span class="string">'Survived'</span>, hue = <span class="string">'IsAlone'</span>, data=data1, ax  = qaxis[<span class="number">2</span>])</div><div class="line">axis1.set_title(<span class="string">'Sex vs IsAlone Survival Comparison'</span>)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.text.Text at 0x17ac9c242b0&gt;
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/1927926.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#more side-by-side comparisons</span></div><div class="line">fig, (maxis1, maxis2) = plt.subplots(<span class="number">1</span>, <span class="number">2</span>,figsize=(<span class="number">14</span>,<span class="number">12</span>))</div><div class="line"></div><div class="line"><span class="comment">#how does family size factor with sex &amp; survival compare</span></div><div class="line">sns.pointplot(x=<span class="string">"FamilySize"</span>, y=<span class="string">"Survived"</span>, hue=<span class="string">"Sex"</span>, data=data1,</div><div class="line">              palette=&#123;<span class="string">"male"</span>: <span class="string">"blue"</span>, <span class="string">"female"</span>: <span class="string">"pink"</span>&#125;,</div><div class="line">              markers=[<span class="string">"*"</span>, <span class="string">"o"</span>], linestyles=[<span class="string">"-"</span>, <span class="string">"--"</span>], ax = maxis1)</div><div class="line"></div><div class="line"><span class="comment">#how does class factor with sex &amp; survival compare</span></div><div class="line">sns.pointplot(x=<span class="string">"Pclass"</span>, y=<span class="string">"Survived"</span>, hue=<span class="string">"Sex"</span>, data=data1,</div><div class="line">              palette=&#123;<span class="string">"male"</span>: <span class="string">"blue"</span>, <span class="string">"female"</span>: <span class="string">"pink"</span>&#125;,</div><div class="line">              markers=[<span class="string">"*"</span>, <span class="string">"o"</span>], linestyles=[<span class="string">"-"</span>, <span class="string">"--"</span>], ax = maxis2)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x17acacbbdd8&gt;
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/22651868.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#how does embark port factor with class, sex, and survival compare</span></div><div class="line"><span class="comment">#facetgrid: https://seaborn.pydata.org/generated/seaborn.FacetGrid.html</span></div><div class="line">e = sns.FacetGrid(data1, col = <span class="string">'Embarked'</span>)</div><div class="line">e.map(sns.pointplot, <span class="string">'Pclass'</span>, <span class="string">'Survived'</span>, <span class="string">'Sex'</span>, ci=<span class="number">95.0</span>, palette = <span class="string">'deep'</span>)</div><div class="line">e.add_legend()</div></pre></td></tr></table></figure>
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x17ac91fe710&gt;
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/61965289.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#plot distributions of age of passengers who survived or did not survive</span></div><div class="line">a = sns.FacetGrid( data1, hue = <span class="string">'Survived'</span>, aspect=<span class="number">4</span> )</div><div class="line">a.map(sns.kdeplot, <span class="string">'Age'</span>, shade= <span class="keyword">True</span> )</div><div class="line">a.set(xlim=(<span class="number">0</span> , data1[<span class="string">'Age'</span>].max()))</div><div class="line">a.add_legend()</div></pre></td></tr></table></figure>
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x17acaf6ed68&gt;
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/43891131.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#histogram comparison of sex, class, and age by survival</span></div><div class="line">h = sns.FacetGrid(data1, row = <span class="string">'Sex'</span>, col = <span class="string">'Pclass'</span>, hue = <span class="string">'Survived'</span>)</div><div class="line">h.map(plt.hist, <span class="string">'Age'</span>, alpha = <span class="number">.75</span>)</div><div class="line">h.add_legend()</div></pre></td></tr></table></figure>
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x17acb07deb8&gt;
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/37098878.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#pair plots of entire dataset</span></div><div class="line">pp = sns.pairplot(data1, hue = <span class="string">'Survived'</span>, palette = <span class="string">'deep'</span>, size=<span class="number">1.2</span>, diag_kind = <span class="string">'kde'</span>, diag_kws=dict(shade=<span class="keyword">True</span>), plot_kws=dict(s=<span class="number">10</span>) )</div><div class="line">pp.set(xticklabels=[])</div></pre></td></tr></table></figure>
<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x17acc56fd30&gt;
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/84841807.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#correlation heatmap of dataset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">correlation_heatmap</span><span class="params">(df)</span>:</span></div><div class="line">    _ , ax = plt.subplots(figsize =(<span class="number">14</span>, <span class="number">12</span>))</div><div class="line">    colormap = sns.diverging_palette(<span class="number">220</span>, <span class="number">10</span>, as_cmap = <span class="keyword">True</span>)</div><div class="line">    </div><div class="line">    _ = sns.heatmap(</div><div class="line">        df.corr(), </div><div class="line">        cmap = colormap,</div><div class="line">        square=<span class="keyword">True</span>, </div><div class="line">        cbar_kws=&#123;<span class="string">'shrink'</span>:<span class="number">.9</span> &#125;, </div><div class="line">        ax=ax,</div><div class="line">        annot=<span class="keyword">True</span>, </div><div class="line">        linewidths=<span class="number">0.1</span>,vmax=<span class="number">1.0</span>, linecolor=<span class="string">'white'</span>,</div><div class="line">        annot_kws=&#123;<span class="string">'fontsize'</span>:<span class="number">12</span> &#125;</div><div class="line">    )</div><div class="line">    </div><div class="line">    plt.title(<span class="string">'Pearson Correlation of Features'</span>, y=<span class="number">1.05</span>, size=<span class="number">15</span>)</div><div class="line"></div><div class="line">correlation_heatmap(data1)</div></pre></td></tr></table></figure>
<p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/83057665.jpg" alt=""></p>
<h2 id="Step-5-Model-Data"><a href="#Step-5-Model-Data" class="headerlink" title="Step 5: Model Data"></a>Step 5: Model Data</h2><h2 id="第五步：模型数据"><a href="#第五步：模型数据" class="headerlink" title="第五步：模型数据"></a>第五步：模型数据</h2><p>Data Science is a multi-disciplinary field between mathematics (i.e. statistics, linear algebra, etc.), computer science (i.e. programming languages, computer systems, etc.) and business management (i.e. communication, subject-matter knowledge, etc.). Most data scientist come from one of the three fields, so they tend to lean towards that discipline. However, data science is like a three-legged stool, with no one leg being more important than the other. So, this step will require advanced knowledge in mathematics. But don’t worry, we only need a high-level overview, which we’ll cover in this Kernel. Also, thanks to computer science, a lot of the heavy lifting is done for you. So, problems that once required graduate degrees in mathematics or statistics, now only take a few lines of code. Last, we’ll need some business acumen to think through the problem. After all, like training a sight-seeing dog, it’s learning from us and not the other way around.</p>
<p>Machine Learning (ML), as the name suggest, is teaching the machine how-to think and not what to think. While this topic and big data has been around for decades, it is becoming more popular than ever because the barrier to entry is lower, for businesses and professionals alike. This is both good and bad. It’s good because these algorithms are now accessible to more people that can solve more problems in the real-world. It’s bad because a lower barrier to entry means, more people will not know the tools they are using and can come to incorrect conclusions. That’s why I focus on teaching you, not just what to do, but why you’re doing it. Previously, I used the analogy of asking someone to hand you a Philip screwdriver, and they hand you a flathead screwdriver or worst a hammer. At best, it shows a complete lack of understanding. At worst, it makes completing the project impossible; or even worst, implements incorrect actionable intelligence. So now that I’ve hammered (no pun intended) my point, I’ll show you what to do and most importantly, WHY you do it.</p>
<p>First, you must understand, that the purpose of machine learning is to solve human problems. Machine learning can be categorized as: supervised learning, unsupervised learning, and reinforced learning. Supervised learning is where you train the model by presenting it a training dataset that includes the correct answer. Unsupervised learning is where you train the model using a training dataset that does not include the correct answer. And reinforced learning is a hybrid of the previous two, where the model is not given the correct answer immediately, but later after a sequence of events to reinforce learning. We are doing supervised machine learning, because we are training our algorithm by presenting it with a set of features and their corresponding target. We then hope to present it a new subset from the same dataset and have similar results in prediction accuracy.</p>
<p>There are many machine learning algorithms, however they can be reduced to four categories: classification, regression, clustering, or dimensionality reduction, depending on your target variable and data modeling goals. We’ll save clustering and dimension reduction for another day, and focus on classification and regression. We can generalize that a continuous target variable requires a regression algorithm and a discrete target variable requires a classification algorithm. One side note, logistic regression, while it has regression in the name, is really a classification algorithm. Since our problem is predicting if a passenger survived or did not survive, this is a discrete target variable. We will use a classification algorithm from the sklearn library to begin our analysis. We will use cross validation and scoring metrics, discussed in later sections, to rank and compare our algorithms’ performance.</p>
<h2 id="第五步：模型数据-1"><a href="#第五步：模型数据-1" class="headerlink" title="第五步：模型数据"></a>第五步：模型数据</h2><p>数据科学是数学（即统计学，线性代数等），计算机科学（即编程语言，计算机系统等）和商业管理（即通信，主题知识等）之间的多学科领域。大多数数据科学家来自三个领域之一，所以他们往往倾向于这个学科。然而，数据科学就像三脚凳，没有一条腿比另一条更重要。所以，这一步需要先进的数学知识。但是不要担心，我们只需要一个高级的概述，我们将在这个内核中介绍。此外，由于计算机科学，很多繁重的工作都是为你完成的。所以，曾经需要数学或统计学硕士学位的问题，现在只需要几行代码。持续，我们需要一些商业头脑来思考问题。毕竟，像培训一只观光狗一样，它正在向我们学习，而不是相反。<br>机器学习（ML），顾名思义，是教机器如何思考，而不是思考什么。虽然这个话题和大数据已经存在了数十年，但是它变得比以往更受欢迎，因为对于企业和专业人士而言，进入门槛较低。这是好的和坏的。这很好，因为这些算法现在可以被更多的人使用，可以在现实世界中解决更多的问题。这是不好的，因为进入壁垒较低意味着更多的人不知道他们正在使用的工具，并可能得出不正确的结论。这就是为什么我专注于教导你，而不仅仅是做什么，但为什么你这样做。以前，我用一个叫菲利普螺丝刀的类比，他们给你一把一字螺丝刀，或者一把锤子给你。充其量，它显示完全缺乏了解。最糟糕的是，它使完成这个项目变得不可能; 甚至最差，实施不正确的可操作的情报。所以，现在我已经敲定了（没有双关语意思的）我的观点，我会告诉你该怎么做，最重要的是，你为什么这么做。<br>首先，你必须明白，机器学习的目的是解决人类的问题。机器学习可以分类为：监督学习，无监督学习和强化学习。监督式学习是通过向其提供包含正确答案的训练数据集来训练模型的地方。无监督学习是使用不包含正确答案的训练数据集训练模型的地方。而强化学习是前两者的混合体，模型没有立即给出正确的答案，而是在一系列事件之后加强学习。我们正在做有监督的机器学习，因为我们正在训练我们的算法，给出一套功能和相应的目标。<br>有许多机器学习算法，但是它们可以归结为四类：分类，回归，聚类或降维，这取决于您的目标变量和数据建模目标。我们将保存另一天的聚类和降维，并着重于分类和回归。我们可以概括一个连续的目标变量需要一个回归算法和一个离散的目标变量需要一个分类算法。一方面，logistic回归虽然在名称上有回归，但实际上却是一种分类算法。由于我们的问题是预测乘客是幸存还是不存活，这是一个离散的目标变量。我们将使用sklearn库中的分类算法来开始我们的分析。我们将使用交叉验证和评分指标。</p>
<h3 id="Machine-Learning-Selection"><a href="#Machine-Learning-Selection" class="headerlink" title="Machine Learning Selection:"></a>Machine Learning Selection:</h3><ul>
<li><a href="http://scikit-learn.org/stable/user_guide.html" target="_blank" rel="external">Sklearn Estimator Overview</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html" target="_blank" rel="external">Sklearn Estimator Detail</a></li>
<li><a href="http://scikit-learn.org/stable/tutorial/machine_learning_map/index.html" target="_blank" rel="external">Choosing Estimator Mind Map</a></li>
<li>[Choosing Estimator Cheat Sheet</li>
</ul>
<p>Now that we identified our solution as a supervised learning classification algorithm. We can narrow our list of choices.</p>
<h3 id="机器学习选择："><a href="#机器学习选择：" class="headerlink" title="机器学习选择："></a>机器学习选择：</h3><ul>
<li><a href="http://scikit-learn.org/stable/user_guide.html" target="_blank" rel="external">Sklearn估算器概述</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html" target="_blank" rel="external">Sklearn估算器细节</a></li>
<li><a href="http://scikit-learn.org/stable/tutorial/machine_learning_map/index.html" target="_blank" rel="external">选择估算器思维导图</a></li>
<li><a href="https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Scikit_Learn_Cheat_Sheet_Python.pdf" target="_blank" rel="external">选择估算器备忘单</a><br>现在我们将我们的解决方案确定为监督学习分类算法。我们可以缩小我们的选择列表。</li>
</ul>
<h3 id="Machine-Learning-Classification-Algorithms"><a href="#Machine-Learning-Classification-Algorithms" class="headerlink" title="Machine Learning Classification Algorithms:"></a>Machine Learning Classification Algorithms:</h3><ul>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.ensemble" target="_blank" rel="external">Ensemble Methods</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.linear_model" target="_blank" rel="external">Generalized Linear Models (GLM)</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.naive_bayes" target="_blank" rel="external">Naive Bayes</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.neighbors" target="_blank" rel="external">Nearest Neighbors</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.svm" target="_blank" rel="external">Support Vector Machines (SVM)</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.tree" target="_blank" rel="external">Decision Trees</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.discriminant_analysis" target="_blank" rel="external">Discriminant Analysis</a></li>
</ul>
<h3 id="机器学习分类算法："><a href="#机器学习分类算法：" class="headerlink" title="机器学习分类算法："></a>机器学习分类算法：</h3><ul>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.ensemble" target="_blank" rel="external">融合方法</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.linear_model" target="_blank" rel="external">广义线性模型（GLM）</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.naive_bayes" target="_blank" rel="external">朴素贝叶斯</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.neighbors" target="_blank" rel="external">最近邻</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.svm" target="_blank" rel="external">支持向量机（SVM）</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.tree" target="_blank" rel="external">决策树</a></li>
<li><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.discriminant_analysis" target="_blank" rel="external">判别分析</a></li>
</ul>
<h3 id="Data-Science-101-How-to-Choose-a-Machine-Learning-Algorithm-MLA"><a href="#Data-Science-101-How-to-Choose-a-Machine-Learning-Algorithm-MLA" class="headerlink" title="Data Science 101: How to Choose a Machine Learning Algorithm (MLA)"></a>Data Science 101: How to Choose a Machine Learning Algorithm (MLA)</h3><p>IMPORTANT: When it comes to data modeling, the beginner’s question is always, “what is the best machine learning algorithm?” To this the beginner must learn, the No Free Lunch Theorem (NFLT) of Machine Learning. In short, NFLT states, there is no super algorithm, that works best in all situations, for all datasets. So the best approach is to try multiple MLAs, tune them, and compare them for your specific scenario. With that being said, some good research has been done to compare algorithms, such as Caruana &amp; Niculescu-Mizil 2006 watch video lecture here of MLA comparisons, Ogutu et al. 2011 done by the NIH for genomic selection, Fernandez-Delgado et al. 2014 comparing 179 classifiers from 17 families, Thoma 2016 sklearn comparison, and there is also a school of thought that says, more data beats a better algorithm.</p>
<p>So with all this information, where is a beginner to start? I recommend starting with Trees, Bagging, Random Forests, and Boosting. They are basically different implementations of a decision tree, which is the easiest concept to learn and understand. They are also easier to tune, discussed in the next section, than something like SVC. Below, I’ll give an overview of how-to run and compare several MLAs, but the rest of this Kernel will focus on learning data modeling via decision trees and its derivatives.</p>
<h3 id="数据科学101：如何选择机器学习算法（MLA）"><a href="#数据科学101：如何选择机器学习算法（MLA）" class="headerlink" title="数据科学101：如何选择机器学习算法（MLA）"></a>数据科学101：如何选择机器学习算法（MLA）</h3><p>重要提示：在数据建模方面，初学者的问题总是“什么是最好的机器学习算法？对此，初学者必须学习机器学习的免费午餐定理（NFLT）。简而言之，NFLT指出，对于所有数据集，没有超级算法，在所有情况下效果最好。所以最好的方法是尝试多个MLA，调整它们，并针对您的具体情况进行比较。据说，已经做了一些很好的研究来比较算法，比如Caruana和Niculescu-Mizil 2006观看视频讲座，MLA比较，Ogutu等人。2011年由NIH进行基因组选择，Fernandez-Delgado等人 2014年比较来自17个家庭的179个分类器，Thoma 2016年的sklearn比较，而且还有一个学派认为，更多的数据击败更好的算法。<br>所有这些信息，初学者在哪里开始呢？我建议从树木，套袋，随机森林和提升开始。他们基本上是决策树的不同实现，这是最容易学习和理解的概念。它们也比SVC更容易调整，在下一节讨论。下面，我将概述如何运行和比较几个MLA，但是这个内核的其余部分将集中在通过决策树及其衍生物学习数据建模。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Machine Learning Algorithm (MLA) Selection and Initialization</span></div><div class="line">MLA = [</div><div class="line">    <span class="comment">#Ensemble Methods</span></div><div class="line">    ensemble.AdaBoostClassifier(),</div><div class="line">    ensemble.BaggingClassifier(),</div><div class="line">    ensemble.ExtraTreesClassifier(),</div><div class="line">    ensemble.GradientBoostingClassifier(),</div><div class="line">    ensemble.RandomForestClassifier(),</div><div class="line"></div><div class="line">    <span class="comment">#Gaussian Processes</span></div><div class="line">    gaussian_process.GaussianProcessClassifier(),</div><div class="line">    </div><div class="line">    <span class="comment">#GLM</span></div><div class="line">    linear_model.LogisticRegressionCV(),</div><div class="line">    linear_model.PassiveAggressiveClassifier(),</div><div class="line">    linear_model.RidgeClassifierCV(),</div><div class="line">    linear_model.SGDClassifier(),</div><div class="line">    linear_model.Perceptron(),</div><div class="line">    </div><div class="line">    <span class="comment">#Navies Bayes</span></div><div class="line">    naive_bayes.BernoulliNB(),</div><div class="line">    naive_bayes.GaussianNB(),</div><div class="line">    </div><div class="line">    <span class="comment">#Nearest Neighbor</span></div><div class="line">    neighbors.KNeighborsClassifier(),</div><div class="line">    </div><div class="line">    <span class="comment">#SVM</span></div><div class="line">    svm.SVC(probability=<span class="keyword">True</span>),</div><div class="line">    svm.NuSVC(probability=<span class="keyword">True</span>),</div><div class="line">    svm.LinearSVC(),</div><div class="line">    </div><div class="line">    <span class="comment">#Trees    </span></div><div class="line">    tree.DecisionTreeClassifier(),</div><div class="line">    tree.ExtraTreeClassifier(),</div><div class="line">    </div><div class="line">    <span class="comment">#Discriminant Analysis</span></div><div class="line">    discriminant_analysis.LinearDiscriminantAnalysis(),</div><div class="line">    discriminant_analysis.QuadraticDiscriminantAnalysis(),</div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment">#xgboost: http://xgboost.readthedocs.io/en/latest/model.html</span></div><div class="line">    XGBClassifier()    </div><div class="line">    ]</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#split dataset in cross-validation with this splitter class: http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.ShuffleSplit.html#sklearn.model_selection.ShuffleSplit</span></div><div class="line"><span class="comment">#note: this is an alternative to train_test_split</span></div><div class="line">cv_split = model_selection.ShuffleSplit(n_splits = <span class="number">10</span>, test_size = <span class="number">.3</span>, train_size = <span class="number">.6</span>, random_state = <span class="number">0</span> ) <span class="comment"># run model 10x with 60/30 split intentionally leaving out 10%</span></div><div class="line"></div><div class="line"><span class="comment">#create table to compare MLA metrics</span></div><div class="line">MLA_columns = [<span class="string">'MLA Name'</span>, <span class="string">'MLA Parameters'</span>,<span class="string">'MLA Train Accuracy Mean'</span>, <span class="string">'MLA Test Accuracy Mean'</span>, <span class="string">'MLA Test Accuracy 3*STD'</span> ,<span class="string">'MLA Time'</span>]</div><div class="line">MLA_compare = pd.DataFrame(columns = MLA_columns)</div><div class="line"></div><div class="line"><span class="comment">#create table to compare MLA predictions</span></div><div class="line">MLA_predict = data1[Target]</div><div class="line"></div><div class="line"><span class="comment">#index through MLA and save performance to table</span></div><div class="line">row_index = <span class="number">0</span></div><div class="line"><span class="keyword">for</span> alg <span class="keyword">in</span> MLA:</div><div class="line"></div><div class="line">    <span class="comment">#set name and parameters</span></div><div class="line">    MLA_name = alg.__class__.__name__</div><div class="line">    MLA_compare.loc[row_index, <span class="string">'MLA Name'</span>] = MLA_name</div><div class="line">    MLA_compare.loc[row_index, <span class="string">'MLA Parameters'</span>] = str(alg.get_params())</div><div class="line">    </div><div class="line">    <span class="comment">#score model with cross validation: http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html#sklearn.model_selection.cross_validate</span></div><div class="line">    cv_results = model_selection.cross_validate(alg, data1[data1_x_bin], data1[Target], cv  = cv_split)</div><div class="line"></div><div class="line">    MLA_compare.loc[row_index, <span class="string">'MLA Time'</span>] = cv_results[<span class="string">'fit_time'</span>].mean()</div><div class="line">    MLA_compare.loc[row_index, <span class="string">'MLA Train Accuracy Mean'</span>] = cv_results[<span class="string">'train_score'</span>].mean()</div><div class="line">    MLA_compare.loc[row_index, <span class="string">'MLA Test Accuracy Mean'</span>] = cv_results[<span class="string">'test_score'</span>].mean()   </div><div class="line">    <span class="comment">#if this is a non-bias random sample, then +/-3 standard deviations (std) from the mean, should statistically capture 99.7% of the subsets</span></div><div class="line">    MLA_compare.loc[row_index, <span class="string">'MLA Test Accuracy 3*STD'</span>] = cv_results[<span class="string">'test_score'</span>].std()*<span class="number">3</span>   <span class="comment">#let's know the worst that can happen!</span></div><div class="line">    </div><div class="line"></div><div class="line">    <span class="comment">#save MLA predictions - see section 6 for usage</span></div><div class="line">    alg.fit(data1[data1_x_bin], data1[Target])</div><div class="line">    MLA_predict[MLA_name] = alg.predict(data1[data1_x_bin])</div><div class="line">    </div><div class="line">    row_index+=<span class="number">1</span></div><div class="line"></div><div class="line">    </div><div class="line"><span class="comment">#print and sort table: https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.sort_values.html</span></div><div class="line">MLA_compare.sort_values(by = [<span class="string">'MLA Test Accuracy Mean'</span>], ascending = <span class="keyword">False</span>, inplace = <span class="keyword">True</span>)</div><div class="line">MLA_compare</div><div class="line"><span class="comment">#MLA_predict</span></div></pre></td></tr></table></figure>
<div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right"><br>      <th></th><br>      <th>MLA Name</th><br>      <th>MLA Parameters</th><br>      <th>MLA Train Accuracy Mean</th><br>      <th>MLA Test Accuracy Mean</th><br>      <th>MLA Test Accuracy 3*STD</th><br>      <th>MLA Time</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>21</th><br>      <td>XGBClassifier</td><br>      <td>{‘base_score’: 0.5, ‘booster’: ‘gbtree’, ‘cols…</td><br>      <td>0.856367</td><br>      <td>0.829478</td><br>      <td>0.0527546</td><br>      <td>0.0243111</td><br>    </tr><br>    <tr><br>      <th>14</th><br>      <td>SVC</td><br>      <td>{‘C’: 1.0, ‘cache_size’: 200, ‘class_weight’: …</td><br>      <td>0.837266</td><br>      <td>0.826119</td><br>      <td>0.0453876</td><br>      <td>0.0363276</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>GradientBoostingClassifier</td><br>      <td>{‘criterion’: ‘friedman_mse’, ‘init’: None, ‘l…</td><br>      <td>0.866667</td><br>      <td>0.822761</td><br>      <td>0.0498731</td><br>      <td>0.0580237</td><br>    </tr><br>    <tr><br>      <th>15</th><br>      <td>NuSVC</td><br>      <td>{‘cache_size’: 200, ‘class_weight’: None, ‘coe…</td><br>      <td>0.835768</td><br>      <td>0.822761</td><br>      <td>0.0493681</td><br>      <td>0.0380909</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>ExtraTreesClassifier</td><br>      <td>{‘bootstrap’: False, ‘class_weight’: None, ‘cr…</td><br>      <td>0.895131</td><br>      <td>0.821642</td><br>      <td>0.0642658</td><br>      <td>0.0158152</td><br>    </tr><br>    <tr><br>      <th>17</th><br>      <td>DecisionTreeClassifier</td><br>      <td>{‘class_weight’: None, ‘criterion’: ‘gini’, ‘m…</td><br>      <td>0.895131</td><br>      <td>0.821642</td><br>      <td>0.0572539</td><br>      <td>0.00240188</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>RandomForestClassifier</td><br>      <td>{‘bootstrap’: True, ‘class_weight’: None, ‘cri…</td><br>      <td>0.89176</td><br>      <td>0.821269</td><br>      <td>0.0599586</td><br>      <td>0.0179999</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>BaggingClassifier</td><br>      <td>{‘base_estimator’: None, ‘bootstrap’: True, ‘b…</td><br>      <td>0.891199</td><br>      <td>0.819403</td><br>      <td>0.0656928</td><br>      <td>0.0202108</td><br>    </tr><br>    <tr><br>      <th>13</th><br>      <td>KNeighborsClassifier</td><br>      <td>{‘algorithm’: ‘auto’, ‘leaf_size’: 30, ‘metric…</td><br>      <td>0.850375</td><br>      <td>0.813806</td><br>      <td>0.0690863</td><br>      <td>0.00369971</td><br>    </tr><br>    <tr><br>      <th>0</th><br>      <td>AdaBoostClassifier</td><br>      <td>{‘algorithm’: ‘SAMME.R’, ‘base_estimator’: Non…</td><br>      <td>0.820412</td><br>      <td>0.81194</td><br>      <td>0.0498606</td><br>      <td>0.0667009</td><br>    </tr><br>    <tr><br>      <th>5</th><br>      <td>GaussianProcessClassifier</td><br>      <td>{‘copy_X_train’: True, ‘kernel’: None, ‘max_it…</td><br>      <td>0.871723</td><br>      <td>0.810448</td><br>      <td>0.0492537</td><br>      <td>0.204626</td><br>    </tr><br>    <tr><br>      <th>18</th><br>      <td>ExtraTreeClassifier</td><br>      <td>{‘class_weight’: None, ‘criterion’: ‘gini’, ‘m…</td><br>      <td>0.895131</td><br>      <td>0.808955</td><br>      <td>0.0725111</td><br>      <td>0.00140331</td><br>    </tr><br>    <tr><br>      <th>20</th><br>      <td>QuadraticDiscriminantAnalysis</td><br>      <td>{‘priors’: None, ‘reg_param’: 0.0, ‘store_cova…</td><br>      <td>0.821536</td><br>      <td>0.80709</td><br>      <td>0.0810389</td><br>      <td>0.00195031</td><br>    </tr><br>    <tr><br>      <th>8</th><br>      <td>RidgeClassifierCV</td><br>      <td>{‘alphas’: (0.1, 1.0, 10.0), ‘class_weight’: N…</td><br>      <td>0.796629</td><br>      <td>0.79403</td><br>      <td>0.0360302</td><br>      <td>0.00429864</td><br>    </tr><br>    <tr><br>      <th>19</th><br>      <td>LinearDiscriminantAnalysis</td><br>      <td>{‘n_components’: None, ‘priors’: None, ‘shrink…</td><br>      <td>0.796816</td><br>      <td>0.79403</td><br>      <td>0.0360302</td><br>      <td>0.00365217</td><br>    </tr><br>    <tr><br>      <th>16</th><br>      <td>LinearSVC</td><br>      <td>{‘C’: 1.0, ‘class_weight’: None, ‘dual’: True,…</td><br>      <td>0.797378</td><br>      <td>0.79291</td><br>      <td>0.0410533</td><br>      <td>0.0267416</td><br>    </tr><br>    <tr><br>      <th>6</th><br>      <td>LogisticRegressionCV</td><br>      <td>{‘Cs’: 10, ‘class_weight’: None, ‘cv’: None, ‘…</td><br>      <td>0.797004</td><br>      <td>0.790672</td><br>      <td>0.0653582</td><br>      <td>0.107427</td><br>    </tr><br>    <tr><br>      <th>12</th><br>      <td>GaussianNB</td><br>      <td>{‘priors’: None}</td><br>      <td>0.794757</td><br>      <td>0.781343</td><br>      <td>0.0874568</td><br>      <td>0.00235162</td><br>    </tr><br>    <tr><br>      <th>11</th><br>      <td>BernoulliNB</td><br>      <td>{‘alpha’: 1.0, ‘binarize’: 0.0, ‘class_prior’:…</td><br>      <td>0.785768</td><br>      <td>0.775373</td><br>      <td>0.0570347</td><br>      <td>0.00343521</td><br>    </tr><br>    <tr><br>      <th>10</th><br>      <td>Perceptron</td><br>      <td>{‘alpha’: 0.0001, ‘class_weight’: None, ‘eta0’…</td><br>      <td>0.740075</td><br>      <td>0.728731</td><br>      <td>0.162221</td><br>      <td>0.00332923</td><br>    </tr><br>    <tr><br>      <th>9</th><br>      <td>SGDClassifier</td><br>      <td>{‘alpha’: 0.0001, ‘average’: False, ‘class_wei…</td><br>      <td>0.714045</td><br>      <td>0.694776</td><br>      <td>0.245136</td><br>      <td>0.0019011</td><br>    </tr><br>    <tr><br>      <th>7</th><br>      <td>PassiveAggressiveClassifier</td><br>      <td>{‘C’: 1.0, ‘average’: False, ‘class_weight’: N…</td><br>      <td>0.687079</td><br>      <td>0.673134</td><br>      <td>0.455343</td><br>      <td>0.00274937</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#barplot using https://seaborn.pydata.org/generated/seaborn.barplot.html</span></div><div class="line">sns.barplot(x=<span class="string">'MLA Test Accuracy Mean'</span>, y = <span class="string">'MLA Name'</span>, data = MLA_compare, color = <span class="string">'m'</span>)</div><div class="line"></div><div class="line"><span class="comment">#prettify using pyplot: https://matplotlib.org/api/pyplot_api.html</span></div><div class="line">plt.title(<span class="string">'Machine Learning Algorithm Accuracy Score \n'</span>)</div><div class="line">plt.xlabel(<span class="string">'Accuracy Score (%)'</span>)</div><div class="line">plt.ylabel(<span class="string">'Algorithm'</span>)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.text.Text at 0x17acec6e940&gt;
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/53813862.jpg" alt=""></p>
<h2 id="5-1-Evaluate-Model-Performance"><a href="#5-1-Evaluate-Model-Performance" class="headerlink" title="5.1 Evaluate Model Performance"></a>5.1 Evaluate Model Performance</h2><p>Let’s recap, with some basic data cleaning, analysis, and machine learning algorithms (MLA), we are able to predict passenger survival with ~82% accuracy. Not bad for a few lines of code. But the question we always ask is, can we do better and more importantly get an ROI (return on investment) for our time invested? For example, if we’re only going to increase our accuracy by 1/10th of a percent, is it really worth 3-months of development. If you work in research maybe the answer is yes, but if you work in business mostly the answer is no. So, keep that in mind when improving your model.</p>
<h2 id="5-1评估模型性能"><a href="#5-1评估模型性能" class="headerlink" title="5.1评估模型性能"></a>5.1评估模型性能</h2><p>现在让我们回顾一下基本的数据清洗，分析和机器学习算法（MLA），我们能够以82％的准确度预测乘客的生存。几行代码不错。但是我们总是问的问题是，我们可以做得更好，更重要的是为我们投入的时间获得投资回报（ROI）吗？例如，如果我们只是把精度提高了十分之一，是否真的值3个月的发展。如果你从事研究工作，也许答案是肯定的，但是如果你在事业上工作，那么答案是否定的。所以，在改进模型的时候记住这一点。</p>
<h3 id="Data-Science-101-Determine-a-Baseline-Accuracy"><a href="#Data-Science-101-Determine-a-Baseline-Accuracy" class="headerlink" title="Data Science 101: Determine a Baseline Accuracy"></a>Data Science 101: Determine a Baseline Accuracy</h3><p>Before we decide how-to make our model better, let’s determine if our model is even worth keeping. To do that, we have to go back to the basics of data science 101. We know this is a binary problem, because there are only two possible outcomes; passengers survived or died. So, think of it like a coin flip problem. If you have a fair coin and you guessed heads or tail, then you have a 50-50 chance of guessing correct. So, let’s set 50% as the worst model performance; because anything lower than that, then why do I need you when I can just flip a coin?</p>
<p>Okay, so with no information about the dataset, we can always get 50% with a binary problem. But we have information about the dataset, so we should be able to do better. We know that 1,502/2,224 or 67.5% of people died. Therefore, if we just predict the most frequent occurrence, that 100% of people died, then we would be right 67.5% of the time. So, let’s set 68% as bad model performance, because again, anything lower than that, then why do I need you, when I can just predict using the most frequent occurrence.</p>
<h2 id="数据科学101：确定基线精度"><a href="#数据科学101：确定基线精度" class="headerlink" title="数据科学101：确定基线精度"></a>数据科学101：确定基线精度</h2><p>在我们决定如何使模型更好之前，让我们来确定我们的模型是否值得保留。要做到这一点，我们必须回到数据科学的基础101.我们知道这是一个二元问题，因为只有两个可能的结果; 乘客幸存或死亡。所以，把它看作是一个硬币翻转问题。如果你有一个公平的硬币，并且你猜对了，那么你有50-50的机会猜测是正确的。所以，我们设置50％作为最差的模型表现; 因为比这更低的东西，那我为什么需要你呢？<br>好的，没有关于数据集的信息，我们总是可以得到50％的二元问题。但是我们有关于数据集的信息，所以我们应该可以做得更好。我们知道1,502 / 2,224或67.5％的人死亡。因此，如果我们只是预测最频繁的事件，100％的人死亡，那么我们就是67.5％。所以，我们把68％设定为不好的模型表现，因为再低一点，那么为什么我需要你呢？</p>
<h3 id="Data-Science-101-How-to-Create-Your-Own-Model"><a href="#Data-Science-101-How-to-Create-Your-Own-Model" class="headerlink" title="Data Science 101: How-to Create Your Own Model"></a>Data Science 101: How-to Create Your Own Model</h3><p>Our accuracy is increasing, but can we do better? Are there any signals in our data? To illustrate this, we’re going to build our own decision tree model, because it is the easiest to conceptualize and requires simple addition and multiplication calculations. When creating a decision tree, you want to ask questions that segment your target response, placing the survived/1 and dead/0 into homogeneous subgroups. This is part science and part art, so let’s just play the 21-question game to show you how it works. If you want to follow along on your own, download the train dataset and import into Excel. Create a pivot table with survival in the columns, count and % of row count in the values, and the features described below in the rows.</p>
<p>Remember, the name of the game is to create subgroups using a decision tree model to get survived/1 in one bucket and dead/0 in another bucket. Our rule of thumb will be the majority rules. Meaning, if the majority or 50% or more survived, then everybody in our subgroup survived/1, but if 50% or less survived then if everybody in our subgroup died/0. Also, we will stop if the subgroup is less than 10 and/or our model accuracy plateaus or decreases. Got it? Let’s go!</p>
<h3 id="数据科学101：如何创建自己的模型"><a href="#数据科学101：如何创建自己的模型" class="headerlink" title="数据科学101：如何创建自己的模型"></a>数据科学101：如何创建自己的模型</h3><p>我们的准确度正在提高，但我们能做得更好吗？我们的数据中是否有任何信号？为了说明这一点，我们将建立我们自己的决策树模型，因为它是最简单的概念化，并且需要简单的加法和乘法计算。在创建决策树时，您需要提出将目标响应进行细分的问题，将存活/ 1和死/ 0置于同类小组中。这是科学和艺术的一部分，所以让我们玩21个问题的游戏，告诉你它是如何工作的。如果您想一个人继续，请下载火车数据集并导入到Excel中。在列中创建一个带有生存期的数据透视表，数值中行数的计数和百分比，以及下面在行中描述的特征。<br>请记住，游戏的名称是使用决策树模型创建子组，以在一个桶中生存/ 1，在另一个桶中死/ 0。我们的经验法则是多数规则。意思是说，如果大多数或50％或更多的人存活下来，那么我们小组中的每个人都存活/ 1，但是如果50％或更少存活，那么如果我们小组中的每个人都死亡/ 0。另外，如果子群小于10和/或我们的模型准确性高于或降低，我们将停止。得到它了？我们走吧！</p>
<p><strong>Question 1: Were you on the Titanic?</strong>If Yes, then majority (62%) died. Note our sample survival is different than our population of 68%. Nonetheless, if we assumed everybody died, our sample accuracy is 62%.</p>
<p><strong>问题1：你是在泰坦尼克号上吗</strong>？如果是，那么大概率会（62％）死亡。请注意，样本生存率与我们的68％的人口不同。不过，如果我们假设每个人都死了，我们的样本准确率是62％。</p>
<p><strong>Question 2: Are you male or female?</strong> Male, majority (81%) died. Female, majority (74%) survived. Giving us an accuracy of 79%.</p>
<p><strong>问题2：你是男性还是女性</strong>？男性占多数（81％）死亡。女性多数（74％）幸存下来。给我们一个79％的准确性。</p>
<p><strong>Question 3A (going down the female branch with count = 314): Are you in class 1, 2, or 3?</strong> Class 1, majority (97%) survived and Class 2, majority (92%) survived. Since the dead subgroup is less than 10, we will stop going down this branch. Class 3, is even at a 50-50 split. No new information to improve our model is gained.</p>
<p><strong>问题3A（计数= 314的女性分支）：</strong>你在1，2，3级吗？1级，多数（97％）存活，2级，多数（92％）存活。由于死亡小组不足10人，我们将停止下去这个分支。3级，甚至在50-50分裂。没有新的信息来改善我们的模型。</p>
<p><strong>Question 4A (going down the female class 3 branch with count = 144): Did you embark from port C, Q, or S?</strong> We gain a little information. C and Q, the majority still survived, so no change. Also, the dead subgroup is less than 10, so we will stop. S, the majority (63%) died. So, we will change females, class 3, embarked S from assuming they survived, to assuming they died. Our model accuracy increases to 81%.</p>
<p><strong>问题4A（顺着女班三级分支，计数= 144）：</strong>你是从C，Q，S出发的吗？我们获得一些信息。C和Q，大多数仍然存活，所以没有变化。另外，死亡小组小于10，所以我们将停止。S，大部分（63％）死亡。所以，我们会改变女性，三级，从假设他们存活下来，假设他们死了。我们的模型精度提高到81％。</p>
<p><strong>Question 5A (going down the female class 3 embarked S branch with count = 88):</strong> So far, it looks like we made good decisions. Adding another level does not seem to gain much more information. This subgroup 55 died and 33 survived, since majority died we need to find a signal to identify the 33 or a subgroup to change them from dead to survived and improve our model accuracy. We can play with our features. One I found was fare 0-8, majority survived. It’s a small sample size 11-9, but one often used in statistics. We slightly improve our accuracy, but not much to move us past 82%. So, we’ll stop here.</p>
<p><strong>问题5A（顺着女班3级走上S分支，计数= 88）：</strong>到目前为止，看起来我们做出了很好的决定。增加另一个级别似乎没有获得更多的信息。这个亚群55死亡，33人幸存，因为大多数死亡，我们需要找到一个信号，以确定33或一个小组，以改变他们从死亡到存活，提高我们的模型的准确性。我们可以玩我们的功能。我发现一个是票价0-8，大多数幸存下来。这是一个11-9的小样本，但经常用于统计。我们稍微提高了准确度，但是没有太多让我们超过82％。所以，我们会在这里停下来。</p>
<p><strong>Question 3B (going down the male branch with count = 577):</strong> Going back to question 2, we know the majority of males died. So, we are looking for a feature that identifies a subgroup that majority survived. Surprisingly, class or even embarked didn’t matter like it did for females, but title does and gets us to 82%. Guess and checking other features, none seem to push us past 82%. So, we’ll stop here for now.</p>
<p><strong>问题3B（计数= 577的男性分支）：</strong>回到问题2，我们知道大部分的男性死亡。所以，我们正在寻找一个功能，确定一个大多数幸存下来的小组。令人惊讶的是，上课或甚至上车并不像女性那样重要，但标题确实让我们达到了82％。猜测和检查其他功能，似乎没有推动我们超过82％。所以我们现在就停下来</p>
<p>You did it, with very little information, we get to 82% accuracy. On a worst, bad, good, better, and best scale, we’ll set 82% to good, since it’s a simple model that yields us decent results. But the question still remains, can we do better than our handmade model?</p>
<p>Before we do, let’s code what we just wrote above. Please note, this is a manual process created by “hand.” You won’t have to do this, but it’s important to understand it before you start working with MLA. Think of MLA like a TI-89 calculator on a Calculus Exam. It’s very powerful and helps you with a lot of the grunt work. But if you don’t know what you’re doing on the exam, a calculator, even a TI-89, is not going to help you pass. So, study the next section wisely.</p>
<p>Reference: <a href="http://www.cs.utoronto.ca/~fidler/teaching/2015/slides/CSC411/tutorial3_CrossVal-DTs.pdf" target="_blank" rel="external">Cross-Validation and Decision Tree Tutorial</a></p>
<p>你做到了，只有很少的信息，我们达到了82％的准确性。在最坏，最差，最好，最好和最好的规模上，我们将把82％设定为好，因为这是一个简单的模型，可以给我们带来不错的结果。但问题依然存在，我们能否比我们的手工制作模式做得更好？</p>
<p>在我们做之前，让我们编写我们刚刚写的。请注意，这是由“手”创建的手动过程。您不必这样做，但是在开始使用MLA之前，了解这一点非常重要。考虑微积分考试中的TI-89计算器。这是非常强大的，并帮助你很多的咕噜工作。但是如果你不知道自己在考试中做什么，那么计算器，甚至是TI-89，都不会帮你通过。所以，明智地研究下一部分。<br>参考：<a href="http://www.cs.utoronto.ca/~fidler/teaching/2015/slides/CSC411/tutorial3_CrossVal-DTs.pdf" target="_blank" rel="external">交叉验证和决策树教程</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#IMPORTANT: This is a handmade model for learning purposes only.</span></div><div class="line"><span class="comment">#However, it is possible to create your own predictive model without a fancy algorithm :)</span></div><div class="line"></div><div class="line"><span class="comment">#coin flip model with random 1/survived 0/died</span></div><div class="line"></div><div class="line"><span class="comment">#iterate over dataFrame rows as (index, Series) pairs: https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.iterrows.html</span></div><div class="line"><span class="keyword">for</span> index, row <span class="keyword">in</span> data1.iterrows(): </div><div class="line">    <span class="comment">#random number generator: https://docs.python.org/2/library/random.html</span></div><div class="line">    <span class="keyword">if</span> random.random() &gt; <span class="number">.5</span>:     <span class="comment"># Random float x, 0.0 &lt;= x &lt; 1.0    </span></div><div class="line">        data1.set_value(index, <span class="string">'Random_Predict'</span>, <span class="number">1</span>) <span class="comment">#predict survived/1</span></div><div class="line">    <span class="keyword">else</span>: </div><div class="line">        data1.set_value(index, <span class="string">'Random_Predict'</span>, <span class="number">0</span>) <span class="comment">#predict died/0</span></div><div class="line">    </div><div class="line"></div><div class="line"><span class="comment">#score random guess of survival. Use shortcut 1 = Right Guess and 0 = Wrong Guess</span></div><div class="line"><span class="comment">#the mean of the column will then equal the accuracy</span></div><div class="line">data1[<span class="string">'Random_Score'</span>] = <span class="number">0</span> <span class="comment">#assume prediction wrong</span></div><div class="line">data1.loc[(data1[<span class="string">'Survived'</span>] == data1[<span class="string">'Random_Predict'</span>]), <span class="string">'Random_Score'</span>] = <span class="number">1</span> <span class="comment">#set to 1 for correct prediction</span></div><div class="line">print(<span class="string">'Coin Flip Model Accuracy: &#123;:.2f&#125;%'</span>.format(data1[<span class="string">'Random_Score'</span>].mean()*<span class="number">100</span>))</div><div class="line"></div><div class="line"><span class="comment">#we can also use scikit's accuracy_score function to save us a few lines of code</span></div><div class="line"><span class="comment">#http://scikit-learn.org/stable/modules/generated/sklearn.metrics.accuracy_score.html#sklearn.metrics.accuracy_score</span></div><div class="line">print(<span class="string">'Coin Flip Model Accuracy w/SciKit: &#123;:.2f&#125;%'</span>.format(metrics.accuracy_score(data1[<span class="string">'Survived'</span>], data1[<span class="string">'Random_Predict'</span>])*<span class="number">100</span>))</div></pre></td></tr></table></figure>
<pre><code>Coin Flip Model Accuracy: 50.06%
Coin Flip Model Accuracy w/SciKit: 50.06%
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#group by or pivot table: https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html</span></div><div class="line">pivot_female = data1[data1.Sex==<span class="string">'female'</span>].groupby([<span class="string">'Sex'</span>,<span class="string">'Pclass'</span>, <span class="string">'Embarked'</span>,<span class="string">'FareBin'</span>])[<span class="string">'Survived'</span>].mean()</div><div class="line">print(<span class="string">'Survival Decision Tree w/Female Node: \n'</span>,pivot_female)</div><div class="line"></div><div class="line">pivot_male = data1[data1.Sex==<span class="string">'male'</span>].groupby([<span class="string">'Sex'</span>,<span class="string">'Title'</span>])[<span class="string">'Survived'</span>].mean()</div><div class="line">print(<span class="string">'\n\nSurvival Decision Tree w/Male Node: \n'</span>,pivot_male)</div></pre></td></tr></table></figure>
<pre><code>Survival Decision Tree w/Female Node: 
 Sex     Pclass  Embarked  FareBin        
female  1       C         (14.454, 31.0]     0.666667
                          (31.0, 512.329]    1.000000
                Q         (31.0, 512.329]    1.000000
                S         (14.454, 31.0]     1.000000
                          (31.0, 512.329]    0.955556
        2       C         (7.91, 14.454]     1.000000
                          (14.454, 31.0]     1.000000
                          (31.0, 512.329]    1.000000
                Q         (7.91, 14.454]     1.000000
                S         (7.91, 14.454]     0.875000
                          (14.454, 31.0]     0.916667
                          (31.0, 512.329]    1.000000
        3       C         (-0.001, 7.91]     1.000000
                          (7.91, 14.454]     0.428571
                          (14.454, 31.0]     0.666667
                Q         (-0.001, 7.91]     0.750000
                          (7.91, 14.454]     0.500000
                          (14.454, 31.0]     0.714286
                S         (-0.001, 7.91]     0.533333
                          (7.91, 14.454]     0.448276
                          (14.454, 31.0]     0.357143
                          (31.0, 512.329]    0.125000
Name: Survived, dtype: float64


Survival Decision Tree w/Male Node: 
 Sex   Title 
male  Master    0.575000
      Misc      0.250000
      Mr        0.156673
Name: Survived, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#handmade data model using brain power (and Microsoft Excel Pivot Tables for quick calculations)</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">mytree</span><span class="params">(df)</span>:</span></div><div class="line">    </div><div class="line">    <span class="comment">#initialize table to store predictions</span></div><div class="line">    Model = pd.DataFrame(data = &#123;<span class="string">'Predict'</span>:[]&#125;)</div><div class="line">    male_title = [<span class="string">'Master'</span>] <span class="comment">#survived titles</span></div><div class="line"></div><div class="line">    <span class="keyword">for</span> index, row <span class="keyword">in</span> df.iterrows():</div><div class="line"></div><div class="line">        <span class="comment">#Question 1: Were you on the Titanic; majority died</span></div><div class="line">        Model.loc[index, <span class="string">'Predict'</span>] = <span class="number">0</span></div><div class="line"></div><div class="line">        <span class="comment">#Question 2: Are you female; majority survived</span></div><div class="line">        <span class="keyword">if</span> (df.loc[index, <span class="string">'Sex'</span>] == <span class="string">'female'</span>):</div><div class="line">                  Model.loc[index, <span class="string">'Predict'</span>] = <span class="number">1</span></div><div class="line"></div><div class="line">        <span class="comment">#Question 3A Female - Class and Question 4 Embarked gain minimum information</span></div><div class="line"></div><div class="line">        <span class="comment">#Question 5B Female - FareBin; set anything less than .5 in female node decision tree back to 0       </span></div><div class="line">        <span class="keyword">if</span> ((df.loc[index, <span class="string">'Sex'</span>] == <span class="string">'female'</span>) &amp; </div><div class="line">            (df.loc[index, <span class="string">'Pclass'</span>] == <span class="number">3</span>) &amp; </div><div class="line">            (df.loc[index, <span class="string">'Embarked'</span>] == <span class="string">'S'</span>)  &amp;</div><div class="line">            (df.loc[index, <span class="string">'Fare'</span>] &gt; <span class="number">8</span>)</div><div class="line"></div><div class="line">           ):</div><div class="line">                  Model.loc[index, <span class="string">'Predict'</span>] = <span class="number">0</span></div><div class="line"></div><div class="line">        <span class="comment">#Question 3B Male: Title; set anything greater than .5 to 1 for majority survived</span></div><div class="line">        <span class="keyword">if</span> ((df.loc[index, <span class="string">'Sex'</span>] == <span class="string">'male'</span>) &amp;</div><div class="line">            (df.loc[index, <span class="string">'Title'</span>] <span class="keyword">in</span> male_title)</div><div class="line">            ):</div><div class="line">            Model.loc[index, <span class="string">'Predict'</span>] = <span class="number">1</span></div><div class="line">        </div><div class="line">        </div><div class="line">    <span class="keyword">return</span> Model</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#model data</span></div><div class="line">Tree_Predict = mytree(data1)</div><div class="line">print(<span class="string">'Decision Tree Model Accuracy/Precision Score: &#123;:.2f&#125;%\n'</span>.format(metrics.accuracy_score(data1[<span class="string">'Survived'</span>], Tree_Predict)*<span class="number">100</span>))</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#Accuracy Summary Report with http://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html#sklearn.metrics.classification_report</span></div><div class="line"><span class="comment">#Where recall score = (true positives)/(true positive + false negative) w/1 being best:http://scikit-learn.org/stable/modules/generated/sklearn.metrics.recall_score.html#sklearn.metrics.recall_score</span></div><div class="line"><span class="comment">#And F1 score = weighted average of precision and recall w/1 being best: http://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html#sklearn.metrics.f1_score</span></div><div class="line">print(metrics.classification_report(data1[<span class="string">'Survived'</span>], Tree_Predict))</div></pre></td></tr></table></figure>
<pre><code>Decision Tree Model Accuracy/Precision Score: 82.04%

             precision    recall  f1-score   support

          0       0.82      0.91      0.86       549
          1       0.82      0.68      0.75       342

avg / total       0.82      0.82      0.82       891
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Plot Accuracy Summary</span></div><div class="line"><span class="comment">#Credit: http://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.html</span></div><div class="line"><span class="keyword">import</span> itertools</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_confusion_matrix</span><span class="params">(cm, classes,</span></span></div><div class="line">                          normalize=False,</div><div class="line">                          title=<span class="string">'Confusion matrix'</span>,</div><div class="line">                          cmap=plt.cm.Blues):</div><div class="line">    <span class="string">"""</span></div><div class="line">    This function prints and plots the confusion matrix.</div><div class="line">    Normalization can be applied by setting `normalize=True`.</div><div class="line">    """</div><div class="line">    <span class="keyword">if</span> normalize:</div><div class="line">        cm = cm.astype(<span class="string">'float'</span>) / cm.sum(axis=<span class="number">1</span>)[:, np.newaxis]</div><div class="line">        print(<span class="string">"Normalized confusion matrix"</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        print(<span class="string">'Confusion matrix, without normalization'</span>)</div><div class="line"></div><div class="line">    print(cm)</div><div class="line"></div><div class="line">    plt.imshow(cm, interpolation=<span class="string">'nearest'</span>, cmap=cmap)</div><div class="line">    plt.title(title)</div><div class="line">    plt.colorbar()</div><div class="line">    tick_marks = np.arange(len(classes))</div><div class="line">    plt.xticks(tick_marks, classes, rotation=<span class="number">45</span>)</div><div class="line">    plt.yticks(tick_marks, classes)</div><div class="line"></div><div class="line">    fmt = <span class="string">'.2f'</span> <span class="keyword">if</span> normalize <span class="keyword">else</span> <span class="string">'d'</span></div><div class="line">    thresh = cm.max() / <span class="number">2.</span></div><div class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> itertools.product(range(cm.shape[<span class="number">0</span>]), range(cm.shape[<span class="number">1</span>])):</div><div class="line">        plt.text(j, i, format(cm[i, j], fmt),</div><div class="line">                 horizontalalignment=<span class="string">"center"</span>,</div><div class="line">                 color=<span class="string">"white"</span> <span class="keyword">if</span> cm[i, j] &gt; thresh <span class="keyword">else</span> <span class="string">"black"</span>)</div><div class="line"></div><div class="line">    plt.tight_layout()</div><div class="line">    plt.ylabel(<span class="string">'True label'</span>)</div><div class="line">    plt.xlabel(<span class="string">'Predicted label'</span>)</div><div class="line"></div><div class="line"><span class="comment"># Compute confusion matrix</span></div><div class="line">cnf_matrix = metrics.confusion_matrix(data1[<span class="string">'Survived'</span>], Tree_Predict)</div><div class="line">np.set_printoptions(precision=<span class="number">2</span>)</div><div class="line"></div><div class="line">class_names = [<span class="string">'Dead'</span>, <span class="string">'Survived'</span>]</div><div class="line"><span class="comment"># Plot non-normalized confusion matrix</span></div><div class="line">plt.figure()</div><div class="line">plot_confusion_matrix(cnf_matrix, classes=class_names,</div><div class="line">                      title=<span class="string">'Confusion matrix, without normalization'</span>)</div><div class="line"></div><div class="line"><span class="comment"># Plot normalized confusion matrix</span></div><div class="line">plt.figure()</div><div class="line">plot_confusion_matrix(cnf_matrix, classes=class_names, normalize=<span class="keyword">True</span>, </div><div class="line">                      title=<span class="string">'Normalized confusion matrix'</span>)</div></pre></td></tr></table></figure>
<pre><code>Confusion matrix, without normalization
[[497  52]
 [108 234]]
Normalized confusion matrix
[[ 0.91  0.09]
 [ 0.32  0.68]]
</code></pre><p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/16532868.jpg" alt=""></p>
<p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/41810479.jpg" alt=""></p>
<h2 id="5-11-Model-Performance-with-Cross-Validation-CV"><a href="#5-11-Model-Performance-with-Cross-Validation-CV" class="headerlink" title="5.11 Model Performance with Cross-Validation (CV)"></a>5.11 Model Performance with Cross-Validation (CV)</h2><p>In step 5.0, we used sklearn cross_validate function to train, test, and score our model performance.</p>
<p>Remember, it’s important we use a different subset for train data to build our model and test data to evaluate our model. Otherwise, our model will be overfitted. Meaning it’s great at “predicting” data it’s already seen, but terrible at predicting data it has not seen; which is not prediction at all. It’s like cheating on a school quiz to get 100%, but then when you go to take the exam, you fail because you never truly learned anything. The same is true with machine learning.</p>
<p>CV is basically a shortcut to split and score our model multiple times, so we can get an idea of how well it will perform on unseen data. It’s a little more expensive in computer processing, but it’s important so we don’t gain false confidence. This is helpful in a Kaggle Competition or any use case where consistency matters and surprises should be avoided.</p>
<p>In addition to CV, we used a customized sklearn train test splitter, to allow a little more randomness in our test scoring. Below is an image of the default CV split.</p>
<h2 id="5-11交叉验证的模型性能（CV）"><a href="#5-11交叉验证的模型性能（CV）" class="headerlink" title="5.11交叉验证的模型性能（CV）"></a>5.11交叉验证的模型性能（CV）</h2><p>在步骤5.0中，我们使用了sklearn cross_validate函数来训练，测试和评分我们的模型性能。<br>请记住，重要的是我们使用不同的子集来建立我们的模型和测试数据来评估我们的模型。否则，我们的模型将会过度配置。这意味着“预测”已经看到的数据是很好的，但是在预测未见的数据方面很糟糕; 这根本不是预测。这就像在学校测验中作弊得到100％，但当你参加考试时，你失败了，因为你从来没有真正学到任何东西。机器学习也是如此。<br>简历基本上是多次分割和评分我们模型的快捷方式，所以我们可以了解它在未看到的数据上表现如何。在计算机处理方面它的成本稍高一些，但重要的是我们不会得到错误的信心。这对于Kaggle比赛或任何应避免一致性和意外事件的使用案例是有帮助的。<br>除了CV之外，我们还使用了一个定制的sklearn火车测试分离器，在我们的测试评分中允许更多的随机性。以下是默认CV分割的图像。<br><img src="http://blog-test.goldenhelix.com/wp-content/uploads/2015/04/B-fig-1.jpg" alt=""></p>
<h2 id="5-12-Tune-Model-with-Hyper-Parameters"><a href="#5-12-Tune-Model-with-Hyper-Parameters" class="headerlink" title="5.12 Tune Model with Hyper-Parameters"></a>5.12 Tune Model with Hyper-Parameters</h2><p>When we used <a href="http://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier" target="_blank" rel="external">sklearn Decision Tree (DT) Classifier</a>, we accepted all the function defaults. This leaves opportunity to see how various hyper-parameter settings will change the model accuracy. <a href="https://www.youtube.com/watch?v=EJtTNboTsm8" target="_blank" rel="external">(Click here to learn more about parameters vs hyper-parameters.)</a></p>
<p>However, in order to tune a model, we need to actually understand it. That’s why I took the time in the previous sections to show you how predictions work. Now let’s learn a little bit more about our DT algorithm.</p>
<h3 id="5-12使用超参数调整模型"><a href="#5-12使用超参数调整模型" class="headerlink" title="5.12使用超参数调整模型"></a>5.12使用超参数调整模型</h3><p>当我们使用sklearn决策树（DT）分类器时，我们接受了所有的函数默认值。这让人们有机会看到各种超参数设置如何改变模型精度。（点击这里了解更多关于参数与超参数的信息。）<br>但是，为了调整模型，我们需要真正理解它。这就是为什么我在前几节中花时间向你展示预测是如何工作的。现在让我们多了解一下DT算法。</p>
<p>Credit: <a href="http://scikit-learn.org/stable/modules/tree.html#classification" target="_blank" rel="external">sklearn</a></p>
<p><strong>Some advantages of decision trees are:</strong></p>
<ul>
<li>Simple to understand and to interpret. Trees can be visualized.</li>
<li>Requires little data preparation. Other techniques often require data normalization, dummy variables need to be created and blank values to be removed. Note however that this module does not support missing values.</li>
<li>The cost of using the tree (i.e., predicting data) is logarithmic in the number of data points used to train the tree.</li>
<li>Able to handle both numerical and categorical data. Other techniques are usually specialized in analyzing datasets that have only one type of variable. See algorithms for more information.</li>
<li>Able to handle multi-output problems.</li>
<li>Uses a white box model. If a given situation is observable in a model, the explanation for the condition is easily explained by Boolean logic. By contrast, in a black box model (e.g., in an artificial neural network), results may be more difficult to interpret.</li>
<li>Possible to validate a model using statistical tests. That makes it possible to account for the reliability of the model.</li>
<li>Performs well even if its assumptions are somewhat violated by the true model from which the data were generated.</li>
</ul>
<p><strong>The disadvantages of decision trees include:</strong></p>
<ul>
<li>Decision-tree learners can create over-complex trees that do not generalize the data well. This is called overfitting. Mechanisms such as pruning (not currently supported), setting the minimum number of samples required at a leaf node or setting the maximum depth of the tree are necessary to avoid this problem.</li>
<li>Decision trees can be unstable because small variations in the data might result in a completely different tree being generated. This problem is mitigated by using decision trees within an ensemble.</li>
<li>The problem of learning an optimal decision tree is known to be NP-complete under several aspects of optimality and even for simple concepts. Consequently, practical decision-tree learning algorithms are based on heuristic algorithms such as the greedy algorithm where locally optimal decisions are made at each node. Such algorithms cannot guarantee to return the globally optimal decision tree. This can be mitigated by training multiple trees in an ensemble learner, where the features and samples are randomly sampled with replacement.</li>
<li>There are concepts that are hard to learn because decision trees do not express them easily, such as XOR, parity or multiplexer problems.</li>
<li>Decision tree learners create biased trees if some classes dominate. It is therefore recommended to balance the dataset prior to fitting with the decision tree.<br>Below are available hyper-parameters and <a href="http://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier" target="_blank" rel="external">defintions</a>:</li>
</ul>
<p>关于：sklearn<br>决策树的一些优点是：</p>
<ul>
<li>简单理解和解释。树可以被可视化。</li>
<li>需要很少的数据准备。其他技术通常需要数据标准化，需要创建虚拟变量，并删除空白值。但请注意，该模块不支持缺少的值。</li>
<li>使用树（即，预测数据）的成本是用于训练树的数据点的数量的对数。</li>
<li>能够处理数字和分类数据。其他技术通常专门用于分析只有一种变量的数据集。查看更多信息的算法。<br>能够处理多输出问题。</li>
<li>使用白盒模型。如果一个给定的情况在模型中是可观察的，那么这个条件的解释就可以用布尔逻辑来解释。相比之下，在黑箱模型（例如，在人造神经网络中），结果可能更难以解释。</li>
<li>可以使用统计测试来验证模型。这可以说明模型的可靠性。</li>
<li>即使其假设受到数据生成的真实模型的某些违反，也能很好地执行。<br>决策树的缺点包括：</li>
<li>决策树学习者可以创建过于复杂的树，不能很好地概括数据。这被称为过度拟合。修剪（目前不支持）等机制，设置叶节点所需的最小样本数或设置树的最大深度是避免此问题所必需的。</li>
<li>决策树可能是不稳定的，因为数据的小变化可能导致生成完全不同的树。通过在集合中使用决策树可以缓解这个问题。</li>
<li>学习最优决策树的问题在最优化的几个方面甚至简单的概念上都被认为是NP完全的。因此，实际的决策树学习算法基于启发式算法，例如在每个节点处进行局部最优决策的贪婪算法。这样的算法不能保证返回全局最优的决策树。这可以通过在集合学习器中训练多个树来减轻，其中特征和样本随机地被替换。</li>
<li>有些概念很难学，因为决策树不能很容易地表达它们，比如XOR，奇偶校验或多路复用器问题。</li>
<li>决策树学习者如果某些类占主导地位，就会创建偏向性树。因此建议在拟合决策树之前平衡数据集。以下是可用的超参数和<a href="http://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier" target="_blank" rel="external">定义</a>：</li>
</ul>
<p>（译者注：下面是一些sklearn的决策树方法展示）<br>class sklearn.tree.DecisionTreeClassifier(criterion=’gini’, splitter=’best’, max_depth=None, min_samples_split=2, min_samples_leaf=1, min_weight_fraction_leaf=0.0, max_features=None, random_state=None, max_leaf_nodes=None, min_impurity_decrease=0.0, min_impurity_split=None, class_weight=None, presort=False)<br>We will tune our model using <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.ParameterGrid.html#sklearn.model_selection.ParameterGrid" target="_blank" rel="external">ParameterGrid</a>, <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" target="_blank" rel="external">GridSearchCV</a>, and customized <a href="http://scikit-learn.org/stable/modules/model_evaluation.html" target="_blank" rel="external">sklearn</a> scoring; <a href="http://www.dataschool.io/roc-curves-and-auc-explained/" target="_blank" rel="external">click here to learn more about ROC_AUC scores</a>. We will then visualize our tree with <a href="http://scikit-learn.org/stable/modules/generated/sklearn.tree.export_graphviz.html#sklearn.tree.export_graphviz" target="_blank" rel="external">graphviz</a>. <a href="http://www.dataschool.io/roc-curves-and-auc-explained/" target="_blank" rel="external">Click here to learn more about ROC_AUC scores.</a></p>
<p>我们将在我们的模型中使用的<a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.ParameterGrid.html#sklearn.model_selection.ParameterGrid" target="_blank" rel="external">ParameterGrid</a>, <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" target="_blank" rel="external">GridSearchCV</a>, 以及自定义 <a href="http://scikit-learn.org/stable/modules/model_evaluation.html" target="_blank" rel="external">sklearn</a> 评分; <a href="http://www.dataschool.io/roc-curves-and-auc-explained/" target="_blank" rel="external">点击这里来了解更多关于ROC_AUC分数</a>. 然后我们将用<a href="http://scikit-learn.org/stable/modules/generated/sklearn.tree.export_graphviz.html#sklearn.tree.export_graphviz" target="_blank" rel="external">graphviz</a>可视化我们的树 . <a href="http://www.dataschool.io/roc-curves-and-auc-explained/" target="_blank" rel="external">点击这里了解更多有关ROC_AUC分数的信息。</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#base model</span></div><div class="line">dtree = tree.DecisionTreeClassifier(random_state = <span class="number">0</span>)</div><div class="line">base_results = model_selection.cross_validate(dtree, data1[data1_x_bin], data1[Target], cv  = cv_split)</div><div class="line">dtree.fit(data1[data1_x_bin], data1[Target])</div><div class="line"></div><div class="line">print(<span class="string">'BEFORE DT Parameters: '</span>, dtree.get_params())</div><div class="line">print(<span class="string">"BEFORE DT Training w/bin score mean: &#123;:.2f&#125;"</span>. format(base_results[<span class="string">'train_score'</span>].mean()*<span class="number">100</span>)) </div><div class="line">print(<span class="string">"BEFORE DT Test w/bin score mean: &#123;:.2f&#125;"</span>. format(base_results[<span class="string">'test_score'</span>].mean()*<span class="number">100</span>))</div><div class="line">print(<span class="string">"BEFORE DT Test w/bin score 3*std: +/- &#123;:.2f&#125;"</span>. format(base_results[<span class="string">'test_score'</span>].std()*<span class="number">100</span>*<span class="number">3</span>))</div><div class="line"><span class="comment">#print("BEFORE DT Test w/bin set score min: &#123;:.2f&#125;". format(base_results['test_score'].min()*100))</span></div><div class="line">print(<span class="string">'-'</span>*<span class="number">10</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#tune hyper-parameters: http://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier</span></div><div class="line">param_grid = &#123;<span class="string">'criterion'</span>: [<span class="string">'gini'</span>, <span class="string">'entropy'</span>],  <span class="comment">#scoring methodology; two supported formulas for calculating information gain - default is gini</span></div><div class="line">              <span class="comment">#'splitter': ['best', 'random'], #splitting methodology; two supported strategies - default is best</span></div><div class="line">              <span class="string">'max_depth'</span>: [<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="keyword">None</span>], <span class="comment">#max depth tree can grow; default is none</span></div><div class="line">              <span class="comment">#'min_samples_split': [2,5,10,.03,.05], #minimum subset size BEFORE new split (fraction is % of total); default is 2</span></div><div class="line">              <span class="comment">#'min_samples_leaf': [1,5,10,.03,.05], #minimum subset size AFTER new split split (fraction is % of total); default is 1</span></div><div class="line">              <span class="comment">#'max_features': [None, 'auto'], #max features to consider when performing split; default none or all</span></div><div class="line">              <span class="string">'random_state'</span>: [<span class="number">0</span>] <span class="comment">#seed or control random number generator: https://www.quora.com/What-is-seed-in-random-number-generation</span></div><div class="line">             &#125;</div><div class="line"></div><div class="line"><span class="comment">#print(list(model_selection.ParameterGrid(param_grid)))</span></div><div class="line"></div><div class="line"><span class="comment">#choose best model with grid_search: #http://scikit-learn.org/stable/modules/grid_search.html#grid-search</span></div><div class="line"><span class="comment">#http://scikit-learn.org/stable/auto_examples/model_selection/plot_grid_search_digits.html</span></div><div class="line">tune_model = model_selection.GridSearchCV(tree.DecisionTreeClassifier(), param_grid=param_grid, scoring = <span class="string">'roc_auc'</span>, cv = cv_split)</div><div class="line">tune_model.fit(data1[data1_x_bin], data1[Target])</div><div class="line"></div><div class="line"><span class="comment">#print(tune_model.cv_results_.keys())</span></div><div class="line"><span class="comment">#print(tune_model.cv_results_['params'])</span></div><div class="line">print(<span class="string">'AFTER DT Parameters: '</span>, tune_model.best_params_)</div><div class="line"><span class="comment">#print(tune_model.cv_results_['mean_train_score'])</span></div><div class="line">print(<span class="string">"AFTER DT Training w/bin score mean: &#123;:.2f&#125;"</span>. format(tune_model.cv_results_[<span class="string">'mean_train_score'</span>][tune_model.best_index_]*<span class="number">100</span>)) </div><div class="line"><span class="comment">#print(tune_model.cv_results_['mean_test_score'])</span></div><div class="line">print(<span class="string">"AFTER DT Test w/bin score mean: &#123;:.2f&#125;"</span>. format(tune_model.cv_results_[<span class="string">'mean_test_score'</span>][tune_model.best_index_]*<span class="number">100</span>))</div><div class="line">print(<span class="string">"AFTER DT Test w/bin score 3*std: +/- &#123;:.2f&#125;"</span>. format(tune_model.cv_results_[<span class="string">'std_test_score'</span>][tune_model.best_index_]*<span class="number">100</span>*<span class="number">3</span>))</div><div class="line">print(<span class="string">'-'</span>*<span class="number">10</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#duplicates gridsearchcv</span></div><div class="line"><span class="comment">#tune_results = model_selection.cross_validate(tune_model, data1[data1_x_bin], data1[Target], cv  = cv_split)</span></div><div class="line"></div><div class="line"><span class="comment">#print('AFTER DT Parameters: ', tune_model.best_params_)</span></div><div class="line"><span class="comment">#print("AFTER DT Training w/bin set score mean: &#123;:.2f&#125;". format(tune_results['train_score'].mean()*100)) </span></div><div class="line"><span class="comment">#print("AFTER DT Test w/bin set score mean: &#123;:.2f&#125;". format(tune_results['test_score'].mean()*100))</span></div><div class="line"><span class="comment">#print("AFTER DT Test w/bin set score min: &#123;:.2f&#125;". format(tune_results['test_score'].min()*100))</span></div><div class="line"><span class="comment">#print('-'*10)</span></div></pre></td></tr></table></figure>
<pre><code>BEFORE DT Parameters:  {&apos;class_weight&apos;: None, &apos;criterion&apos;: &apos;gini&apos;, &apos;max_depth&apos;: None, &apos;max_features&apos;: None, &apos;max_leaf_nodes&apos;: None, &apos;min_impurity_decrease&apos;: 0.0, &apos;min_impurity_split&apos;: None, &apos;min_samples_leaf&apos;: 1, &apos;min_samples_split&apos;: 2, &apos;min_weight_fraction_leaf&apos;: 0.0, &apos;presort&apos;: False, &apos;random_state&apos;: 0, &apos;splitter&apos;: &apos;best&apos;}
BEFORE DT Training w/bin score mean: 89.51
BEFORE DT Test w/bin score mean: 82.09
BEFORE DT Test w/bin score 3*std: +/- 5.57
----------
AFTER DT Parameters:  {&apos;criterion&apos;: &apos;gini&apos;, &apos;max_depth&apos;: 4, &apos;random_state&apos;: 0}
AFTER DT Training w/bin score mean: 89.35
AFTER DT Test w/bin score mean: 87.40
AFTER DT Test w/bin score 3*std: +/- 5.00
----------
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Graph MLA version of Decision Tree: http://scikit-learn.org/stable/modules/generated/sklearn.tree.export_graphviz.html</span></div><div class="line"><span class="comment"># if  raise FileNotFoundError please run [ conda install graphviz ] with cmd</span></div><div class="line"><span class="comment"># question link: https://stackoverflow.com/questions/28312534/graphvizs-executables-are-not-found-python-3-4</span></div><div class="line"><span class="keyword">import</span> graphviz </div><div class="line">dot_data = tree.export_graphviz(dtree, out_file=<span class="keyword">None</span>, </div><div class="line">                                feature_names = data1_x_bin, class_names = <span class="keyword">True</span>,</div><div class="line">                                filled = <span class="keyword">True</span>, rounded = <span class="keyword">True</span>)</div><div class="line">graph = graphviz.Source(dot_data) </div><div class="line"><span class="comment"># output this</span></div><div class="line"><span class="comment">#graph.render('treemodel.gv')  </span></div><div class="line">graph</div></pre></td></tr></table></figure>
<p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/3309996.jpg" alt=""><br><img src="output_40_0.svg" alt="svg"></p>
<h2 id="Step-6-Validate-and-Implement"><a href="#Step-6-Validate-and-Implement" class="headerlink" title="Step 6: Validate and Implement"></a>Step 6: Validate and Implement</h2><p>The next step is to prepare for submission using the validation data</p>
<h2 id="第6步：验证和实施"><a href="#第6步：验证和实施" class="headerlink" title="第6步：验证和实施"></a>第6步：验证和实施</h2><p>下一步是使用验证数据准备提交</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#compare algorithm predictions with each other, where 1 = exactly similar and 0 = exactly opposite</span></div><div class="line"><span class="comment">#there are some 1's, but enough blues and light reds to create a "super algorithm" by combining them</span></div><div class="line">correlation_heatmap(MLA_predict)</div></pre></td></tr></table></figure>
<p><img src="http://om80aljc8.bkt.clouddn.com/18-1-4/88064178.jpg" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#why choose one model, when you can pick them all with voting classifier</span></div><div class="line"><span class="comment">#http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.VotingClassifier.html</span></div><div class="line"><span class="comment">#removed models w/o attribute 'predict_proba' required for vote classifier and models with a 1.0 correlation to another model</span></div><div class="line">vote_est = [</div><div class="line">    <span class="comment">#Ensemble Methods: http://scikit-learn.org/stable/modules/ensemble.html</span></div><div class="line">    (<span class="string">'ada'</span>, ensemble.AdaBoostClassifier()),</div><div class="line">    (<span class="string">'bc'</span>, ensemble.BaggingClassifier()),</div><div class="line">    (<span class="string">'etc'</span>,ensemble.ExtraTreesClassifier()),</div><div class="line">    (<span class="string">'gbc'</span>, ensemble.GradientBoostingClassifier()),</div><div class="line">    (<span class="string">'rfc'</span>, ensemble.RandomForestClassifier()),</div><div class="line"></div><div class="line">    <span class="comment">#Gaussian Processes: http://scikit-learn.org/stable/modules/gaussian_process.html#gaussian-process-classification-gpc</span></div><div class="line">    (<span class="string">'gpc'</span>, gaussian_process.GaussianProcessClassifier()),</div><div class="line">    </div><div class="line">    <span class="comment">#GLM: http://scikit-learn.org/stable/modules/linear_model.html#logistic-regression</span></div><div class="line">    (<span class="string">'lr'</span>, linear_model.LogisticRegressionCV()),</div><div class="line">    </div><div class="line">    <span class="comment">#Navies Bayes: http://scikit-learn.org/stable/modules/naive_bayes.html</span></div><div class="line">    (<span class="string">'bnb'</span>, naive_bayes.BernoulliNB()),</div><div class="line">    (<span class="string">'gnb'</span>, naive_bayes.GaussianNB()),</div><div class="line">    </div><div class="line">    <span class="comment">#Nearest Neighbor: http://scikit-learn.org/stable/modules/neighbors.html</span></div><div class="line">    (<span class="string">'knn'</span>, neighbors.KNeighborsClassifier()),</div><div class="line">    </div><div class="line">    <span class="comment">#SVM: http://scikit-learn.org/stable/modules/svm.html</span></div><div class="line">    (<span class="string">'svc'</span>, svm.SVC(probability=<span class="keyword">True</span>)),</div><div class="line">    </div><div class="line">    <span class="comment">#xgboost: http://xgboost.readthedocs.io/en/latest/model.html</span></div><div class="line">   (<span class="string">'xgb'</span>, XGBClassifier())</div><div class="line"></div><div class="line">]</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#Hard Vote or majority rules</span></div><div class="line">vote_hard = ensemble.VotingClassifier(estimators = vote_est , voting = <span class="string">'hard'</span>)</div><div class="line">vote_hard_cv = model_selection.cross_validate(vote_hard, data1[data1_x_bin], data1[Target], cv  = cv_split)</div><div class="line">vote_hard.fit(data1[data1_x_bin], data1[Target])</div><div class="line"></div><div class="line">print(<span class="string">"Hard Voting Training w/bin score mean: &#123;:.2f&#125;"</span>. format(vote_hard_cv[<span class="string">'train_score'</span>].mean()*<span class="number">100</span>)) </div><div class="line">print(<span class="string">"Hard Voting Test w/bin score mean: &#123;:.2f&#125;"</span>. format(vote_hard_cv[<span class="string">'test_score'</span>].mean()*<span class="number">100</span>))</div><div class="line">print(<span class="string">"Hard Voting Test w/bin score 3*std: +/- &#123;:.2f&#125;"</span>. format(vote_hard_cv[<span class="string">'test_score'</span>].std()*<span class="number">100</span>*<span class="number">3</span>))</div><div class="line">print(<span class="string">'-'</span>*<span class="number">10</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#Soft Vote or weighted probabilities</span></div><div class="line">vote_soft = ensemble.VotingClassifier(estimators = vote_est , voting = <span class="string">'soft'</span>)</div><div class="line">vote_soft_cv = model_selection.cross_validate(vote_soft, data1[data1_x_bin], data1[Target], cv  = cv_split)</div><div class="line">vote_soft.fit(data1[data1_x_bin], data1[Target])</div><div class="line"></div><div class="line">print(<span class="string">"Soft Voting Training w/bin score mean: &#123;:.2f&#125;"</span>. format(vote_soft_cv[<span class="string">'train_score'</span>].mean()*<span class="number">100</span>)) </div><div class="line">print(<span class="string">"Soft Voting Test w/bin score mean: &#123;:.2f&#125;"</span>. format(vote_soft_cv[<span class="string">'test_score'</span>].mean()*<span class="number">100</span>))</div><div class="line">print(<span class="string">"Soft Voting Test w/bin score 3*std: +/- &#123;:.2f&#125;"</span>. format(vote_soft_cv[<span class="string">'test_score'</span>].std()*<span class="number">100</span>*<span class="number">3</span>))</div><div class="line">print(<span class="string">'-'</span>*<span class="number">10</span>)</div></pre></td></tr></table></figure>
<pre><code>Hard Voting Training w/bin score mean: 86.61
Hard Voting Test w/bin score mean: 82.46
Hard Voting Test w/bin score 3*std: +/- 4.34
----------
Soft Voting Training w/bin score mean: 87.23
Soft Voting Test w/bin score mean: 82.24
Soft Voting Test w/bin score 3*std: +/- 4.94
----------
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#WARNING: Running is very computational intensive and time expensive.</span></div><div class="line"><span class="comment">#Code is written for experimental/developmental purposes and not production ready!</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#Hyperparameter Tune with GridSearchCV: http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</span></div><div class="line">grid_n_estimator = [<span class="number">10</span>, <span class="number">50</span>, <span class="number">100</span>, <span class="number">300</span>]</div><div class="line">grid_ratio = [<span class="number">.1</span>, <span class="number">.25</span>, <span class="number">.5</span>, <span class="number">.75</span>, <span class="number">1.0</span>]</div><div class="line">grid_learn = [<span class="number">.01</span>, <span class="number">.03</span>, <span class="number">.05</span>, <span class="number">.1</span>, <span class="number">.25</span>]</div><div class="line">grid_max_depth = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="keyword">None</span>]</div><div class="line">grid_min_samples = [<span class="number">5</span>, <span class="number">10</span>, <span class="number">.03</span>, <span class="number">.05</span>, <span class="number">.10</span>]</div><div class="line">grid_criterion = [<span class="string">'gini'</span>, <span class="string">'entropy'</span>]</div><div class="line">grid_bool = [<span class="keyword">True</span>, <span class="keyword">False</span>]</div><div class="line">grid_seed = [<span class="number">0</span>]</div><div class="line"></div><div class="line"></div><div class="line">grid_param = [</div><div class="line">            [&#123;</div><div class="line">            <span class="comment">#AdaBoostClassifier - http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.AdaBoostClassifier.html</span></div><div class="line">            <span class="string">'n_estimators'</span>: grid_n_estimator, <span class="comment">#default=50</span></div><div class="line">            <span class="string">'learning_rate'</span>: grid_learn, <span class="comment">#default=1</span></div><div class="line">            <span class="comment">#'algorithm': ['SAMME', 'SAMME.R'], #default=’SAMME.R</span></div><div class="line">            <span class="string">'random_state'</span>: grid_seed</div><div class="line">            &#125;],</div><div class="line">       </div><div class="line">    </div><div class="line">            [&#123;</div><div class="line">            <span class="comment">#BaggingClassifier - http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.BaggingClassifier.html#sklearn.ensemble.BaggingClassifier</span></div><div class="line">            <span class="string">'n_estimators'</span>: grid_n_estimator, <span class="comment">#default=10</span></div><div class="line">            <span class="string">'max_samples'</span>: grid_ratio, <span class="comment">#default=1.0</span></div><div class="line">            <span class="string">'random_state'</span>: grid_seed</div><div class="line">             &#125;],</div><div class="line"></div><div class="line">    </div><div class="line">            [&#123;</div><div class="line">            <span class="comment">#ExtraTreesClassifier - http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.ExtraTreesClassifier.html#sklearn.ensemble.ExtraTreesClassifier</span></div><div class="line">            <span class="string">'n_estimators'</span>: grid_n_estimator, <span class="comment">#default=10</span></div><div class="line">            <span class="string">'criterion'</span>: grid_criterion, <span class="comment">#default=”gini”</span></div><div class="line">            <span class="string">'max_depth'</span>: grid_max_depth, <span class="comment">#default=None</span></div><div class="line">            <span class="string">'random_state'</span>: grid_seed</div><div class="line">             &#125;],</div><div class="line"></div><div class="line"></div><div class="line">            [&#123;</div><div class="line">            <span class="comment">#GradientBoostingClassifier - http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html#sklearn.ensemble.GradientBoostingClassifier</span></div><div class="line">            <span class="comment">#'loss': ['deviance', 'exponential'], #default=’deviance’</span></div><div class="line">            <span class="string">'learning_rate'</span>: [<span class="number">.05</span>], <span class="comment">#default=0.1 -- 12/31/17 set to reduce runtime -- The best parameter for GradientBoostingClassifier is &#123;'learning_rate': 0.05, 'max_depth': 2, 'n_estimators': 300, 'random_state': 0&#125; with a runtime of 264.45 seconds.</span></div><div class="line">            <span class="string">'n_estimators'</span>: [<span class="number">300</span>], <span class="comment">#default=100 -- 12/31/17 set to reduce runtime -- The best parameter for GradientBoostingClassifier is &#123;'learning_rate': 0.05, 'max_depth': 2, 'n_estimators': 300, 'random_state': 0&#125; with a runtime of 264.45 seconds.</span></div><div class="line">            <span class="comment">#'criterion': ['friedman_mse', 'mse', 'mae'], #default=”friedman_mse”</span></div><div class="line">            <span class="string">'max_depth'</span>: grid_max_depth, <span class="comment">#default=3   </span></div><div class="line">            <span class="string">'random_state'</span>: grid_seed</div><div class="line">             &#125;],</div><div class="line"></div><div class="line">    </div><div class="line">            [&#123;</div><div class="line">            <span class="comment">#RandomForestClassifier - http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier</span></div><div class="line">            <span class="string">'n_estimators'</span>: grid_n_estimator, <span class="comment">#default=10</span></div><div class="line">            <span class="string">'criterion'</span>: grid_criterion, <span class="comment">#default=”gini”</span></div><div class="line">            <span class="string">'max_depth'</span>: grid_max_depth, <span class="comment">#default=None</span></div><div class="line">            <span class="string">'oob_score'</span>: [<span class="keyword">True</span>], <span class="comment">#default=False -- 12/31/17 set to reduce runtime -- The best parameter for RandomForestClassifier is &#123;'criterion': 'entropy', 'max_depth': 6, 'n_estimators': 100, 'oob_score': True, 'random_state': 0&#125; with a runtime of 146.35 seconds.</span></div><div class="line">            <span class="string">'random_state'</span>: grid_seed</div><div class="line">             &#125;],</div><div class="line">    </div><div class="line">            [&#123;    </div><div class="line">            <span class="comment">#GaussianProcessClassifier</span></div><div class="line">            <span class="string">'max_iter_predict'</span>: grid_n_estimator, <span class="comment">#default: 100</span></div><div class="line">            <span class="string">'random_state'</span>: grid_seed</div><div class="line">            &#125;],</div><div class="line">        </div><div class="line">    </div><div class="line">            [&#123;</div><div class="line">            <span class="comment">#LogisticRegressionCV - http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegressionCV.html#sklearn.linear_model.LogisticRegressionCV</span></div><div class="line">            <span class="string">'fit_intercept'</span>: grid_bool, <span class="comment">#default: True</span></div><div class="line">            <span class="comment">#'penalty': ['l1','l2'],</span></div><div class="line">            <span class="string">'solver'</span>: [<span class="string">'newton-cg'</span>, <span class="string">'lbfgs'</span>, <span class="string">'liblinear'</span>, <span class="string">'sag'</span>, <span class="string">'saga'</span>], <span class="comment">#default: lbfgs</span></div><div class="line">            <span class="string">'random_state'</span>: grid_seed</div><div class="line">             &#125;],</div><div class="line">            </div><div class="line">    </div><div class="line">            [&#123;</div><div class="line">            <span class="comment">#BernoulliNB - http://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.BernoulliNB.html#sklearn.naive_bayes.BernoulliNB</span></div><div class="line">            <span class="string">'alpha'</span>: grid_ratio, <span class="comment">#default: 1.0</span></div><div class="line">             &#125;],</div><div class="line">    </div><div class="line">    </div><div class="line">            <span class="comment">#GaussianNB - </span></div><div class="line">            [&#123;&#125;],</div><div class="line">    </div><div class="line">            [&#123;</div><div class="line">            <span class="comment">#KNeighborsClassifier - http://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html#sklearn.neighbors.KNeighborsClassifier</span></div><div class="line">            <span class="string">'n_neighbors'</span>: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>], <span class="comment">#default: 5</span></div><div class="line">            <span class="string">'weights'</span>: [<span class="string">'uniform'</span>, <span class="string">'distance'</span>], <span class="comment">#default = ‘uniform’</span></div><div class="line">            <span class="string">'algorithm'</span>: [<span class="string">'auto'</span>, <span class="string">'ball_tree'</span>, <span class="string">'kd_tree'</span>, <span class="string">'brute'</span>]</div><div class="line">            &#125;],</div><div class="line">            </div><div class="line">    </div><div class="line">            [&#123;</div><div class="line">            <span class="comment">#SVC - http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC</span></div><div class="line">            <span class="comment">#http://blog.hackerearth.com/simple-tutorial-svm-parameter-tuning-python-r</span></div><div class="line">            <span class="comment">#'kernel': ['linear', 'poly', 'rbf', 'sigmoid'],</span></div><div class="line">            <span class="string">'C'</span>: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], <span class="comment">#default=1.0</span></div><div class="line">            <span class="string">'gamma'</span>: grid_ratio, <span class="comment">#edfault: auto</span></div><div class="line">            <span class="string">'decision_function_shape'</span>: [<span class="string">'ovo'</span>, <span class="string">'ovr'</span>], <span class="comment">#default:ovr</span></div><div class="line">            <span class="string">'probability'</span>: [<span class="keyword">True</span>],</div><div class="line">            <span class="string">'random_state'</span>: grid_seed</div><div class="line">             &#125;],</div><div class="line"></div><div class="line">    </div><div class="line">            [&#123;</div><div class="line">            <span class="comment">#XGBClassifier - http://xgboost.readthedocs.io/en/latest/parameter.html</span></div><div class="line">            <span class="string">'learning_rate'</span>: grid_learn, <span class="comment">#default: .3</span></div><div class="line">            <span class="string">'max_depth'</span>: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">10</span>], <span class="comment">#default 2</span></div><div class="line">            <span class="string">'n_estimators'</span>: grid_n_estimator, </div><div class="line">            <span class="string">'seed'</span>: grid_seed  </div><div class="line">             &#125;]   </div><div class="line">        ]</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">start_total = time.perf_counter() <span class="comment">#https://docs.python.org/3/library/time.html#time.perf_counter</span></div><div class="line"><span class="keyword">for</span> clf, param <span class="keyword">in</span> zip (vote_est, grid_param): <span class="comment">#https://docs.python.org/3/library/functions.html#zip</span></div><div class="line"></div><div class="line">    <span class="comment">#print(clf[1]) #vote_est is a list of tuples, index 0 is the name and index 1 is the algorithm</span></div><div class="line">    <span class="comment">#print(param)</span></div><div class="line">    </div><div class="line">    </div><div class="line">    start = time.perf_counter()        </div><div class="line">    best_search = model_selection.GridSearchCV(estimator = clf[<span class="number">1</span>], param_grid = param, cv = cv_split, scoring = <span class="string">'roc_auc'</span>)</div><div class="line">    best_search.fit(data1[data1_x_bin], data1[Target])</div><div class="line">    run = time.perf_counter() - start</div><div class="line"></div><div class="line">    best_param = best_search.best_params_</div><div class="line">    print(<span class="string">'The best parameter for &#123;&#125; is &#123;&#125; with a runtime of &#123;:.2f&#125; seconds.'</span>.format(clf[<span class="number">1</span>].__class__.__name__, best_param, run))</div><div class="line">    clf[<span class="number">1</span>].set_params(**best_param) </div><div class="line"></div><div class="line"></div><div class="line">run_total = time.perf_counter() - start_total</div><div class="line">print(<span class="string">'Total optimization time was &#123;:.2f&#125; minutes.'</span>.format(run_total/<span class="number">60</span>))</div><div class="line"></div><div class="line">print(<span class="string">'-'</span>*<span class="number">10</span>)</div></pre></td></tr></table></figure>
<pre><code>The best parameter for AdaBoostClassifier is {&apos;learning_rate&apos;: 0.1, &apos;n_estimators&apos;: 300, &apos;random_state&apos;: 0} with a runtime of 38.14 seconds.
The best parameter for BaggingClassifier is {&apos;max_samples&apos;: 0.25, &apos;n_estimators&apos;: 300, &apos;random_state&apos;: 0} with a runtime of 39.18 seconds.
The best parameter for ExtraTreesClassifier is {&apos;criterion&apos;: &apos;entropy&apos;, &apos;max_depth&apos;: 6, &apos;n_estimators&apos;: 100, &apos;random_state&apos;: 0} with a runtime of 71.71 seconds.
The best parameter for GradientBoostingClassifier is {&apos;learning_rate&apos;: 0.05, &apos;max_depth&apos;: 2, &apos;n_estimators&apos;: 300, &apos;random_state&apos;: 0} with a runtime of 38.23 seconds.
The best parameter for RandomForestClassifier is {&apos;criterion&apos;: &apos;entropy&apos;, &apos;max_depth&apos;: 6, &apos;n_estimators&apos;: 100, &apos;oob_score&apos;: True, &apos;random_state&apos;: 0} with a runtime of 85.22 seconds.
The best parameter for GaussianProcessClassifier is {&apos;max_iter_predict&apos;: 10, &apos;random_state&apos;: 0} with a runtime of 9.17 seconds.
The best parameter for LogisticRegressionCV is {&apos;fit_intercept&apos;: True, &apos;random_state&apos;: 0, &apos;solver&apos;: &apos;liblinear&apos;} with a runtime of 9.05 seconds.
The best parameter for BernoulliNB is {&apos;alpha&apos;: 0.1} with a runtime of 0.29 seconds.
The best parameter for GaussianNB is {} with a runtime of 0.06 seconds.
The best parameter for KNeighborsClassifier is {&apos;algorithm&apos;: &apos;brute&apos;, &apos;n_neighbors&apos;: 7, &apos;weights&apos;: &apos;uniform&apos;} with a runtime of 6.09 seconds.
The best parameter for SVC is {&apos;C&apos;: 2, &apos;decision_function_shape&apos;: &apos;ovo&apos;, &apos;gamma&apos;: 0.1, &apos;probability&apos;: True, &apos;random_state&apos;: 0} with a runtime of 22.73 seconds.
The best parameter for XGBClassifier is {&apos;learning_rate&apos;: 0.01, &apos;max_depth&apos;: 4, &apos;n_estimators&apos;: 300, &apos;seed&apos;: 0} with a runtime of 52.34 seconds.
Total optimization time was 6.20 minutes.
----------
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Hard Vote or majority rules w/Tuned Hyperparameters</span></div><div class="line">grid_hard = ensemble.VotingClassifier(estimators = vote_est , voting = <span class="string">'hard'</span>)</div><div class="line">grid_hard_cv = model_selection.cross_validate(grid_hard, data1[data1_x_bin], data1[Target], cv  = cv_split)</div><div class="line">grid_hard.fit(data1[data1_x_bin], data1[Target])</div><div class="line"></div><div class="line">print(<span class="string">"Hard Voting w/Tuned Hyperparameters Training w/bin score mean: &#123;:.2f&#125;"</span>. format(grid_hard_cv[<span class="string">'train_score'</span>].mean()*<span class="number">100</span>)) </div><div class="line">print(<span class="string">"Hard Voting w/Tuned Hyperparameters Test w/bin score mean: &#123;:.2f&#125;"</span>. format(grid_hard_cv[<span class="string">'test_score'</span>].mean()*<span class="number">100</span>))</div><div class="line">print(<span class="string">"Hard Voting w/Tuned Hyperparameters Test w/bin score 3*std: +/- &#123;:.2f&#125;"</span>. format(grid_hard_cv[<span class="string">'test_score'</span>].std()*<span class="number">100</span>*<span class="number">3</span>))</div><div class="line">print(<span class="string">'-'</span>*<span class="number">10</span>)</div><div class="line"></div><div class="line"><span class="comment">#Soft Vote or weighted probabilities w/Tuned Hyperparameters</span></div><div class="line">grid_soft = ensemble.VotingClassifier(estimators = vote_est , voting = <span class="string">'soft'</span>)</div><div class="line">grid_soft_cv = model_selection.cross_validate(grid_soft, data1[data1_x_bin], data1[Target], cv  = cv_split)</div><div class="line">grid_soft.fit(data1[data1_x_bin], data1[Target])</div><div class="line"></div><div class="line">print(<span class="string">"Soft Voting w/Tuned Hyperparameters Training w/bin score mean: &#123;:.2f&#125;"</span>. format(grid_soft_cv[<span class="string">'train_score'</span>].mean()*<span class="number">100</span>)) </div><div class="line">print(<span class="string">"Soft Voting w/Tuned Hyperparameters Test w/bin score mean: &#123;:.2f&#125;"</span>. format(grid_soft_cv[<span class="string">'test_score'</span>].mean()*<span class="number">100</span>))</div><div class="line">print(<span class="string">"Soft Voting w/Tuned Hyperparameters Test w/bin score 3*std: +/- &#123;:.2f&#125;"</span>. format(grid_soft_cv[<span class="string">'test_score'</span>].std()*<span class="number">100</span>*<span class="number">3</span>))</div><div class="line">print(<span class="string">'-'</span>*<span class="number">10</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#12/31/17 tuned with data1_x_bin</span></div><div class="line"><span class="comment">#The best parameter for AdaBoostClassifier is &#123;'learning_rate': 0.1, 'n_estimators': 300, 'random_state': 0&#125; with a runtime of 33.39 seconds.</span></div><div class="line"><span class="comment">#The best parameter for BaggingClassifier is &#123;'max_samples': 0.25, 'n_estimators': 300, 'random_state': 0&#125; with a runtime of 30.28 seconds.</span></div><div class="line"><span class="comment">#The best parameter for ExtraTreesClassifier is &#123;'criterion': 'entropy', 'max_depth': 6, 'n_estimators': 100, 'random_state': 0&#125; with a runtime of 64.76 seconds.</span></div><div class="line"><span class="comment">#The best parameter for GradientBoostingClassifier is &#123;'learning_rate': 0.05, 'max_depth': 2, 'n_estimators': 300, 'random_state': 0&#125; with a runtime of 34.35 seconds.</span></div><div class="line"><span class="comment">#The best parameter for RandomForestClassifier is &#123;'criterion': 'entropy', 'max_depth': 6, 'n_estimators': 100, 'oob_score': True, 'random_state': 0&#125; with a runtime of 76.32 seconds.</span></div><div class="line"><span class="comment">#The best parameter for GaussianProcessClassifier is &#123;'max_iter_predict': 10, 'random_state': 0&#125; with a runtime of 6.01 seconds.</span></div><div class="line"><span class="comment">#The best parameter for LogisticRegressionCV is &#123;'fit_intercept': True, 'random_state': 0, 'solver': 'liblinear'&#125; with a runtime of 8.04 seconds.</span></div><div class="line"><span class="comment">#The best parameter for BernoulliNB is &#123;'alpha': 0.1&#125; with a runtime of 0.19 seconds.</span></div><div class="line"><span class="comment">#The best parameter for GaussianNB is &#123;&#125; with a runtime of 0.04 seconds.</span></div><div class="line"><span class="comment">#The best parameter for KNeighborsClassifier is &#123;'algorithm': 'brute', 'n_neighbors': 7, 'weights': 'uniform'&#125; with a runtime of 4.84 seconds.</span></div><div class="line"><span class="comment">#The best parameter for SVC is &#123;'C': 2, 'decision_function_shape': 'ovo', 'gamma': 0.1, 'probability': True, 'random_state': 0&#125; with a runtime of 29.39 seconds.</span></div><div class="line"><span class="comment">#The best parameter for XGBClassifier is &#123;'learning_rate': 0.01, 'max_depth': 4, 'n_estimators': 300, 'seed': 0&#125; with a runtime of 46.23 seconds.</span></div><div class="line"><span class="comment">#Total optimization time was 5.56 minutes.</span></div></pre></td></tr></table></figure>
<pre><code>Hard Voting w/Tuned Hyperparameters Training w/bin score mean: 85.22
Hard Voting w/Tuned Hyperparameters Test w/bin score mean: 82.31
Hard Voting w/Tuned Hyperparameters Test w/bin score 3*std: +/- 5.26
----------
Soft Voting w/Tuned Hyperparameters Training w/bin score mean: 84.76
Soft Voting w/Tuned Hyperparameters Test w/bin score mean: 82.28
Soft Voting w/Tuned Hyperparameters Test w/bin score 3*std: +/- 5.42
----------
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#prepare data for modeling</span></div><div class="line">print(data_val.info())</div><div class="line">print(<span class="string">"-"</span>*<span class="number">10</span>)</div><div class="line"><span class="comment">#data_val.sample(10)</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#handmade decision tree - submission score = 0.77990</span></div><div class="line">data_val[<span class="string">'Survived'</span>] = mytree(data_val).astype(int)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#decision tree w/full dataset modeling submission score: defaults= 0.76555, tuned= 0.77990</span></div><div class="line"><span class="comment">#submit_dt = tree.DecisionTreeClassifier()</span></div><div class="line"><span class="comment">#submit_dt = model_selection.GridSearchCV(tree.DecisionTreeClassifier(), param_grid=param_grid, scoring = 'roc_auc', cv = cv_split)</span></div><div class="line"><span class="comment">#submit_dt.fit(data1[data1_x_bin], data1[Target])</span></div><div class="line"><span class="comment">#print('Best Parameters: ', submit_dt.best_params_) #Best Parameters:  &#123;'criterion': 'gini', 'max_depth': 4, 'random_state': 0&#125;</span></div><div class="line"><span class="comment">#data_val['Survived'] = submit_dt.predict(data_val[data1_x_bin])</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#bagging w/full dataset modeling submission score: defaults= 0.75119, tuned= 0.77990</span></div><div class="line"><span class="comment">#submit_bc = ensemble.BaggingClassifier()</span></div><div class="line"><span class="comment">#submit_bc = model_selection.GridSearchCV(ensemble.BaggingClassifier(), param_grid= &#123;'n_estimators':grid_n_estimator, 'max_samples': grid_ratio, 'oob_score': grid_bool, 'random_state': grid_seed&#125;, scoring = 'roc_auc', cv = cv_split)</span></div><div class="line"><span class="comment">#submit_bc.fit(data1[data1_x_bin], data1[Target])</span></div><div class="line"><span class="comment">#print('Best Parameters: ', submit_bc.best_params_) #Best Parameters:  &#123;'max_samples': 0.25, 'n_estimators': 500, 'oob_score': True, 'random_state': 0&#125;</span></div><div class="line"><span class="comment">#data_val['Survived'] = submit_bc.predict(data_val[data1_x_bin])</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#extra tree w/full dataset modeling submission score: defaults= 0.76555, tuned= 0.77990</span></div><div class="line"><span class="comment">#submit_etc = ensemble.ExtraTreesClassifier()</span></div><div class="line"><span class="comment">#submit_etc = model_selection.GridSearchCV(ensemble.ExtraTreesClassifier(), param_grid=&#123;'n_estimators': grid_n_estimator, 'criterion': grid_criterion, 'max_depth': grid_max_depth, 'random_state': grid_seed&#125;, scoring = 'roc_auc', cv = cv_split)</span></div><div class="line"><span class="comment">#submit_etc.fit(data1[data1_x_bin], data1[Target])</span></div><div class="line"><span class="comment">#print('Best Parameters: ', submit_etc.best_params_) #Best Parameters:  &#123;'criterion': 'entropy', 'max_depth': 6, 'n_estimators': 100, 'random_state': 0&#125;</span></div><div class="line"><span class="comment">#data_val['Survived'] = submit_etc.predict(data_val[data1_x_bin])</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#random foreset w/full dataset modeling submission score: defaults= 0.71291, tuned= 0.73205</span></div><div class="line"><span class="comment">#submit_rfc = ensemble.RandomForestClassifier()</span></div><div class="line"><span class="comment">#submit_rfc = model_selection.GridSearchCV(ensemble.RandomForestClassifier(), param_grid=&#123;'n_estimators': grid_n_estimator, 'criterion': grid_criterion, 'max_depth': grid_max_depth, 'random_state': grid_seed&#125;, scoring = 'roc_auc', cv = cv_split)</span></div><div class="line"><span class="comment">#submit_rfc.fit(data1[data1_x_bin], data1[Target])</span></div><div class="line"><span class="comment">#print('Best Parameters: ', submit_rfc.best_params_) #Best Parameters:  &#123;'criterion': 'entropy', 'max_depth': 6, 'n_estimators': 100, 'random_state': 0&#125;</span></div><div class="line"><span class="comment">#data_val['Survived'] = submit_rfc.predict(data_val[data1_x_bin])</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#ada boosting w/full dataset modeling submission score: defaults= 0.74162, tuned= 0.75119</span></div><div class="line"><span class="comment">#submit_abc = ensemble.AdaBoostClassifier()</span></div><div class="line"><span class="comment">#submit_abc = model_selection.GridSearchCV(ensemble.AdaBoostClassifier(), param_grid=&#123;'n_estimators': grid_n_estimator, 'learning_rate': grid_ratio, 'algorithm': ['SAMME', 'SAMME.R'], 'random_state': grid_seed&#125;, scoring = 'roc_auc', cv = cv_split)</span></div><div class="line"><span class="comment">#submit_abc.fit(data1[data1_x_bin], data1[Target])</span></div><div class="line"><span class="comment">#print('Best Parameters: ', submit_abc.best_params_) #Best Parameters:  &#123;'algorithm': 'SAMME.R', 'learning_rate': 0.1, 'n_estimators': 300, 'random_state': 0&#125;</span></div><div class="line"><span class="comment">#data_val['Survived'] = submit_abc.predict(data_val[data1_x_bin])</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#gradient boosting w/full dataset modeling submission score: defaults= 0.75119, tuned= 0.77033</span></div><div class="line"><span class="comment">#submit_gbc = ensemble.GradientBoostingClassifier()</span></div><div class="line"><span class="comment">#submit_gbc = model_selection.GridSearchCV(ensemble.GradientBoostingClassifier(), param_grid=&#123;'learning_rate': grid_ratio, 'n_estimators': grid_n_estimator, 'max_depth': grid_max_depth, 'random_state':grid_seed&#125;, scoring = 'roc_auc', cv = cv_split)</span></div><div class="line"><span class="comment">#submit_gbc.fit(data1[data1_x_bin], data1[Target])</span></div><div class="line"><span class="comment">#print('Best Parameters: ', submit_gbc.best_params_) #Best Parameters:  &#123;'learning_rate': 0.25, 'max_depth': 2, 'n_estimators': 50, 'random_state': 0&#125;</span></div><div class="line"><span class="comment">#data_val['Survived'] = submit_gbc.predict(data_val[data1_x_bin])</span></div><div class="line"></div><div class="line"><span class="comment">#extreme boosting w/full dataset modeling submission score: defaults= 0.73684, tuned= 0.77990</span></div><div class="line"><span class="comment">#submit_xgb = XGBClassifier()</span></div><div class="line"><span class="comment">#submit_xgb = model_selection.GridSearchCV(XGBClassifier(), param_grid= &#123;'learning_rate': grid_learn, 'max_depth': [0,2,4,6,8,10], 'n_estimators': grid_n_estimator, 'seed': grid_seed&#125;, scoring = 'roc_auc', cv = cv_split)</span></div><div class="line"><span class="comment">#submit_xgb.fit(data1[data1_x_bin], data1[Target])</span></div><div class="line"><span class="comment">#print('Best Parameters: ', submit_xgb.best_params_) #Best Parameters:  &#123;'learning_rate': 0.01, 'max_depth': 4, 'n_estimators': 300, 'seed': 0&#125;</span></div><div class="line"><span class="comment">#data_val['Survived'] = submit_xgb.predict(data_val[data1_x_bin])</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#hard voting classifier w/full dataset modeling submission score: defaults= 0.75598, tuned = 0.77990</span></div><div class="line"><span class="comment">#data_val['Survived'] = vote_hard.predict(data_val[data1_x_bin])</span></div><div class="line">data_val[<span class="string">'Survived'</span>] = grid_hard.predict(data_val[data1_x_bin])</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#soft voting classifier w/full dataset modeling submission score: defaults= 0.73684, tuned = 0.74162</span></div><div class="line"><span class="comment">#data_val['Survived'] = vote_soft.predict(data_val[data1_x_bin])</span></div><div class="line"><span class="comment">#data_val['Survived'] = grid_soft.predict(data_val[data1_x_bin])</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#submit file</span></div><div class="line">submit = data_val[[<span class="string">'PassengerId'</span>,<span class="string">'Survived'</span>]]</div><div class="line">submit.to_csv(<span class="string">"submit.csv"</span>, index=<span class="keyword">False</span>)</div><div class="line"></div><div class="line">print(<span class="string">'Validation Data Distribution: \n'</span>, data_val[<span class="string">'Survived'</span>].value_counts(normalize = <span class="keyword">True</span>))</div><div class="line">submit.sample(<span class="number">10</span>)</div></pre></td></tr></table></figure>
<pre><code>&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;
RangeIndex: 418 entries, 0 to 417
Data columns (total 21 columns):
PassengerId      418 non-null int64
Pclass           418 non-null int64
Name             418 non-null object
Sex              418 non-null object
Age              418 non-null float64
SibSp            418 non-null int64
Parch            418 non-null int64
Ticket           418 non-null object
Fare             418 non-null float64
Cabin            91 non-null object
Embarked         418 non-null object
FamilySize       418 non-null int64
IsAlone          418 non-null int64
Title            418 non-null object
FareBin          418 non-null category
AgeBin           418 non-null category
Sex_Code         418 non-null int64
Embarked_Code    418 non-null int64
Title_Code       418 non-null int64
AgeBin_Code      418 non-null int64
FareBin_Code     418 non-null int64
dtypes: category(2), float64(2), int64(11), object(6)
memory usage: 63.1+ KB
None
----------
Validation Data Distribution: 
 0    0.633971
1    0.366029
Name: Survived, dtype: float64
</code></pre><div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right"><br>      <th></th><br>      <th>PassengerId</th><br>      <th>Survived</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>15</th><br>      <td>907</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>245</th><br>      <td>1137</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>230</th><br>      <td>1122</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>280</th><br>      <td>1172</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>16</th><br>      <td>908</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>181</th><br>      <td>1073</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>311</th><br>      <td>1203</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>389</th><br>      <td>1281</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>383</th><br>      <td>1275</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>119</th><br>      <td>1011</td><br>      <td>1</td><br>    </tr><br>  </tbody><br></table><br></div>



<h2 id="Step-7-Optimize-and-Strategize"><a href="#Step-7-Optimize-and-Strategize" class="headerlink" title="Step 7: Optimize and Strategize"></a>Step 7: Optimize and Strategize</h2><h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>Iteration one of the Data Science Framework, seems to converge on 0.77990 submission accuracy. Using the same dataset and different implementation of a decision tree (adaboost, random forest, gradient boost, xgboost, etc.) with tuning does not exceed the 0.77990 submission accuracy. Interesting for this dataset, the simple decision tree algorithm had the best default submission score and with tuning achieved the same best accuracy score.</p>
<p>While no general conclusions can be made from testing a handful of algorithms on a single dataset, there are several observations on the mentioned dataset.</p>
<p>The train dataset has a different distribution than the test/validation dataset and population. This created wide margins between the cross validation (CV) accuracy score and Kaggle submission accuracy score.<br>Given the same dataset, decision tree based algorithms, seemed to converge on the same accuracy score after proper tuning.<br>Despite tuning, no machine learning algorithm, exceeded the homemade algorithm. The author will theorize, that for small datasets, a manmade algorithm is the bar to beat.<br>With that in mind, for iteration two, I would spend more time on preprocessing and feature engineering. In order to better align the CV score and Kaggle score and improve the overall accuracy.</p>
<h2 id="第七步：优化和策略"><a href="#第七步：优化和策略" class="headerlink" title="第七步：优化和策略"></a>第七步：优化和策略</h2><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>数据科学框架的迭代之一，似乎收敛于0.77990提交的准确性。使用相同的数据集和不同的决策树（adaboost，随机森林，梯度提升，xgboost等）的实施调整不超过0.77990提交的准确性。这个数据集有趣，简单的决策树算法有最好的默认提交分数和调整达到相同的最佳准确性分数。</p>
<blockquote>
<p>译者注：作者标题的99% accuracy其实是一种比喻，一种思路。看懂了文章反而会忘记标题。</p>
</blockquote>
<p>尽管在单个数据集上测试少数几种算法，可以得出一般性结论，但是对于所提及的数据集却有几种观察结果。</p>
<p>训练数据集与测试/验证数据集和总体的分布不同。这在交叉验证（CV）准确性得分和Kaggle提交准确性得分之间创造了很大的利润空间。<br>给定相同的数据集，基于决策树的算法似乎在适当的调整之后以相同的准确度得分收敛。<br>尽管调整后，没有机器学习算法，超过了自制算法。作者将推理，对于小数据集，人造算法是是可以打败的。<br>考虑到这一点，对于二次迭代，我会花更多的时间在预处理和特征工程上。为了更好地调整CV分数和Kaggle分数，并提高整体的准确性。</p>
<h3 id="Change-Log"><a href="#Change-Log" class="headerlink" title="Change Log:"></a>Change Log:</h3><ul>
<li>11/22/17 Please note, this kernel is currently in progress, but open to feedback. Thanks!</li>
<li>11/23/17 Cleaned up published notebook and updated through step 3.</li>
<li>11/25/17 Added enhancements to published notebook and started step 4.</li>
<li>11/26/17 Skipped ahead to data model, since this is a published notebook. Accuracy with (very) simple data cleaning and logistic regression is ~82%. Continue to up vote and I will continue to develop this notebook. Thanks!</li>
<li>12/2/17 Updated section 4 with exploratory analysis and section 5 with more classifiers. Improved model to ~85% accuracy.</li>
<li>12/3/17 Update section 4 with improved graphical statistics.</li>
<li>12/7/17 Updated section 5 with Data Science 101 Lesson.</li>
<li>12/8/17 Reorganized section 3 &amp; 4 with cleaner code.</li>
<li>12/9/17 Updated section 5 with model optimization how-tos. Initial competition submission with Decision Tree; will update with better algorithm later.</li>
<li>12/10/17 Updated section 3 &amp; 4 with cleaner code and better datasets.</li>
<li>12/11/17 Updated section 5 with better how-tos.</li>
<li>12/12/17 Cleaned section 5 to prep for hyper-parameter tuning.</li>
<li>12/13/17 Updated section 5 to focus on learning data modeling via decision tree.</li>
<li>12/20/17 Updated section 4 - Thanks @Daniel M. for suggestion to split up visualization code. Started working on section 6 for “super” model.</li>
<li>12/23/17 Edited section 1-5 for clarity and more concise code.</li>
<li>12/24/17 Updated section 5 with random_state and score for more consistent results.</li>
<li>12/31/17 Completed data science framework iteration 1 and added section 7 with conclusion.<br>更改日志：</li>
<li>11/17/17请注意，这个内核目前正在进行中，但可以反馈。谢谢！</li>
<li>11/23/17清理已发布的笔记本，并通过步骤3进行更新。</li>
<li>11/25/17增加了已发布笔记本的增强功能，并启动了第4步。</li>
<li>11/26/17跳到数据模型，因为这是一个公布的笔记本。（非常）简单的数据清理和逻辑回归的准确性是〜82％。继续投票，我会继续发展这个笔记本。谢谢！</li>
<li>12/2/17更新第4部分探索性分析和第5部分更多的分类。改进的模型精度达到〜85％。</li>
<li>12/3/17更新第4节，改进图形统计。</li>
<li>12/7/17更新了第5节“数据科学101课”。</li>
<li>12/8/17用更简洁的代码重新组织第3和4部分。</li>
<li>12/9/17更新了第5部分的模型优化指南。使用决策树提交初始竞争; 稍后会用更好的算法更新。</li>
<li>12/10/17用更简洁的代码和更好的数据集更新了第3和第4部分。</li>
<li>12/11/17更新了第5节，更好的方法。</li>
<li>12/12/17清理了第5部分，准备进行超参数调整。</li>
<li>12/13/17更新了第5节，重点介绍了通过决策树学习数据建模。</li>
<li>12/20/17更新了第4部分 - 感谢@Daniel M.建议分割可视化代码。开始研究“超级”模型的第6部分。</li>
<li>12/23/17为了清晰和简洁的代码，编辑了1-5节。</li>
<li>12/24/17更新了第5部分的random_state和得分更一致的结果。</li>
<li><p>12/31/17完成了数据科学框架第1次迭代，并添加了第7部分的结论。</p>
<h3 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h3><p>Programming is all about “borrowing” code, because knife sharpens knife. Nonetheless, I want to give credit, where credit is due.</p>
</li>
<li><p><a href="https://www.amazon.com/gp/product/1449369413/ref=as_li_tl?ie=UTF8&amp;tag=kaggle-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=1449369413&amp;linkId=740510c3199892cca1632fe738fb8d08" target="_blank" rel="external">Introduction to Machine Learning with Python: A Guide for Data Scientists by Andreas Müller and Sarah Guido</a> - Machine Learning 101 written by a core developer of sklearn</p>
</li>
<li><a href="https://www.amazon.com/gp/product/0470944889/ref=as_li_tl?ie=UTF8&amp;tag=kaggle-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=0470944889&amp;linkId=f797da48813ed5cfc762ce5df8ef957f" target="_blank" rel="external">Visualize This: The Flowing Data Guide to Design, Visualization, and Statistics by Nathan Yau</a> - Learn the art and science of data visualization</li>
<li><a href="https://www.amazon.com/gp/product/1119245516/ref=as_li_tl?ie=UTF8&amp;tag=kaggle-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=1119245516&amp;linkId=5b4ac9a6fd1da198d82f9ca841d1af9f" target="_blank" rel="external">Machine Learning for Dummies by John Mueller and Luca Massaron</a> - Easy to understand for a beginner book, but detailed to actually learn the fundamentals of the topic</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/sklearn/" rel="tag"># sklearn</a>
          
            <a href="/tags/kaggle/" rel="tag"># kaggle</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/12/20/AmericaOpposeAmerica/" rel="next" title="美国反对美国">
                <i class="fa fa-chevron-left"></i> 美国反对美国
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript">
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8yNzkxNS80NDky"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="http://om80aljc8.bkt.clouddn.com/blog_%E5%A4%B4%E5%83%8F.gif" alt="Zealot CE">
          <p class="site-author-name" itemprop="name">Zealot CE</p>
           
              <p class="site-description motion-element" itemprop="description">when you are old</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/zealotCE" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Table-of-Contents"><span class="nav-number">1.</span> <span class="nav-text">Table of Contents</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#目录"><span class="nav-number">2.</span> <span class="nav-text">目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#How-a-Data-Scientist-Beat-the-Odds"><span class="nav-number">3.</span> <span class="nav-text">How a Data Scientist Beat the Odds</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据科学家如何击败概率"><span class="nav-number">4.</span> <span class="nav-text">数据科学家如何击败概率</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#A-Data-Science-Framework"><span class="nav-number">5.</span> <span class="nav-text">A Data Science Framework</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据科学框架"><span class="nav-number">6.</span> <span class="nav-text">数据科学框架</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-1-Define-the-Problem"><span class="nav-number">7.</span> <span class="nav-text">Step 1: Define the Problem</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第一步：定义问题"><span class="nav-number">8.</span> <span class="nav-text">第一步：定义问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-2-Gather-the-Data"><span class="nav-number">9.</span> <span class="nav-text">Step 2: Gather the Data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二步：收集数据"><span class="nav-number">10.</span> <span class="nav-text">第二步：收集数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-3-Prepare-Data-for-Consumption"><span class="nav-number">11.</span> <span class="nav-text">Step 3: Prepare Data for Consumption</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第三步：准备使用的数据"><span class="nav-number">12.</span> <span class="nav-text">第三步：准备使用的数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-11-Load-Data-Modelling-Libraries¶"><span class="nav-number">13.</span> <span class="nav-text">3.11 Load Data Modelling Libraries¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-11加载数据建模库"><span class="nav-number">14.</span> <span class="nav-text">3.11加载数据建模库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-Meet-and-Greet-Data"><span class="nav-number">15.</span> <span class="nav-text">3.2 Meet and Greet Data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-迎接和问候数据"><span class="nav-number">16.</span> <span class="nav-text">3.2 迎接和问候数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-21-The-4-C’s-of-Data-Cleaning-Correcting-Completing-Creating-and-Converting"><span class="nav-number">17.</span> <span class="nav-text">3.21 The 4 C’s of Data Cleaning: Correcting, Completing, Creating, and Converting</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-21数据清理4-C：修正，完成，创建和转换"><span class="nav-number">18.</span> <span class="nav-text">3.21数据清理4 C：修正，完成，创建和转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-22-Clean-Data"><span class="nav-number">19.</span> <span class="nav-text">3.22 Clean Data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-22-数据清洗"><span class="nav-number">20.</span> <span class="nav-text">3.22 数据清洗</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-23-转换格式"><span class="nav-number">21.</span> <span class="nav-text">3.23 转换格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-24-Da-Double-Check-Cleaned-Data"><span class="nav-number">22.</span> <span class="nav-text">3.24 Da-Double Check Cleaned Data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-24-再检查一次清洗后的数据"><span class="nav-number">23.</span> <span class="nav-text">3.24 再检查一次清洗后的数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-25-Split-Training-and-Testing-Data"><span class="nav-number">24.</span> <span class="nav-text">3.25 Split Training and Testing Data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-25分割训练和测试数据"><span class="nav-number">25.</span> <span class="nav-text">3.25分割训练和测试数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-4-Perform-Exploratory-Analysis-with-Statistics"><span class="nav-number">26.</span> <span class="nav-text">Step 4: Perform Exploratory Analysis with Statistics</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第4步：用统计数据进行探索性分析"><span class="nav-number">27.</span> <span class="nav-text">第4步：用统计数据进行探索性分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-5-Model-Data"><span class="nav-number">28.</span> <span class="nav-text">Step 5: Model Data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第五步：模型数据"><span class="nav-number">29.</span> <span class="nav-text">第五步：模型数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第五步：模型数据-1"><span class="nav-number">30.</span> <span class="nav-text">第五步：模型数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Machine-Learning-Selection"><span class="nav-number">30.1.</span> <span class="nav-text">Machine Learning Selection:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#机器学习选择："><span class="nav-number">30.2.</span> <span class="nav-text">机器学习选择：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Machine-Learning-Classification-Algorithms"><span class="nav-number">30.3.</span> <span class="nav-text">Machine Learning Classification Algorithms:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#机器学习分类算法："><span class="nav-number">30.4.</span> <span class="nav-text">机器学习分类算法：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Data-Science-101-How-to-Choose-a-Machine-Learning-Algorithm-MLA"><span class="nav-number">30.5.</span> <span class="nav-text">Data Science 101: How to Choose a Machine Learning Algorithm (MLA)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据科学101：如何选择机器学习算法（MLA）"><span class="nav-number">30.6.</span> <span class="nav-text">数据科学101：如何选择机器学习算法（MLA）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-Evaluate-Model-Performance"><span class="nav-number">31.</span> <span class="nav-text">5.1 Evaluate Model Performance</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1评估模型性能"><span class="nav-number">32.</span> <span class="nav-text">5.1评估模型性能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Data-Science-101-Determine-a-Baseline-Accuracy"><span class="nav-number">32.1.</span> <span class="nav-text">Data Science 101: Determine a Baseline Accuracy</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据科学101：确定基线精度"><span class="nav-number">33.</span> <span class="nav-text">数据科学101：确定基线精度</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Data-Science-101-How-to-Create-Your-Own-Model"><span class="nav-number">33.1.</span> <span class="nav-text">Data Science 101: How-to Create Your Own Model</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据科学101：如何创建自己的模型"><span class="nav-number">33.2.</span> <span class="nav-text">数据科学101：如何创建自己的模型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-11-Model-Performance-with-Cross-Validation-CV"><span class="nav-number">34.</span> <span class="nav-text">5.11 Model Performance with Cross-Validation (CV)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-11交叉验证的模型性能（CV）"><span class="nav-number">35.</span> <span class="nav-text">5.11交叉验证的模型性能（CV）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-12-Tune-Model-with-Hyper-Parameters"><span class="nav-number">36.</span> <span class="nav-text">5.12 Tune Model with Hyper-Parameters</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-12使用超参数调整模型"><span class="nav-number">36.1.</span> <span class="nav-text">5.12使用超参数调整模型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-6-Validate-and-Implement"><span class="nav-number">37.</span> <span class="nav-text">Step 6: Validate and Implement</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第6步：验证和实施"><span class="nav-number">38.</span> <span class="nav-text">第6步：验证和实施</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-7-Optimize-and-Strategize"><span class="nav-number">39.</span> <span class="nav-text">Step 7: Optimize and Strategize</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Conclusion"><span class="nav-number">39.1.</span> <span class="nav-text">Conclusion</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第七步：优化和策略"><span class="nav-number">40.</span> <span class="nav-text">第七步：优化和策略</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#结论"><span class="nav-number">40.1.</span> <span class="nav-text">结论</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Change-Log"><span class="nav-number">40.2.</span> <span class="nav-text">Change Log:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Credits"><span class="nav-number">40.3.</span> <span class="nav-text">Credits</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zealot CE</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  






  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("sHYMmb0F1bKXCxFdzlbuL6wi-gzGzoHsz", "PSCCqkaKwVXxuk15wkNk4cQy");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

  

</body>
</html>